[build-system]
requires = ["setuptools>=40.2.0", "wheel"]
build-backend = "setuptools.build_meta"

[tool.black]
# File filtering is taken care of in pre-commit.
line-length=100
target-version=['py36']

[tool.pytest.ini_options]
# note: When updating the traceback format, make sure to update .github/pytest.json
# We don't use the celery pytest plugin.
addopts = "-ra --tb=short --strict-markers -p no:celery"
# TODO: --import-mode=importlib will become the default soon,
# currently we have a few relative imports that don't work with that.
markers = [
    "snuba: mark a test as requiring snuba",
]
selenium_driver = "chrome"
# Unless otherwise specified, these warning filters should be kept in
# sync with sentry.utils.pytest.sentry, and sentry.runner.settings.
filterwarnings = [
    # Consider all warnings to be errors other than the ignored ones.
    "error",
    # TODO(joshuarli): Address these as a prerequisite to testing on Django 2.1.
    "ignore:django.utils.deprecation.RemovedInDjango20Warning",
    # DeprecationWarnings from Python 3.6's sre_parse are just so painful,
    # and I haven't found a way to ignore it specifically from a module.
    # This one in particular is from the "cookies" packages as depended
    # on by an outdated version of responses, and shows up all over tests.
    # TODO(joshuarli): Upgrade responses, then revisit this.
    #                  It'll probably show up in other dependencies.
    "ignore::DeprecationWarning",
    # This ignore should ONLY be here.
    # If you remove it, then you have to wrap most datetime objects in testing code
    # with django.utils.timezone.
    "ignore:DateTimeField.*naive datetime:RuntimeWarning",
]
# This is for people who install pytest-xdist locally,
# and use the -f/--looponfail feature.
# Disabled for now, because it prevents pytest from running with "Unknown config option: looponfailroots"
# if pytest-xdist is not installed and there is no -p no:warnings.
# looponfailroots = ["src", "tests"]
