{"version":3,"file":"chunks/app_views_profiling_profileFlamechart_tsx.xxxxxxxxxxxxxxxxxxxx.js","mappings":"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","sources":["webpack:///./app/components/profiling/FlamegraphWarnings.tsx","webpack:///./app/components/profiling/FrameStack/frameStack.tsx","webpack:///./app/components/profiling/FrameStack/frameStackContextMenu.tsx","webpack:///./app/components/profiling/FrameStack/frameStackTable.tsx","webpack:///./app/components/profiling/FrameStack/frameStackTableRow.tsx","webpack:///./app/components/profiling/ProfilingContextMenu/profilingContextMenu.tsx","webpack:///./app/components/profiling/boundTooltip.tsx","webpack:///./app/components/profiling/exportProfileButton.tsx","webpack:///./app/components/profiling/flamegraph.tsx","webpack:///./app/components/profiling/flamegraphOptionsContextMenu.tsx","webpack:///./app/components/profiling/flamegraphOptionsMenu.tsx","webpack:///./app/components/profiling/flamegraphSearch.tsx","webpack:///./app/components/profiling/flamegraphToolbar.tsx","webpack:///./app/components/profiling/flamegraphViewSelectMenu.tsx","webpack:///./app/components/profiling/flamegraphZoomView.tsx","webpack:///./app/components/profiling/flamegraphZoomViewMinimap.tsx","webpack:///./app/components/profiling/profileDragDropImport.tsx","webpack:///./app/components/profiling/profilingFlamechartLayout.tsx","webpack:///./app/components/profiling/threadSelector.tsx","webpack:///./app/utils/profiling/canvasScheduler.tsx","webpack:///./app/utils/profiling/colors/utils.tsx","webpack:///./app/utils/profiling/filterFlamegraphTree.tsx","webpack:///./app/utils/profiling/flamegraph.ts","webpack:///./app/utils/profiling/flamegraph/flamegraphStateProvider/flamegraphPreferences.tsx","webpack:///./app/utils/profiling/flamegraph/flamegraphStateProvider/flamegraphProfiles.tsx","webpack:///./app/utils/profiling/flamegraph/flamegraphStateProvider/flamegraphSearch.tsx","webpack:///./app/utils/profiling/flamegraph/flamegraphStateProvider/flamegraphZoomPosition.tsx","webpack:///./app/utils/profiling/flamegraph/flamegraphStateProvider/index.tsx","webpack:///./app/utils/profiling/flamegraph/flamegraphTheme.tsx","webpack:///./app/utils/profiling/flamegraph/flamegraphThemeProvider.tsx","webpack:///./app/utils/profiling/flamegraph/useFlamegraphPreferences.ts","webpack:///./app/utils/profiling/flamegraph/useFlamegraphProfiles.tsx","webpack:///./app/utils/profiling/flamegraph/useFlamegraphSearch.ts","webpack:///./app/utils/profiling/flamegraph/useFlamegraphState.ts","webpack:///./app/utils/profiling/flamegraph/useFlamegraphTheme.ts","webpack:///./app/utils/profiling/flamegraphCanvas.tsx","webpack:///./app/utils/profiling/flamegraphFrame.tsx","webpack:///./app/utils/profiling/flamegraphView.tsx","webpack:///./app/utils/profiling/gl/utils.ts","webpack:///./app/utils/profiling/hooks/useContextMenu.tsx","webpack:///./app/utils/profiling/hooks/useInternalFlamegraphDebugMode.ts","webpack:///./app/utils/profiling/hooks/useKeyboardNavigation.tsx","webpack:///./app/utils/profiling/hooks/useResizableDrawer.tsx","webpack:///./app/utils/profiling/hooks/useVirtualizedTree/VirtualizedTree.tsx","webpack:///./app/utils/profiling/hooks/useVirtualizedTree/VirtualizedTreeNode.tsx","webpack:///./app/utils/profiling/hooks/useVirtualizedTree/useVirtualizedTree.tsx","webpack:///./app/utils/profiling/renderers/flamegraphRenderer.tsx","webpack:///./app/utils/profiling/renderers/gridRenderer.tsx","webpack:///./app/utils/profiling/renderers/positionIndicatorRenderer.tsx","webpack:///./app/utils/profiling/renderers/sampleTickRenderer.tsx","webpack:///./app/utils/profiling/renderers/selectedFrameRenderer.tsx","webpack:///./app/utils/profiling/renderers/shaders.tsx","webpack:///./app/utils/profiling/renderers/textRenderer.tsx","webpack:///./app/utils/profiling/units/units.ts","webpack:///./app/utils/profiling/validators/regExp.tsx","webpack:///./app/utils/useCombinedReducer.tsx","webpack:///./app/utils/useDevicePixelRatio.tsx","webpack:///./app/utils/useEffectAfterFirstRender.ts","webpack:///./app/utils/useLocalStorageState.ts","webpack:///./app/utils/useMemoWithPrevious.ts","webpack:///./app/utils/useUndoableReducer.tsx","webpack:///./app/views/profiling/profileFlamechart.tsx"],"sourcesContent":["import styled from '@emotion/styled';\n\nimport {ExportProfileButton} from 'sentry/components/profiling/exportProfileButton';\nimport {t} from 'sentry/locale';\nimport {Flamegraph} from 'sentry/utils/profiling/flamegraph';\nimport {useParams} from 'sentry/utils/useParams';\n\ninterface FlamegraphWarningProps {\n  flamegraph: Flamegraph;\n}\n\nexport function FlamegraphWarnings(props: FlamegraphWarningProps) {\n  const params = useParams();\n\n  if (props.flamegraph.profile.samples.length === 0) {\n    return (\n      <Overlay>\n        <p>\n          {t(\n            'This profile either has no samples or the total duration of frames in the profile is 0.'\n          )}\n        </p>\n        <div>\n          <ExportProfileButton\n            variant=\"default\"\n            eventId={params.eventId}\n            orgId={params.orgId}\n            size=\"sm\"\n            projectId={params.projectId}\n            title={undefined}\n            disabled={\n              params.eventId === undefined ||\n              params.orgId === undefined ||\n              params.projectId === undefined\n            }\n          >\n            {t('Export Raw Profile')}\n          </ExportProfileButton>\n        </div>\n      </Overlay>\n    );\n  }\n\n  return null;\n}\n\nconst Overlay = styled('div')`\n  position: absolute;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  display: grid;\n  grid: auto/50%;\n  place-content: center;\n  z-index: ${p => p.theme.zIndex.modal};\n  text-align: center;\n`;\n","import {memo, MouseEventHandler, useCallback, useMemo, useState} from 'react';\nimport styled from '@emotion/styled';\n\nimport Button from 'sentry/components/button';\nimport {ExportProfileButton} from 'sentry/components/profiling/exportProfileButton';\nimport {IconPanel} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {CanvasPoolManager} from 'sentry/utils/profiling/canvasScheduler';\nimport {filterFlamegraphTree} from 'sentry/utils/profiling/filterFlamegraphTree';\nimport {Flamegraph} from 'sentry/utils/profiling/flamegraph';\nimport {FlamegraphPreferences} from 'sentry/utils/profiling/flamegraph/flamegraphStateProvider/flamegraphPreferences';\nimport {useFlamegraphPreferences} from 'sentry/utils/profiling/flamegraph/useFlamegraphPreferences';\nimport {FlamegraphFrame} from 'sentry/utils/profiling/flamegraphFrame';\nimport {invertCallTree} from 'sentry/utils/profiling/profile/utils';\nimport {useParams} from 'sentry/utils/useParams';\n\nimport {FrameStackTable} from './frameStackTable';\n\ninterface FrameStackProps {\n  canvasPoolManager: CanvasPoolManager;\n  formatDuration: Flamegraph['formatter'];\n  getFrameColor: (frame: FlamegraphFrame) => string;\n  referenceNode: FlamegraphFrame;\n  rootNodes: FlamegraphFrame[];\n  onResize?: MouseEventHandler<HTMLElement>;\n}\n\nconst FrameStack = memo(function FrameStack(props: FrameStackProps) {\n  const params = useParams();\n  const [flamegraphPreferences, dispatchFlamegraphPreferences] =\n    useFlamegraphPreferences();\n\n  const [tab, setTab] = useState<'bottom up' | 'call order'>('call order');\n  const [treeType, setTreeType] = useState<'all' | 'application' | 'system'>('all');\n  const [recursion, setRecursion] = useState<'collapsed' | null>(null);\n\n  const maybeFilteredOrInvertedTree: FlamegraphFrame[] | null = useMemo(() => {\n    const skipFunction: (f: FlamegraphFrame) => boolean =\n      treeType === 'application'\n        ? f => !f.frame.is_application\n        : treeType === 'system'\n        ? f => f.frame.is_application\n        : () => false;\n\n    const maybeFilteredRoots =\n      treeType !== 'all'\n        ? filterFlamegraphTree(props.rootNodes, skipFunction)\n        : props.rootNodes;\n\n    if (tab === 'call order') {\n      return maybeFilteredRoots;\n    }\n\n    return invertCallTree(maybeFilteredRoots);\n  }, [tab, treeType, props.rootNodes]);\n\n  const handleRecursionChange = useCallback(\n    (evt: React.ChangeEvent<HTMLInputElement>) => {\n      setRecursion(evt.currentTarget.checked ? 'collapsed' : null);\n    },\n    []\n  );\n\n  const onBottomUpClick = useCallback(() => {\n    setTab('bottom up');\n  }, []);\n\n  const onCallOrderClick = useCallback(() => {\n    setTab('call order');\n  }, []);\n\n  const onAllApplicationsClick = useCallback(() => {\n    setTreeType('all');\n  }, []);\n\n  const onApplicationsClick = useCallback(() => {\n    setTreeType('application');\n  }, []);\n\n  const onSystemsClick = useCallback(() => {\n    setTreeType('system');\n  }, []);\n\n  const onTableLeftClick = useCallback(() => {\n    dispatchFlamegraphPreferences({type: 'set layout', payload: 'table left'});\n  }, [dispatchFlamegraphPreferences]);\n\n  const onTableBottomClick = useCallback(() => {\n    dispatchFlamegraphPreferences({type: 'set layout', payload: 'table bottom'});\n  }, [dispatchFlamegraphPreferences]);\n\n  const onTableRightClick = useCallback(() => {\n    dispatchFlamegraphPreferences({type: 'set layout', payload: 'table right'});\n  }, [dispatchFlamegraphPreferences]);\n\n  return (\n    <FrameDrawer layout={flamegraphPreferences.layout}>\n      <FrameTabs>\n        <ListItem className={tab === 'bottom up' ? 'active' : undefined}>\n          <Button\n            data-title={t('Bottom Up')}\n            priority=\"link\"\n            size=\"zero\"\n            onClick={onBottomUpClick}\n          >\n            {t('Bottom Up')}\n          </Button>\n        </ListItem>\n        <ListItem margin=\"none\" className={tab === 'call order' ? 'active' : undefined}>\n          <Button\n            data-title={t('Call Order')}\n            priority=\"link\"\n            size=\"zero\"\n            onClick={onCallOrderClick}\n          >\n            {t('Call Order')}\n          </Button>\n        </ListItem>\n        <Separator />\n        <ListItem className={treeType === 'all' ? 'active' : undefined}>\n          <Button\n            data-title={t('All Frames')}\n            priority=\"link\"\n            size=\"zero\"\n            onClick={onAllApplicationsClick}\n          >\n            {t('All Frames')}\n          </Button>\n        </ListItem>\n        <ListItem className={treeType === 'application' ? 'active' : undefined}>\n          <Button\n            data-title={t('Application Frames')}\n            priority=\"link\"\n            size=\"zero\"\n            onClick={onApplicationsClick}\n          >\n            {t('Application Frames')}\n          </Button>\n        </ListItem>\n        <ListItem margin=\"none\" className={treeType === 'system' ? 'active' : undefined}>\n          <Button\n            data-title={t('System Frames')}\n            priority=\"link\"\n            size=\"zero\"\n            onClick={onSystemsClick}\n          >\n            {t('System Frames')}\n          </Button>\n        </ListItem>\n        <Separator />\n        <ListItem>\n          <FrameDrawerLabel>\n            <input\n              type=\"checkbox\"\n              checked={recursion === 'collapsed'}\n              onChange={handleRecursionChange}\n            />\n            {t('Collapse recursion')}\n          </FrameDrawerLabel>\n        </ListItem>\n        <ListItem\n          style={{\n            flex: '1 1 100%',\n            cursor:\n              flamegraphPreferences.layout === 'table bottom' ? 'ns-resize' : undefined,\n          }}\n          onMouseDown={\n            flamegraphPreferences.layout === 'table bottom' ? props.onResize : undefined\n          }\n        />\n        <ListItem margin=\"none\">\n          <ExportProfileButton\n            variant=\"xs\"\n            eventId={params.eventId}\n            orgId={params.orgId}\n            projectId={params.projectId}\n            disabled={\n              params.eventId === undefined ||\n              params.orgId === undefined ||\n              params.projectId === undefined\n            }\n          />\n        </ListItem>\n        <Separator />\n        <ListItem>\n          <LayoutSelectionContainer>\n            <StyledButton\n              active={flamegraphPreferences.layout === 'table left'}\n              onClick={onTableLeftClick}\n              size=\"xs\"\n              title={t('Table left')}\n            >\n              <IconPanel size=\"xs\" direction=\"right\" />\n            </StyledButton>\n            <StyledButton\n              active={flamegraphPreferences.layout === 'table bottom'}\n              onClick={onTableBottomClick}\n              size=\"xs\"\n              title={t('Table bottom')}\n            >\n              <IconPanel size=\"xs\" direction=\"down\" />\n            </StyledButton>\n            <StyledButton\n              active={flamegraphPreferences.layout === 'table right'}\n              onClick={onTableRightClick}\n              size=\"xs\"\n              title={t('Table right')}\n            >\n              <IconPanel size=\"xs\" direction=\"left\" />\n            </StyledButton>\n          </LayoutSelectionContainer>\n        </ListItem>\n      </FrameTabs>\n      <FrameStackTable\n        {...props}\n        recursion={recursion}\n        referenceNode={props.referenceNode}\n        tree={maybeFilteredOrInvertedTree ?? []}\n        canvasPoolManager={props.canvasPoolManager}\n      />\n      {flamegraphPreferences.layout === 'table left' ||\n      flamegraphPreferences.layout === 'table right' ? (\n        <ResizableVerticalDrawer>\n          {/* The border should be 1px, but we want the actual handler to be wider\n          to improve the user experience and not have users have to click on the exact pixel */}\n          <InvisibleHandler onMouseDown={props.onResize} />\n        </ResizableVerticalDrawer>\n      ) : null}\n    </FrameDrawer>\n  );\n});\n\nconst ResizableVerticalDrawer = styled('div')`\n  width: 1px;\n  grid-area: drawer;\n  background-color: ${p => p.theme.border};\n  position: relative;\n`;\n\nconst InvisibleHandler = styled('div')`\n  opacity: 0;\n  width: ${space(1)};\n  position: absolute;\n  inset: 0;\n  cursor: ew-resize;\n  transform: translateX(-50%);\n  background-color: transparent;\n`;\n\nconst FrameDrawerLabel = styled('label')`\n  display: flex;\n  align-items: center;\n  white-space: nowrap;\n  margin-bottom: 0;\n  height: 100%;\n  font-weight: normal;\n\n  > input {\n    margin: 0 ${space(0.5)} 0 0;\n  }\n`;\n\n// Linter produces a false positive for the grid layout. I did not manage to find out\n// how to \"fix it\" or why it is not working, I imagine it could be due to the ternary?\nconst FrameDrawer = styled('div')<{layout: FlamegraphPreferences['layout']}>`\n  display: grid;\n  grid-template-rows: auto 1fr;\n  grid-template-columns: ${({layout}) =>\n    layout === 'table left' ? '1fr auto' : layout === 'table right' ? 'auto 1fr' : '1fr'};\n  /* false positive for grid layout */\n  /* stylelint-disable */\n  grid-template-areas: ${({layout}) =>\n    layout === 'table bottom'\n      ? `\n    'tabs'\n    'table'\n    'drawer'\n    `\n      : layout === 'table left'\n      ? `\n      'tabs drawer'\n      'table drawer'\n      `\n      : `\n      'drawer tabs'\n      'drawer table'\n      `};\n`;\nconst Separator = styled('li')`\n  width: 1px;\n  height: 66%;\n  margin: 0 ${space(1)};\n  background: ${p => p.theme.border};\n  transform: translateY(29%);\n`;\n\nconst FrameTabs = styled('ul')`\n  display: flex;\n  list-style-type: none;\n  padding: 0 ${space(1)};\n  margin: 0;\n  border-top: 1px solid ${prop => prop.theme.border};\n  background-color: ${props => props.theme.surface100};\n  user-select: none;\n  grid-area: tabs;\n`;\n\nconst ListItem = styled('li')<{margin?: 'none'}>`\n  font-size: ${p => p.theme.fontSizeSmall};\n  margin-right: ${p => (p.margin === 'none' ? 0 : space(1))};\n\n  button {\n    border: none;\n    border-top: 2px solid transparent;\n    border-bottom: 2px solid transparent;\n    border-radius: 0;\n    margin: 0;\n    padding: ${space(0.5)} 0;\n    color: ${p => p.theme.textColor};\n\n    &::after {\n      display: block;\n      content: attr(data-title);\n      font-weight: bold;\n      height: 1px;\n      color: transparent;\n      overflow: hidden;\n      visibility: hidden;\n      white-space: nowrap;\n    }\n\n    &:hover {\n      color: ${p => p.theme.textColor};\n    }\n  }\n\n  &.active button {\n    font-weight: bold;\n    border-bottom: 2px solid ${prop => prop.theme.active};\n  }\n`;\n\nconst StyledButton = styled(Button)<{active: boolean}>`\n  border: none;\n  background-color: transparent;\n  box-shadow: none;\n  transition: none !important;\n  opacity: ${p => (p.active ? 0.7 : 0.5)};\n\n  &:not(:last-child) {\n    margin-right: ${space(1)};\n  }\n\n  &:hover {\n    border: none;\n    background-color: transparent;\n    box-shadow: none;\n    opacity: ${p => (p.active ? 0.6 : 0.5)};\n  }\n`;\n\nconst LayoutSelectionContainer = styled('div')`\n  display: flex;\n  align-items: center;\n`;\n\nconst FRAME_WEIGHT_CELL_WIDTH_PX = 164;\nexport const FrameCallersTableCell = styled('div')<{\n  isSelected?: boolean;\n  noPadding?: boolean;\n  textAlign?: React.CSSProperties['textAlign'];\n}>`\n  width: ${FRAME_WEIGHT_CELL_WIDTH_PX}px;\n  position: relative;\n  white-space: nowrap;\n  flex-shrink: 0;\n  padding: 0 ${p => (p.noPadding ? 0 : space(1))} 0 0;\n  text-align: ${p => p.textAlign ?? 'initial'};\n\n  &:first-child,\n  &:nth-child(2) {\n    position: sticky;\n    z-index: 1;\n    background-color: ${p => (p.isSelected ? p.theme.blue300 : p.theme.background)};\n  }\n\n  &:first-child {\n    left: 0;\n  }\n  &:nth-child(2) {\n    left: ${FRAME_WEIGHT_CELL_WIDTH_PX}px;\n  }\n\n  &:not(:last-child) {\n    border-right: 1px solid ${p => p.theme.border};\n  }\n`;\n\nexport {FrameStack};\n","import {Fragment} from 'react';\n\nimport {\n  ProfilingContextMenu,\n  ProfilingContextMenuGroup,\n  ProfilingContextMenuHeading,\n  ProfilingContextMenuItem,\n  ProfilingContextMenuLayer,\n} from 'sentry/components/profiling/ProfilingContextMenu/profilingContextMenu';\nimport {t} from 'sentry/locale';\nimport {useContextMenu} from 'sentry/utils/profiling/hooks/useContextMenu';\n\ninterface FrameStackContextMenuProps {\n  contextMenu: ReturnType<typeof useContextMenu>;\n  onZoomIntoFrameClick: (evt: React.MouseEvent<HTMLDivElement>) => void;\n}\n\nexport function FrameStackContextMenu(props: FrameStackContextMenuProps) {\n  return props.contextMenu.open ? (\n    <Fragment>\n      <ProfilingContextMenuLayer onClick={() => props.contextMenu.setOpen(false)} />\n      <ProfilingContextMenu\n        {...props.contextMenu.getMenuProps()}\n        style={{\n          position: 'absolute',\n          left: props.contextMenu.position?.left ?? -9999,\n          top: props.contextMenu.position?.top ?? -9999,\n          maxHeight: props.contextMenu.containerCoordinates?.height ?? 'auto',\n        }}\n      >\n        <ProfilingContextMenuGroup>\n          <ProfilingContextMenuHeading>{t('Actions')}</ProfilingContextMenuHeading>\n          <ProfilingContextMenuItem\n            {...props.contextMenu.getMenuItemProps()}\n            onClick={props.onZoomIntoFrameClick}\n          >\n            {t('Show in flamegraph')}\n          </ProfilingContextMenuItem>\n        </ProfilingContextMenuGroup>\n      </ProfilingContextMenu>\n    </Fragment>\n  ) : null;\n}\n","import {useCallback, useMemo, useState} from 'react';\nimport styled from '@emotion/styled';\n\nimport {IconArrow} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {CanvasPoolManager} from 'sentry/utils/profiling/canvasScheduler';\nimport {Flamegraph} from 'sentry/utils/profiling/flamegraph';\nimport {FlamegraphFrame} from 'sentry/utils/profiling/flamegraphFrame';\nimport {useContextMenu} from 'sentry/utils/profiling/hooks/useContextMenu';\nimport {\n  UseVirtualizedListProps,\n  useVirtualizedTree,\n} from 'sentry/utils/profiling/hooks/useVirtualizedTree/useVirtualizedTree';\nimport {VirtualizedTreeNode} from 'sentry/utils/profiling/hooks/useVirtualizedTree/VirtualizedTreeNode';\n\nimport {FrameCallersTableCell} from './frameStack';\nimport {FrameStackContextMenu} from './frameStackContextMenu';\nimport {FrameStackTableRow} from './frameStackTableRow';\n\nfunction makeSortFunction(\n  property: 'total weight' | 'self weight' | 'name',\n  direction: 'asc' | 'desc'\n) {\n  if (property === 'total weight') {\n    return direction === 'desc'\n      ? (\n          a: VirtualizedTreeNode<FlamegraphFrame>,\n          b: VirtualizedTreeNode<FlamegraphFrame>\n        ) => {\n          return b.node.node.totalWeight - a.node.node.totalWeight;\n        }\n      : (\n          a: VirtualizedTreeNode<FlamegraphFrame>,\n          b: VirtualizedTreeNode<FlamegraphFrame>\n        ) => {\n          return a.node.node.totalWeight - b.node.node.totalWeight;\n        };\n  }\n\n  if (property === 'self weight') {\n    return direction === 'desc'\n      ? (\n          a: VirtualizedTreeNode<FlamegraphFrame>,\n          b: VirtualizedTreeNode<FlamegraphFrame>\n        ) => {\n          return b.node.node.selfWeight - a.node.node.selfWeight;\n        }\n      : (\n          a: VirtualizedTreeNode<FlamegraphFrame>,\n          b: VirtualizedTreeNode<FlamegraphFrame>\n        ) => {\n          return a.node.node.selfWeight - b.node.node.selfWeight;\n        };\n  }\n\n  if (property === 'name') {\n    return direction === 'desc'\n      ? (\n          a: VirtualizedTreeNode<FlamegraphFrame>,\n          b: VirtualizedTreeNode<FlamegraphFrame>\n        ) => {\n          return a.node.frame.name.localeCompare(b.node.frame.name);\n        }\n      : (\n          a: VirtualizedTreeNode<FlamegraphFrame>,\n          b: VirtualizedTreeNode<FlamegraphFrame>\n        ) => {\n          return b.node.frame.name.localeCompare(a.node.frame.name);\n        };\n  }\n\n  throw new Error(`Unknown sort property ${property}`);\n}\n\nfunction skipRecursiveNodes(n: VirtualizedTreeNode<FlamegraphFrame>): boolean {\n  return n.node.node.isDirectRecursive();\n}\n\ninterface FrameStackTableProps {\n  canvasPoolManager: CanvasPoolManager;\n  formatDuration: Flamegraph['formatter'];\n  getFrameColor: (frame: FlamegraphFrame) => string;\n  recursion: 'collapsed' | null;\n  referenceNode: FlamegraphFrame;\n  tree: FlamegraphFrame[];\n}\n\nexport function FrameStackTable({\n  tree,\n  referenceNode,\n  canvasPoolManager,\n  getFrameColor,\n  formatDuration,\n  recursion,\n}: FrameStackTableProps) {\n  const [scrollContainerRef, setScrollContainerRef] = useState<HTMLDivElement | null>(\n    null\n  );\n  const [sort, setSort] = useState<'total weight' | 'self weight' | 'name'>(\n    'total weight'\n  );\n  const [direction, setDirection] = useState<'asc' | 'desc'>('desc');\n  const sortFunction = useMemo(() => {\n    return makeSortFunction(sort, direction);\n  }, [sort, direction]);\n\n  const [clickedContextMenuNode, setClickedContextMenuClose] =\n    useState<VirtualizedTreeNode<FlamegraphFrame> | null>(null);\n\n  const contextMenu = useContextMenu({container: scrollContainerRef});\n\n  const handleZoomIntoFrameClick = useCallback(() => {\n    if (!clickedContextMenuNode) {\n      return;\n    }\n\n    canvasPoolManager.dispatch('zoom at frame', [clickedContextMenuNode.node, 'exact']);\n    canvasPoolManager.dispatch('highlight frame', [\n      clickedContextMenuNode.node,\n      'selected',\n    ]);\n  }, [canvasPoolManager, clickedContextMenuNode]);\n\n  const renderRow: UseVirtualizedListProps<FlamegraphFrame>['renderRow'] = useCallback(\n    (\n      r,\n      {\n        handleRowClick,\n        handleRowMouseEnter,\n        handleExpandTreeNode,\n        handleRowKeyDown,\n        tabIndexKey,\n      }\n    ) => {\n      return (\n        <FrameStackTableRow\n          ref={n => {\n            r.ref = n;\n          }}\n          node={r.item}\n          style={r.styles}\n          referenceNode={referenceNode}\n          frameColor={getFrameColor(r.item.node)}\n          formatDuration={formatDuration}\n          tabIndex={tabIndexKey === r.key ? 0 : 1}\n          onClick={handleRowClick}\n          onExpandClick={handleExpandTreeNode}\n          onKeyDown={handleRowKeyDown}\n          onMouseEnter={handleRowMouseEnter}\n          onContextMenu={evt => {\n            setClickedContextMenuClose(r.item);\n            contextMenu.handleContextMenu(evt);\n          }}\n        />\n      );\n    },\n    [contextMenu, formatDuration, referenceNode, getFrameColor]\n  );\n\n  const {\n    renderedItems,\n    scrollContainerStyles,\n    containerStyles,\n    handleSortingChange,\n    clickedGhostRowRef,\n    hoveredGhostRowRef,\n  } = useVirtualizedTree({\n    skipFunction: recursion === 'collapsed' ? skipRecursiveNodes : undefined,\n    sortFunction,\n    renderRow,\n    scrollContainer: scrollContainerRef,\n    rowHeight: 24,\n    tree,\n  });\n\n  const onSortChange = useCallback(\n    (newSort: 'total weight' | 'self weight' | 'name') => {\n      const newDirection =\n        newSort === sort ? (direction === 'asc' ? 'desc' : 'asc') : 'desc';\n\n      setDirection(newDirection);\n      setSort(newSort);\n\n      const sortFn = makeSortFunction(newSort, newDirection);\n      handleSortingChange(sortFn);\n    },\n    [sort, direction, handleSortingChange]\n  );\n\n  return (\n    <FrameBar>\n      <FrameCallersTable>\n        <FrameCallersTableHeader>\n          <FrameWeightCell>\n            <TableHeaderButton onClick={() => onSortChange('self weight')}>\n              {t('Self Time ')}\n              {sort === 'self weight' ? (\n                <IconArrow direction={direction === 'desc' ? 'down' : 'up'} />\n              ) : null}\n            </TableHeaderButton>\n          </FrameWeightCell>\n          <FrameWeightCell>\n            <TableHeaderButton onClick={() => onSortChange('total weight')}>\n              {t('Total Time')}{' '}\n              {sort === 'total weight' ? (\n                <IconArrow direction={direction === 'desc' ? 'down' : 'up'} />\n              ) : null}\n            </TableHeaderButton>\n          </FrameWeightCell>\n          <FrameNameCell>\n            <TableHeaderButton onClick={() => onSortChange('name')}>\n              {t('Frame')}{' '}\n              {sort === 'name' ? (\n                <IconArrow direction={direction === 'desc' ? 'down' : 'up'} />\n              ) : null}\n            </TableHeaderButton>\n          </FrameNameCell>\n        </FrameCallersTableHeader>\n        <FrameStackContextMenu\n          onZoomIntoFrameClick={handleZoomIntoFrameClick}\n          contextMenu={contextMenu}\n        />\n        <TableItemsContainer>\n          {/*\n          The order of these two matters because we want clicked state to\n          be on top of hover in cases where user is hovering a clicked row.\n           */}\n          <div ref={hoveredGhostRowRef} />\n          <div ref={clickedGhostRowRef} />\n          <div\n            ref={ref => setScrollContainerRef(ref)}\n            style={scrollContainerStyles}\n            onContextMenu={contextMenu.handleContextMenu}\n          >\n            <div style={containerStyles}>\n              {renderedItems}\n              {/*\n              This is a ghost row, we stretch its width and height to fit the entire table\n              so that borders on columns are shown across the entire table and not just the rows.\n              This is useful when number of rows does not fill up the entire table height.\n             */}\n              <GhostRowContainer>\n                <FrameCallersTableCell />\n                <FrameCallersTableCell />\n                <FrameCallersTableCell style={{width: '100%'}} />\n              </GhostRowContainer>\n            </div>\n          </div>\n        </TableItemsContainer>\n      </FrameCallersTable>\n    </FrameBar>\n  );\n}\n\nconst TableItemsContainer = styled('div')`\n  position: relative;\n  height: 100%;\n  overflow: hidden;\n  background: ${p => p.theme.background};\n`;\n\nconst GhostRowContainer = styled('div')`\n  display: flex;\n  width: 100%;\n  pointer-events: none;\n  position: absolute;\n  height: 100%;\n  z-index: -1;\n`;\n\nconst TableHeaderButton = styled('button')`\n  display: flex;\n  width: 100%;\n  align-items: center;\n  justify-content: space-between;\n  padding: 0 ${space(1)};\n  border: none;\n  background-color: ${props => props.theme.surface100};\n  transition: background-color 100ms ease-in-out;\n  line-height: 24px;\n\n  &:hover {\n    background-color: ${props => props.theme.surface400};\n  }\n\n  svg {\n    width: 10px;\n    height: 10px;\n  }\n`;\n\nconst FrameBar = styled('div')`\n  overflow: auto;\n  width: 100%;\n  position: relative;\n  background-color: ${p => p.theme.surface100};\n  border-top: 1px solid ${p => p.theme.border};\n  flex: 1 1 100%;\n  grid-area: table;\n`;\n\nconst FrameCallersTable = styled('div')`\n  font-size: ${p => p.theme.fontSizeSmall};\n  margin: 0;\n  overflow: auto;\n  max-height: 100%;\n  height: 100%;\n  width: 100%;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst FRAME_WEIGHT_CELL_WIDTH_PX = 164;\n\nconst FrameWeightCell = styled('div')`\n  width: ${FRAME_WEIGHT_CELL_WIDTH_PX}px;\n`;\n\nconst FrameNameCell = styled('div')`\n  flex: 1 1 100%;\n`;\n\nconst FrameCallersTableHeader = styled('div')`\n  top: 0;\n  position: sticky;\n  z-index: 1;\n  display: flex;\n  flex: 1;\n\n  > div {\n    position: relative;\n    border-bottom: 1px solid ${p => p.theme.border};\n    background-color: ${p => p.theme.background};\n    white-space: nowrap;\n\n    &:last-child {\n      flex: 1;\n    }\n\n    &:not(:last-child) {\n      border-right: 1px solid ${p => p.theme.border};\n    }\n  }\n`;\n","import {forwardRef, useCallback} from 'react';\nimport styled from '@emotion/styled';\n\nimport {IconSettings, IconUser} from 'sentry/icons';\nimport space from 'sentry/styles/space';\nimport {Flamegraph} from 'sentry/utils/profiling/flamegraph';\nimport {FlamegraphFrame} from 'sentry/utils/profiling/flamegraphFrame';\nimport {VirtualizedTreeNode} from 'sentry/utils/profiling/hooks/useVirtualizedTree/VirtualizedTreeNode';\n\nimport {FrameCallersTableCell} from './frameStack';\n\nfunction computeRelativeWeight(base: number, value: number) {\n  // Make sure we dont divide by zero\n  if (!base || !value) {\n    return 0;\n  }\n  return (value / base) * 100;\n}\n\ninterface FrameStackTableRowProps {\n  formatDuration: Flamegraph['formatter'];\n  frameColor: string;\n  node: VirtualizedTreeNode<FlamegraphFrame>;\n  onClick: React.MouseEventHandler<HTMLDivElement>;\n  onContextMenu: React.MouseEventHandler<HTMLDivElement>;\n  onExpandClick: (\n    node: VirtualizedTreeNode<FlamegraphFrame>,\n    opts?: {expandChildren: boolean}\n  ) => void;\n  onKeyDown: React.KeyboardEventHandler<HTMLDivElement>;\n  onMouseEnter: React.MouseEventHandler<HTMLDivElement>;\n  referenceNode: FlamegraphFrame;\n  style: React.CSSProperties;\n  tabIndex: number;\n}\n\nexport const FrameStackTableRow = forwardRef<HTMLDivElement, FrameStackTableRowProps>(\n  (\n    {\n      node,\n      referenceNode,\n      onExpandClick,\n      onContextMenu,\n      formatDuration,\n      frameColor,\n      tabIndex,\n      onKeyDown,\n      onClick,\n      onMouseEnter,\n      style,\n    },\n    ref\n  ) => {\n    const isSelected = tabIndex === 0;\n\n    const handleExpanding = useCallback(\n      (evt: React.MouseEvent) => {\n        evt.stopPropagation();\n        onExpandClick(node, {expandChildren: evt.metaKey});\n      },\n      [node, onExpandClick]\n    );\n\n    return (\n      <FrameCallersRow\n        ref={ref}\n        style={style}\n        onContextMenu={onContextMenu}\n        tabIndex={tabIndex}\n        isSelected={isSelected}\n        onKeyDown={onKeyDown}\n        onClick={onClick}\n        onMouseEnter={onMouseEnter}\n      >\n        <FrameCallersTableCell isSelected={isSelected} textAlign=\"right\">\n          {formatDuration(node.node.node.selfWeight)}\n          <Weight\n            isSelected={isSelected}\n            weight={computeRelativeWeight(\n              referenceNode.node.totalWeight,\n              node.node.node.selfWeight\n            )}\n          />\n        </FrameCallersTableCell>\n        <FrameCallersTableCell isSelected={isSelected} noPadding textAlign=\"right\">\n          <FrameWeightTypeContainer>\n            <FrameWeightContainer>\n              {formatDuration(node.node.node.totalWeight)}\n              <Weight\n                padded\n                isSelected={isSelected}\n                weight={computeRelativeWeight(\n                  referenceNode.node.totalWeight,\n                  node.node.node.totalWeight\n                )}\n              />\n            </FrameWeightContainer>\n            <FrameTypeIndicator isSelected={isSelected}>\n              {node.node.node.frame.is_application ? (\n                <IconUser size=\"xs\" />\n              ) : (\n                <IconSettings size=\"xs\" />\n              )}\n            </FrameTypeIndicator>\n          </FrameWeightTypeContainer>\n        </FrameCallersTableCell>\n        <FrameCallersTableCell\n          // We stretch this table to 100% width.\n          style={{paddingLeft: node.depth * 14 + 8, width: '100%'}}\n        >\n          <FrameNameContainer>\n            {/* @TODO FIX COLOR */}\n            <FrameColorIndicator style={{backgroundColor: frameColor}} />\n            <FrameChildrenIndicator\n              tabIndex={-1}\n              onClick={handleExpanding}\n              open={node.expanded}\n            >\n              {node.node.children.length > 0 ? '\\u203A' : null}\n            </FrameChildrenIndicator>\n            <FrameName>{node.node.frame.name}</FrameName>\n          </FrameNameContainer>\n        </FrameCallersTableCell>\n      </FrameCallersRow>\n    );\n  }\n);\n\nconst Weight = styled(\n  (props: {isSelected: boolean; weight: number; padded?: boolean}) => {\n    const {weight, padded: __, isSelected: _, ...rest} = props;\n    return (\n      <div {...rest}>\n        {weight.toFixed(1)}%\n        <BackgroundWeightBar style={{transform: `scaleX(${weight / 100})`}} />\n      </div>\n    );\n  }\n)`\n  display: inline-block;\n  min-width: 7ch;\n  padding-right: ${p => (p.padded ? space(0.5) : 0)};\n  color: ${p => (p.isSelected ? p.theme.white : p.theme.subText)};\n  opacity: ${p => (p.isSelected ? 0.8 : 1)};\n`;\n\nconst FrameWeightTypeContainer = styled('div')`\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  position: relative;\n`;\n\nconst FrameTypeIndicator = styled('div')<{isSelected: boolean}>`\n  flex-shrink: 0;\n  width: 26px;\n  height: 12px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: ${p => (p.isSelected ? p.theme.white : p.theme.subText)};\n  opacity: ${p => (p.isSelected ? 0.8 : 1)};\n`;\n\nconst FrameWeightContainer = styled('div')`\n  display: flex;\n  align-items: center;\n  position: relative;\n  justify-content: flex-end;\n  flex: 1 1 100%;\n`;\n\nconst BackgroundWeightBar = styled('div')`\n  pointer-events: none;\n  position: absolute;\n  right: 0;\n  top: 0;\n  background-color: ${props => props.theme.yellow100};\n  border-bottom: 1px solid ${props => props.theme.yellow200};\n  transform-origin: center right;\n  height: 100%;\n  width: 100%;\n`;\n\nconst FrameCallersRow = styled('div')<{isSelected: boolean}>`\n  display: flex;\n  width: 100%;\n  color: ${p => (p.isSelected ? p.theme.white : 'inherit')};\n  scroll-margin-top: 24px;\n  font-size: ${p => p.theme.fontSizeSmall};\n  line-height: 24px;\n\n  &:focus {\n    outline: none;\n  }\n\n  &[data-hovered='true']:not([tabindex='0']) {\n    > div:first-child,\n    > div:nth-child(2) {\n      background-color: ${p => p.theme.surface100} !important;\n    }\n  }\n`;\n\nconst FrameNameContainer = styled('div')`\n  display: flex;\n  align-items: center;\n`;\n\nconst FrameChildrenIndicator = styled('button')<{open: boolean}>`\n  width: 10px;\n  height: 10px;\n  display: flex;\n  padding: 0;\n  border: none;\n  background-color: transparent;\n  align-items: center;\n  justify-content: center;\n  user-select: none;\n  transform: ${p => (p.open ? 'rotate(90deg)' : 'rotate(0deg)')};\n`;\n\nconst FrameName = styled('span')`\n  margin-left: ${space(0.5)};\n`;\n\nconst FrameColorIndicator = styled('div')`\n  width: 12px;\n  height: 12px;\n  border-radius: 2px;\n  display: inline-block;\n  flex-shrink: 0;\n  margin-right: ${space(0.5)};\n`;\n","import {forwardRef} from 'react';\nimport styled from '@emotion/styled';\n\nimport {IconCheckmark} from 'sentry/icons';\nimport space from 'sentry/styles/space';\n\ninterface MenuProps\n  extends React.DetailedHTMLProps<React.HTMLAttributes<HTMLDivElement>, HTMLDivElement> {\n  children: React.ReactNode;\n}\n\nconst Menu = styled(\n  forwardRef((props: MenuProps, ref: React.Ref<HTMLDivElement> | undefined) => {\n    return <div ref={ref} role=\"menu\" {...props} />;\n  })\n)`\n  position: absolute;\n  font-size: ${p => p.theme.fontSizeMedium};\n  z-index: ${p => p.theme.zIndex.dropdown};\n  background: ${p => p.theme.backgroundElevated};\n  border: 1px solid ${p => p.theme.border};\n  border-radius: ${p => p.theme.borderRadius};\n  box-shadow: ${p => p.theme.dropShadowHeavy};\n  width: auto;\n  min-width: 164px;\n  overflow: auto;\n  padding-bottom: ${space(0.5)};\n`;\n\nexport {Menu as ProfilingContextMenu};\n\nconst MenuContentContainer = styled('div')`\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  font-weight: normal;\n  padding: 0 ${space(1)};\n  border-radius: ${p => p.theme.borderRadius};\n  box-sizing: border-box;\n  background: ${p => (p.tabIndex === 0 ? p.theme.hover : undefined)};\n\n  &:focus {\n    color: ${p => p.theme.textColor};\n    background: ${p => p.theme.hover};\n    outline: none;\n  }\n`;\n\nconst MenuItemCheckboxLabel = styled('label')`\n  display: flex;\n  align-items: center;\n  font-weight: normal;\n  margin: 0;\n  cursor: pointer;\n  flex: 1 1 100%;\n`;\n\ninterface MenuItemCheckboxProps\n  extends React.DetailedHTMLProps<React.HTMLAttributes<HTMLDivElement>, HTMLDivElement> {\n  checked?: boolean;\n}\n\nconst MenuItemCheckbox = forwardRef(\n  (props: MenuItemCheckboxProps, ref: React.Ref<HTMLDivElement> | undefined) => {\n    const {children, checked, ...rest} = props;\n\n    return (\n      <MenuContentOuterContainer>\n        <MenuContentContainer ref={ref} role=\"menuitem\" {...rest}>\n          <MenuItemCheckboxLabel>\n            <MenuLeadingItem>\n              <Input type=\"checkbox\" checked={checked} onChange={() => void 0} />\n              <IconCheckmark />\n            </MenuLeadingItem>\n            <MenuContent>{children}</MenuContent>\n          </MenuItemCheckboxLabel>\n        </MenuContentContainer>\n      </MenuContentOuterContainer>\n    );\n  }\n);\n\nexport {MenuItemCheckbox as ProfilingContextMenuItemCheckbox};\n\nconst MenuLeadingItem = styled('div')`\n  display: flex;\n  align-items: center;\n  height: 1.4em;\n  width: 1em;\n  gap: ${space(1)};\n  padding: ${space(1)} 0;\n  position: relative;\n`;\n\nconst MenuContent = styled('div')`\n  position: relative;\n  width: 100%;\n  display: flex;\n  gap: ${space(0.5)};\n  justify-content: space-between;\n  padding: ${space(0.5)} 0;\n  margin-left: ${space(0.5)};\n  text-transform: capitalize;\n\n  margin-bottom: 0;\n  line-height: 1.4;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n`;\n\nconst Input = styled('input')`\n  position: absolute;\n  opacity: 0;\n  cursor: pointer;\n  height: 0;\n  padding-right: ${space(1)};\n\n  & + svg {\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    transform: translate(-50%, -50%);\n    width: 1em;\n    height: 1.4em;\n    display: none;\n  }\n\n  &:checked + svg {\n    display: block;\n  }\n`;\n\ninterface MenuItemProps\n  extends React.DetailedHTMLProps<React.HTMLAttributes<HTMLDivElement>, HTMLDivElement> {\n  children: React.ReactNode;\n}\n\nconst MenuItem = styled(\n  forwardRef((props: MenuItemProps, ref: React.Ref<HTMLDivElement> | undefined) => {\n    const {children, ...rest} = props;\n    return (\n      <MenuContentOuterContainer>\n        <MenuContentContainer ref={ref} role=\"menuitem\" {...rest}>\n          <MenuContent>{children}</MenuContent>\n        </MenuContentContainer>\n      </MenuContentOuterContainer>\n    );\n  })\n)`\n  cursor: pointer;\n  color: ${p => p.theme.textColor};\n  background: transparent;\n  padding: 0 ${space(0.5)};\n\n  &:focus {\n    outline: none;\n  }\n\n  &:active: {\n    background: transparent;\n  }\n`;\n\nexport {MenuItem as ProfilingContextMenuItem};\n\nconst MenuContentOuterContainer = styled('div')`\n  padding: 0 ${space(0.5)};\n`;\n\nconst MenuGroup = styled('div')`\n  padding-top: 0;\n  padding-bottom: ${space(1)};\n\n  &:last-of-type {\n    padding-bottom: 0;\n  }\n`;\n\nexport {MenuGroup as ProfilingContextMenuGroup};\n\ninterface MenuHeadingProps\n  extends React.DetailedHTMLProps<React.HTMLAttributes<HTMLDivElement>, HTMLDivElement> {\n  children: React.ReactNode;\n}\n\nconst MenuHeading = styled((props: MenuHeadingProps) => {\n  const {children, ...rest} = props;\n  return <div {...rest}>{children}</div>;\n})`\n  text-transform: uppercase;\n  line-height: 1.5;\n  font-weight: 600;\n  color: ${p => p.theme.subText};\n  margin-bottom: 0;\n  cursor: default;\n  font-size: 75%;\n  padding: ${space(0.5)} ${space(1.5)};\n`;\n\nexport {MenuHeading as ProfilingContextMenuHeading};\n\nconst Layer = styled('div')`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  z-index: ${p => p.theme.zIndex.dropdown - 1};\n`;\n\nexport {Layer as ProfilingContextMenuLayer};\n","import {useCallback, useRef} from 'react';\nimport styled from '@emotion/styled';\nimport {vec2} from 'gl-matrix';\n\nimport space from 'sentry/styles/space';\nimport {useFlamegraphTheme} from 'sentry/utils/profiling/flamegraph/useFlamegraphTheme';\nimport {FlamegraphCanvas} from 'sentry/utils/profiling/flamegraphCanvas';\nimport {FlamegraphView} from 'sentry/utils/profiling/flamegraphView';\nimport {Rect} from 'sentry/utils/profiling/gl/utils';\nimport theme from 'sentry/utils/theme';\n\nfunction computeBestTooltipPlacement(\n  cursor: vec2,\n  container: Rect,\n  tooltip: DOMRect\n): string {\n  // This is because the cursor's origin is in the top left corner of the arrow, so we want\n  // to offset it just enough so that the tooltip does not overlap with the arrow's tail.\n  // When the tooltip placed to the left of the cursor, we do not have that issue and hence\n  // no offset is applied.\n  const OFFSET_PX = 6;\n  let left = cursor[0] + OFFSET_PX;\n  const top = cursor[1] + OFFSET_PX;\n\n  if (cursor[0] > container.width / 2) {\n    left = cursor[0] - tooltip.width; // No offset is applied here as tooltip is placed to the left\n  }\n\n  return `translate(${left || 0}px, ${top || 0}px)`;\n}\n\ninterface BoundTooltipProps {\n  bounds: Rect;\n  cursor: vec2;\n  flamegraphCanvas: FlamegraphCanvas;\n  flamegraphView: FlamegraphView;\n  children?: React.ReactNode;\n}\n\nfunction BoundTooltip({\n  bounds,\n  flamegraphCanvas,\n  cursor,\n  flamegraphView,\n  children,\n}: BoundTooltipProps): React.ReactElement | null {\n  const flamegraphTheme = useFlamegraphTheme();\n\n  const physicalSpaceCursor = vec2.transformMat3(\n    vec2.create(),\n    cursor,\n    flamegraphView.fromConfigView(flamegraphCanvas.physicalSpace)\n  );\n\n  const logicalSpaceCursor = vec2.transformMat3(\n    vec2.create(),\n    physicalSpaceCursor,\n    flamegraphCanvas.physicalToLogicalSpace\n  );\n\n  const rafIdRef = useRef<number | undefined>();\n  const onRef = useCallback(\n    node => {\n      if (node === null) {\n        return;\n      }\n\n      if (rafIdRef.current) {\n        window.cancelAnimationFrame(rafIdRef.current);\n        rafIdRef.current = undefined;\n      }\n\n      rafIdRef.current = window.requestAnimationFrame(() => {\n        node.style.transform = computeBestTooltipPlacement(\n          logicalSpaceCursor,\n          bounds,\n          node.getBoundingClientRect()\n        );\n      });\n    },\n    [bounds, logicalSpaceCursor]\n  );\n\n  return (\n    <Tooltip\n      ref={onRef}\n      style={{\n        willChange: 'transform',\n        fontSize: flamegraphTheme.SIZES.TOOLTIP_FONT_SIZE,\n        fontFamily: flamegraphTheme.FONTS.FONT,\n        zIndex: theme.zIndex.tooltip,\n        maxWidth: bounds.width,\n      }}\n    >\n      {children}\n    </Tooltip>\n  );\n}\n\nconst Tooltip = styled('div')`\n  background: ${p => p.theme.background};\n  position: absolute;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  pointer-events: none;\n  user-select: none;\n  border-radius: ${p => p.theme.borderRadius};\n  padding: ${space(0.25)} ${space(1)};\n  border: 1px solid ${p => p.theme.border};\n  font-size: ${p => p.theme.fontSizeSmall};\n  line-height: 24px;\n`;\n\nexport {BoundTooltip};\n","import styled from '@emotion/styled';\n\nimport {IconDownload} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport useApi from 'sentry/utils/useApi';\nimport useOrganization from 'sentry/utils/useOrganization';\nimport useProjects from 'sentry/utils/useProjects';\n\nimport Button, {ButtonPropsWithoutAriaLabel} from '../button';\n\ninterface ExportProfileButtonProps\n  extends Omit<ButtonPropsWithoutAriaLabel, 'onClick' | 'children'> {\n  eventId: string | undefined;\n  orgId: string | undefined;\n  projectId: string | undefined;\n  children?: React.ReactNode;\n  variant?: 'xs' | 'default';\n}\n\nexport function ExportProfileButton(props: ExportProfileButtonProps) {\n  const api = useApi();\n  const organization = useOrganization();\n\n  const project = useProjects().projects.find(p => {\n    return p.slug === props.projectId;\n  });\n\n  const href = `${api.baseUrl}/projects/${props.orgId}/${props.projectId}/profiling/raw_profiles/${props.eventId}/`;\n  const download = `${organization.slug}_${\n    project?.slug ?? props.projectId ?? 'unknown_project'\n  }_${props.eventId}.profile.json`;\n\n  const title = t('Export Profile');\n\n  return props.variant === 'xs' ? (\n    <StyledButtonSmall size=\"xs\" title={title} href={href} download={download} {...props}>\n      {props.children}\n      <IconDownload size=\"xs\" />\n    </StyledButtonSmall>\n  ) : (\n    <Button\n      icon={<IconDownload />}\n      title={title}\n      href={href}\n      download={download}\n      {...props}\n    >\n      {props.children}\n    </Button>\n  );\n}\n\nconst StyledButtonSmall = styled(Button)`\n  border: none;\n  background-color: transparent;\n  box-shadow: none;\n  transition: none !important;\n  opacity: 0.5;\n  padding: ${space(0.5)} ${space(0.5)};\n\n  &:hover {\n    border: none;\n    background-color: transparent;\n    box-shadow: none;\n  }\n`;\n","import {\n  Fragment,\n  ReactElement,\n  useCallback,\n  useEffect,\n  useLayoutEffect,\n  useMemo,\n  useState,\n} from 'react';\nimport {mat3, vec2} from 'gl-matrix';\n\nimport {FlamegraphOptionsMenu} from 'sentry/components/profiling/flamegraphOptionsMenu';\nimport {FlamegraphSearch} from 'sentry/components/profiling/flamegraphSearch';\nimport {FlamegraphToolbar} from 'sentry/components/profiling/flamegraphToolbar';\nimport {FlamegraphViewSelectMenu} from 'sentry/components/profiling/flamegraphViewSelectMenu';\nimport {FlamegraphZoomView} from 'sentry/components/profiling/flamegraphZoomView';\nimport {FlamegraphZoomViewMinimap} from 'sentry/components/profiling/flamegraphZoomViewMinimap';\nimport {FrameStack} from 'sentry/components/profiling/FrameStack/frameStack';\nimport {\n  ProfileDragDropImport,\n  ProfileDragDropImportProps,\n} from 'sentry/components/profiling/profileDragDropImport';\nimport {ThreadMenuSelector} from 'sentry/components/profiling/threadSelector';\nimport {CanvasPoolManager, CanvasScheduler} from 'sentry/utils/profiling/canvasScheduler';\nimport {Flamegraph as FlamegraphModel} from 'sentry/utils/profiling/flamegraph';\nimport {useFlamegraphPreferences} from 'sentry/utils/profiling/flamegraph/useFlamegraphPreferences';\nimport {useFlamegraphProfiles} from 'sentry/utils/profiling/flamegraph/useFlamegraphProfiles';\nimport {useFlamegraphTheme} from 'sentry/utils/profiling/flamegraph/useFlamegraphTheme';\nimport {FlamegraphCanvas} from 'sentry/utils/profiling/flamegraphCanvas';\nimport {FlamegraphFrame} from 'sentry/utils/profiling/flamegraphFrame';\nimport {FlamegraphView} from 'sentry/utils/profiling/flamegraphView';\nimport {\n  computeConfigViewWithStategy,\n  formatColorForFrame,\n  Rect,\n  watchForResize,\n} from 'sentry/utils/profiling/gl/utils';\nimport {ProfileGroup} from 'sentry/utils/profiling/profile/importProfile';\nimport {Profile} from 'sentry/utils/profiling/profile/profile';\nimport {FlamegraphRenderer} from 'sentry/utils/profiling/renderers/flamegraphRenderer';\nimport {useDevicePixelRatio} from 'sentry/utils/useDevicePixelRatio';\nimport {useMemoWithPrevious} from 'sentry/utils/useMemoWithPrevious';\n\nimport {FlamegraphWarnings} from './FlamegraphWarnings';\nimport {ProfilingFlamechartLayout} from './profilingFlamechartLayout';\n\nfunction getTransactionConfigSpace(profiles: Profile[]): Rect {\n  const startedAt = Math.min(...profiles.map(p => p.startedAt));\n  const endedAt = Math.max(...profiles.map(p => p.endedAt));\n  return new Rect(startedAt, 0, endedAt - startedAt, 0);\n}\n\nconst noopFormatDuration = () => '';\ninterface FlamegraphProps {\n  onImport: ProfileDragDropImportProps['onImport'];\n  profiles: ProfileGroup;\n}\n\nfunction Flamegraph(props: FlamegraphProps): ReactElement {\n  const [canvasBounds, setCanvasBounds] = useState<Rect>(Rect.Empty());\n  const devicePixelRatio = useDevicePixelRatio();\n\n  const flamegraphTheme = useFlamegraphTheme();\n  const [{sorting, view, xAxis}, dispatch] = useFlamegraphPreferences();\n  const [{threadId, selectedRoot}, dispatchThreadId] = useFlamegraphProfiles();\n\n  const [flamegraphCanvasRef, setFlamegraphCanvasRef] =\n    useState<HTMLCanvasElement | null>(null);\n  const [flamegraphOverlayCanvasRef, setFlamegraphOverlayCanvasRef] =\n    useState<HTMLCanvasElement | null>(null);\n\n  const [flamegraphMiniMapCanvasRef, setFlamegraphMiniMapCanvasRef] =\n    useState<HTMLCanvasElement | null>(null);\n  const [flamegraphMiniMapOverlayCanvasRef, setFlamegraphMiniMapOverlayCanvasRef] =\n    useState<HTMLCanvasElement | null>(null);\n\n  const canvasPoolManager = useMemo(() => new CanvasPoolManager(), []);\n  const scheduler = useMemo(() => new CanvasScheduler(), []);\n\n  const flamegraph = useMemo(() => {\n    if (typeof threadId !== 'number') {\n      return FlamegraphModel.Empty();\n    }\n\n    // This could happen if threadId was initialized from query string, but for some\n    // reason the profile was removed from the list of profiles.\n    const profile = props.profiles.profiles.find(p => p.threadId === threadId);\n    if (!profile) {\n      return FlamegraphModel.Empty();\n    }\n\n    return new FlamegraphModel(profile, threadId, {\n      inverted: view === 'bottom up',\n      leftHeavy: sorting === 'left heavy',\n      configSpace:\n        xAxis === 'transaction'\n          ? getTransactionConfigSpace(props.profiles.profiles)\n          : undefined,\n    });\n  }, [props.profiles, sorting, threadId, view, xAxis]);\n\n  const flamegraphCanvas = useMemo(() => {\n    if (!flamegraphCanvasRef) {\n      return null;\n    }\n    return new FlamegraphCanvas(\n      flamegraphCanvasRef,\n      vec2.fromValues(0, flamegraphTheme.SIZES.TIMELINE_HEIGHT * devicePixelRatio)\n    );\n  }, [devicePixelRatio, flamegraphCanvasRef, flamegraphTheme]);\n\n  const flamegraphMiniMapCanvas = useMemo(() => {\n    if (!flamegraphMiniMapCanvasRef) {\n      return null;\n    }\n    return new FlamegraphCanvas(flamegraphMiniMapCanvasRef, vec2.fromValues(0, 0));\n  }, [flamegraphMiniMapCanvasRef]);\n\n  const flamegraphView = useMemoWithPrevious<FlamegraphView | null>(\n    previousView => {\n      if (!flamegraphCanvas) {\n        return null;\n      }\n\n      const newView = new FlamegraphView({\n        canvas: flamegraphCanvas,\n        flamegraph,\n        theme: flamegraphTheme,\n      });\n\n      // if the profile or the config space of the flamegraph has changed, we do not\n      // want to persist the config view. This is to avoid a case where the new config space\n      // is larger than the previous one, meaning the new view could now be zoomed in even\n      // though the user did not fire any zoom events.\n      if (\n        previousView?.flamegraph.profile === newView.flamegraph.profile &&\n        previousView.configSpace.equals(newView.configSpace)\n      ) {\n        // if we're still looking at the same profile but only a preference other than\n        // left heavy has changed, we do want to persist the config view\n        if (previousView.flamegraph.leftHeavy === newView.flamegraph.leftHeavy) {\n          newView.setConfigView(\n            previousView.configView.withHeight(newView.configView.height)\n          );\n        }\n      }\n\n      return newView;\n    },\n    [flamegraph, flamegraphCanvas, flamegraphTheme]\n  );\n\n  useEffect(() => {\n    if (!flamegraphCanvas || !flamegraphView) {\n      return undefined;\n    }\n\n    const onConfigViewChange = (rect: Rect) => {\n      flamegraphView.setConfigView(rect);\n      canvasPoolManager.draw();\n    };\n\n    const onTransformConfigView = (mat: mat3) => {\n      flamegraphView.transformConfigView(mat);\n      canvasPoolManager.draw();\n    };\n\n    const onResetZoom = () => {\n      flamegraphView.resetConfigView(flamegraphCanvas);\n      canvasPoolManager.draw();\n    };\n\n    const onZoomIntoFrame = (frame: FlamegraphFrame, strategy: 'min' | 'exact') => {\n      const newConfigView = computeConfigViewWithStategy(\n        strategy,\n        flamegraphView.configView,\n        new Rect(frame.start, frame.depth, frame.end - frame.start, 1)\n      );\n\n      flamegraphView.setConfigView(newConfigView);\n      canvasPoolManager.draw();\n    };\n\n    scheduler.on('set config view', onConfigViewChange);\n    scheduler.on('transform config view', onTransformConfigView);\n    scheduler.on('reset zoom', onResetZoom);\n    scheduler.on('zoom at frame', onZoomIntoFrame);\n\n    return () => {\n      scheduler.off('set config view', onConfigViewChange);\n      scheduler.off('transform config view', onTransformConfigView);\n      scheduler.off('reset zoom', onResetZoom);\n      scheduler.off('zoom at frame', onZoomIntoFrame);\n    };\n  }, [canvasPoolManager, flamegraphCanvas, flamegraphView, scheduler]);\n\n  useEffect(() => {\n    canvasPoolManager.registerScheduler(scheduler);\n    return () => canvasPoolManager.unregisterScheduler(scheduler);\n  }, [canvasPoolManager, scheduler]);\n\n  useLayoutEffect(() => {\n    if (\n      !flamegraphView ||\n      !flamegraphCanvas ||\n      !flamegraphMiniMapCanvas ||\n      !flamegraphCanvasRef ||\n      !flamegraphOverlayCanvasRef ||\n      !flamegraphMiniMapCanvasRef ||\n      !flamegraphMiniMapOverlayCanvasRef\n    ) {\n      return undefined;\n    }\n\n    const flamegraphObserver = watchForResize(\n      [flamegraphCanvasRef, flamegraphOverlayCanvasRef],\n      () => {\n        const bounds = flamegraphCanvasRef.getBoundingClientRect();\n        setCanvasBounds(new Rect(bounds.x, bounds.y, bounds.width, bounds.height));\n\n        flamegraphCanvas.initPhysicalSpace();\n        flamegraphView.resizeConfigSpace(flamegraphCanvas);\n\n        canvasPoolManager.drawSync();\n      }\n    );\n\n    const flamegraphMiniMapObserver = watchForResize(\n      [flamegraphMiniMapCanvasRef, flamegraphMiniMapOverlayCanvasRef],\n      () => {\n        flamegraphMiniMapCanvas.initPhysicalSpace();\n\n        canvasPoolManager.drawSync();\n      }\n    );\n\n    return () => {\n      flamegraphObserver.disconnect();\n      flamegraphMiniMapObserver.disconnect();\n    };\n  }, [\n    canvasPoolManager,\n    flamegraphCanvas,\n    flamegraphCanvasRef,\n    flamegraphMiniMapCanvas,\n    flamegraphMiniMapCanvasRef,\n    flamegraphMiniMapOverlayCanvasRef,\n    flamegraphOverlayCanvasRef,\n    flamegraphView,\n  ]);\n\n  const flamegraphRenderer = useMemo(() => {\n    if (!flamegraphCanvasRef) {\n      return null;\n    }\n\n    return new FlamegraphRenderer(flamegraphCanvasRef, flamegraph, flamegraphTheme, {\n      draw_border: true,\n    });\n  }, [flamegraph, flamegraphCanvasRef, flamegraphTheme]);\n\n  const getFrameColor = useCallback(\n    (frame: FlamegraphFrame) => {\n      if (!flamegraphRenderer) {\n        return '';\n      }\n      return formatColorForFrame(frame, flamegraphRenderer);\n    },\n    [flamegraphRenderer]\n  );\n\n  // referenceNode is passed down to the frameStack and is used to determine\n  // the weights of each frame. In other words, in case there is no user selected root, then all\n  // of the frame weights and timing are relative to the entire profile. If there is a user selected\n  // root however, all weights are relative to that sub tree.\n  const referenceNode = useMemo(\n    () => (selectedRoot ? selectedRoot : flamegraph.root),\n    [selectedRoot, flamegraph.root]\n  );\n\n  // In case a user selected root is present, we will display that root + it's entire sub tree.\n  // If no root is selected, we will display the entire sub tree down from the root. We start at\n  // root.children because flamegraph.root is a virtual node that we do not want to show in the table.\n  const rootNodes = useMemo(() => {\n    return selectedRoot ? [selectedRoot] : flamegraph.root.children;\n  }, [selectedRoot, flamegraph.root]);\n\n  return (\n    <Fragment>\n      <FlamegraphToolbar>\n        <ThreadMenuSelector\n          profileGroup={props.profiles}\n          threadId={threadId}\n          onThreadIdChange={newThreadId =>\n            dispatchThreadId({type: 'set thread id', payload: newThreadId})\n          }\n        />\n        <FlamegraphViewSelectMenu\n          view={view}\n          sorting={sorting}\n          onSortingChange={s => {\n            dispatch({type: 'set sorting', payload: s});\n          }}\n          onViewChange={v => {\n            dispatch({type: 'set view', payload: v});\n          }}\n        />\n        <FlamegraphSearch\n          flamegraphs={[flamegraph]}\n          canvasPoolManager={canvasPoolManager}\n        />\n        <FlamegraphOptionsMenu canvasPoolManager={canvasPoolManager} />\n      </FlamegraphToolbar>\n\n      <ProfilingFlamechartLayout\n        minimap={\n          <FlamegraphZoomViewMinimap\n            canvasPoolManager={canvasPoolManager}\n            flamegraph={flamegraph}\n            flamegraphMiniMapCanvas={flamegraphMiniMapCanvas}\n            flamegraphMiniMapCanvasRef={flamegraphMiniMapCanvasRef}\n            flamegraphMiniMapOverlayCanvasRef={flamegraphMiniMapOverlayCanvasRef}\n            flamegraphMiniMapView={flamegraphView}\n            setFlamegraphMiniMapCanvasRef={setFlamegraphMiniMapCanvasRef}\n            setFlamegraphMiniMapOverlayCanvasRef={setFlamegraphMiniMapOverlayCanvasRef}\n          />\n        }\n        flamechart={\n          <ProfileDragDropImport onImport={props.onImport}>\n            <FlamegraphWarnings flamegraph={flamegraph} />\n            <FlamegraphZoomView\n              flamegraphRenderer={flamegraphRenderer}\n              canvasBounds={canvasBounds}\n              canvasPoolManager={canvasPoolManager}\n              flamegraph={flamegraph}\n              flamegraphCanvas={flamegraphCanvas}\n              flamegraphCanvasRef={flamegraphCanvasRef}\n              flamegraphOverlayCanvasRef={flamegraphOverlayCanvasRef}\n              flamegraphView={flamegraphView}\n              setFlamegraphCanvasRef={setFlamegraphCanvasRef}\n              setFlamegraphOverlayCanvasRef={setFlamegraphOverlayCanvasRef}\n            />\n          </ProfileDragDropImport>\n        }\n        frameStack={\n          <FrameStack\n            referenceNode={referenceNode}\n            rootNodes={rootNodes}\n            getFrameColor={getFrameColor}\n            formatDuration={flamegraph ? flamegraph.formatter : noopFormatDuration}\n            canvasPoolManager={canvasPoolManager}\n          />\n        }\n      />\n    </Fragment>\n  );\n}\n\nexport {Flamegraph};\n","import {Fragment} from 'react';\n\nimport {t} from 'sentry/locale';\nimport {\n  FlamegraphAxisOptions,\n  FlamegraphColorCodings,\n  FlamegraphSorting,\n  FlamegraphViewOptions,\n} from 'sentry/utils/profiling/flamegraph/flamegraphStateProvider/flamegraphPreferences';\nimport {useFlamegraphPreferences} from 'sentry/utils/profiling/flamegraph/useFlamegraphPreferences';\nimport {useContextMenu} from 'sentry/utils/profiling/hooks/useContextMenu';\n\nimport {\n  ProfilingContextMenu,\n  ProfilingContextMenuGroup,\n  ProfilingContextMenuHeading,\n  ProfilingContextMenuItemCheckbox,\n  ProfilingContextMenuLayer,\n} from './ProfilingContextMenu/profilingContextMenu';\n\nconst FLAMEGRAPH_COLOR_CODINGS: FlamegraphColorCodings = [\n  'by symbol name',\n  'by system / application',\n  'by library',\n  'by recursion',\n  'by frequency',\n];\nconst FLAMEGRAPH_VIEW_OPTIONS: FlamegraphViewOptions = ['top down', 'bottom up'];\nconst FLAMEGRAPH_SORTING_OPTIONS: FlamegraphSorting = ['left heavy', 'call order'];\nconst FLAMEGRAPH_AXIS_OPTIONS: FlamegraphAxisOptions = ['standalone', 'transaction'];\n\ninterface FlameGraphOptionsContextMenuProps {\n  contextMenu: ReturnType<typeof useContextMenu>;\n}\n\nexport function FlamegraphOptionsContextMenu(props: FlameGraphOptionsContextMenuProps) {\n  const [preferences, dispatch] = useFlamegraphPreferences();\n\n  return props.contextMenu.open ? (\n    <Fragment>\n      <ProfilingContextMenuLayer onClick={() => props.contextMenu.setOpen(false)} />\n      <ProfilingContextMenu\n        {...props.contextMenu.getMenuProps()}\n        style={{\n          position: 'absolute',\n          left: props.contextMenu.position?.left ?? -9999,\n          top: props.contextMenu.position?.top ?? -9999,\n          maxHeight: props.contextMenu.containerCoordinates?.height ?? 'auto',\n        }}\n      >\n        <ProfilingContextMenuGroup>\n          <ProfilingContextMenuHeading>{t('Color Coding')}</ProfilingContextMenuHeading>\n          {FLAMEGRAPH_COLOR_CODINGS.map((coding, idx) => (\n            <ProfilingContextMenuItemCheckbox\n              key={idx}\n              {...props.contextMenu.getMenuItemProps()}\n              onClick={() => dispatch({type: 'set color coding', payload: coding})}\n              checked={preferences.colorCoding === coding}\n            >\n              {coding}\n            </ProfilingContextMenuItemCheckbox>\n          ))}\n        </ProfilingContextMenuGroup>\n        <ProfilingContextMenuGroup>\n          <ProfilingContextMenuHeading>{t('View')}</ProfilingContextMenuHeading>\n          {FLAMEGRAPH_VIEW_OPTIONS.map((view, idx) => (\n            <ProfilingContextMenuItemCheckbox\n              key={idx}\n              {...props.contextMenu.getMenuItemProps()}\n              onClick={() => dispatch({type: 'set view', payload: view})}\n              checked={preferences.view === view}\n            >\n              {view}\n            </ProfilingContextMenuItemCheckbox>\n          ))}\n        </ProfilingContextMenuGroup>\n        <ProfilingContextMenuGroup>\n          <ProfilingContextMenuHeading>{t('Sorting')}</ProfilingContextMenuHeading>\n          {FLAMEGRAPH_SORTING_OPTIONS.map((sorting, idx) => (\n            <ProfilingContextMenuItemCheckbox\n              key={idx}\n              {...props.contextMenu.getMenuItemProps()}\n              onClick={() => dispatch({type: 'set sorting', payload: sorting})}\n              checked={preferences.sorting === sorting}\n            >\n              {sorting}\n            </ProfilingContextMenuItemCheckbox>\n          ))}\n        </ProfilingContextMenuGroup>\n        <ProfilingContextMenuGroup>\n          <ProfilingContextMenuHeading>{t('X Axis')}</ProfilingContextMenuHeading>\n          {FLAMEGRAPH_AXIS_OPTIONS.map((axis, idx) => (\n            <ProfilingContextMenuItemCheckbox\n              key={idx}\n              {...props.contextMenu.getMenuItemProps()}\n              onClick={() => dispatch({type: 'set xAxis', payload: axis})}\n              checked={preferences.xAxis === axis}\n            >\n              {axis}\n            </ProfilingContextMenuItemCheckbox>\n          ))}\n        </ProfilingContextMenuGroup>\n      </ProfilingContextMenu>\n    </Fragment>\n  ) : null;\n}\n","import {Fragment, useMemo} from 'react';\n\nimport Button from 'sentry/components/button';\nimport CompositeSelect from 'sentry/components/forms/compositeSelect';\nimport {IconSliders} from 'sentry/icons';\nimport {t} from 'sentry/locale';\nimport {CanvasPoolManager} from 'sentry/utils/profiling/canvasScheduler';\nimport {FlamegraphPreferences} from 'sentry/utils/profiling/flamegraph/flamegraphStateProvider/flamegraphPreferences';\nimport {useFlamegraphPreferences} from 'sentry/utils/profiling/flamegraph/useFlamegraphPreferences';\n\ninterface FlamegraphOptionsMenuProps {\n  canvasPoolManager: CanvasPoolManager;\n}\n\nfunction FlamegraphOptionsMenu({\n  canvasPoolManager,\n}: FlamegraphOptionsMenuProps): React.ReactElement {\n  const [{colorCoding, xAxis}, dispatch] = useFlamegraphPreferences();\n\n  const options = useMemo(() => {\n    return [\n      {\n        label: t('X Axis'),\n        value: 'x axis',\n        defaultValue: xAxis,\n        options: Object.entries(X_AXIS).map(([value, label]) => ({\n          label,\n          value,\n        })),\n        onChange: value =>\n          dispatch({\n            type: 'set xAxis',\n            payload: value,\n          }),\n      },\n      {\n        label: t('Color Coding'),\n        value: 'by symbol name',\n        defaultValue: colorCoding,\n        options: Object.entries(COLOR_CODINGS).map(([value, label]) => ({\n          label,\n          value,\n        })),\n        onChange: value =>\n          dispatch({\n            type: 'set color coding',\n            payload: value,\n          }),\n      },\n    ];\n    // If we add color and xAxis it updates the memo and the component is re-rendered (losing hovered state)\n    // Not ideal, but since we are only passing default value I guess we can live with it\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [dispatch]);\n\n  return (\n    <Fragment>\n      <Button size=\"xs\" onClick={() => canvasPoolManager.dispatch('reset zoom', [])}>\n        {t('Reset Zoom')}\n      </Button>\n      <CompositeSelect\n        triggerLabel={t('Options')}\n        triggerProps={{\n          icon: <IconSliders size=\"xs\" />,\n          size: 'xs',\n        }}\n        placement=\"bottom right\"\n        sections={options}\n      />\n    </Fragment>\n  );\n}\n\nconst X_AXIS: Record<FlamegraphPreferences['xAxis'], string> = {\n  standalone: t('Standalone'),\n  transaction: t('Transaction'),\n};\n\nconst COLOR_CODINGS: Record<FlamegraphPreferences['colorCoding'], string> = {\n  'by symbol name': t('By Symbol Name'),\n  'by library': t('By Library'),\n  'by system / application': t('By System / Application'),\n  'by recursion': t('By Recursion'),\n  'by frequency': t('By Frequency'),\n};\n\nexport {FlamegraphOptionsMenu};\n","import {useCallback, useEffect, useMemo, useState} from 'react';\nimport styled from '@emotion/styled';\nimport * as Sentry from '@sentry/react';\nimport Fuse from 'fuse.js';\n\nimport SearchBar from 'sentry/components/searchBar';\nimport {t} from 'sentry/locale';\nimport {CanvasPoolManager} from 'sentry/utils/profiling/canvasScheduler';\nimport {Flamegraph} from 'sentry/utils/profiling/flamegraph';\nimport type {FlamegraphSearch as FlamegraphSearchResults} from 'sentry/utils/profiling/flamegraph/flamegraphStateProvider/flamegraphSearch';\nimport {useFlamegraphSearch} from 'sentry/utils/profiling/flamegraph/useFlamegraphSearch';\nimport {\n  FlamegraphFrame,\n  getFlamegraphFrameSearchId,\n} from 'sentry/utils/profiling/flamegraphFrame';\nimport {memoizeByReference} from 'sentry/utils/profiling/profile/utils';\nimport {isRegExpString, parseRegExp} from 'sentry/utils/profiling/validators/regExp';\n\nfunction sortFrameResults(\n  frames: FlamegraphSearchResults['results']\n): Array<FlamegraphFrame> {\n  // If frames have the same start times, move frames with lower stack depth first.\n  // This results in top down and left to right iteration\n  return [...frames.values()]\n    .map(f => f.frame)\n    .sort((a, b) =>\n      a.start === b.start\n        ? numericSort(a.depth, b.depth, 'asc')\n        : numericSort(a.start, b.start, 'asc')\n    );\n}\n\nfunction findBestMatchFromFuseMatches(\n  matches: ReadonlyArray<Fuse.FuseResultMatch>\n): Fuse.RangeTuple | null {\n  let bestMatch: Fuse.RangeTuple | null = null;\n  let bestMatchLength = 0;\n  let bestMatchStart = -1;\n\n  for (let i = 0; i < matches.length; i++) {\n    const match = matches[i];\n\n    for (let j = 0; j < match.indices.length; j++) {\n      const index = match.indices[j];\n      const matchLength = index[1] - index[0];\n\n      if (matchLength < 0) {\n        // Fuse sometimes returns negative indices - we will just skip them for now.\n        continue;\n      }\n\n      // We only override the match if the match is longer than the current best match\n      // or if the matches are the same length, but the start is earlier in the string\n      if (\n        matchLength > bestMatchLength ||\n        (matchLength === bestMatchLength && index[0] > bestMatchStart)\n      ) {\n        // Offset end by 1 else we are always trailing by 1 character.\n        bestMatch = [index[0], index[1] + 1];\n        bestMatchLength = matchLength;\n        bestMatchStart = index[0];\n      }\n    }\n  }\n\n  return bestMatch;\n}\n\nfunction findBestMatchFromRegexpMatchArray(\n  matches: RegExpMatchArray[]\n): Fuse.RangeTuple | null {\n  let bestMatch: Fuse.RangeTuple | null = null;\n  let bestMatchLength = 0;\n  let bestMatchStart = -1;\n\n  for (let i = 0; i < matches.length; i++) {\n    const index = matches[i].index;\n    if (index === undefined) {\n      continue;\n    }\n\n    // We only override the match if the match is longer than the current best match\n    // or if the matches are the same length, but the start is earlier in the string\n    if (\n      matches[i].length > bestMatchLength ||\n      (matches[i].length === bestMatchLength && index[0] > bestMatchStart)\n    ) {\n      bestMatch = [index, index + matches[i].length];\n      bestMatchLength = matches[i].length;\n      bestMatchStart = index;\n    }\n  }\n\n  return bestMatch;\n}\n\nconst memoizedSortFrameResults = memoizeByReference(sortFrameResults);\n\nfunction frameSearch(\n  query: string,\n  frames: ReadonlyArray<FlamegraphFrame>,\n  index: Fuse<FlamegraphFrame>\n): FlamegraphSearchResults['results'] {\n  const results: FlamegraphSearchResults['results'] = new Map();\n\n  if (isRegExpString(query)) {\n    const [_, lookup, flags] = parseRegExp(query) ?? [];\n\n    let matches = 0;\n\n    try {\n      if (!lookup) {\n        throw new Error('Invalid RegExp');\n      }\n\n      for (let i = 0; i < frames.length; i++) {\n        const frame = frames[i];\n\n        const re = new RegExp(lookup, flags ?? 'g');\n        const reMatches = Array.from(frame.frame.name.trim().matchAll(re));\n\n        const match = findBestMatchFromRegexpMatchArray(reMatches);\n\n        if (match) {\n          const frameId = getFlamegraphFrameSearchId(frame);\n          results.set(frameId, {\n            frame,\n            match,\n          });\n          matches += 1;\n        }\n      }\n    } catch (e) {\n      Sentry.captureMessage(e.message);\n    }\n\n    if (matches <= 0) {\n      return results;\n    }\n\n    return results;\n  }\n\n  const fuseResults = index.search(query);\n\n  if (fuseResults.length <= 0) {\n    return results;\n  }\n\n  for (let i = 0; i < fuseResults.length; i++) {\n    const fuseFrameResult = fuseResults[i];\n    const frame = fuseFrameResult.item;\n    const frameId = getFlamegraphFrameSearchId(frame);\n    const match = findBestMatchFromFuseMatches(fuseFrameResult.matches ?? []);\n\n    if (match) {\n      results.set(frameId, {\n        frame,\n        match,\n      });\n    }\n  }\n\n  return results;\n}\n\nconst numericSort = (\n  a: null | undefined | number,\n  b: null | undefined | number,\n  direction: 'asc' | 'desc'\n): number => {\n  if (a === b) {\n    return 0;\n  }\n  if (a === null || a === undefined) {\n    return 1;\n  }\n  if (b === null || b === undefined) {\n    return -1;\n  }\n\n  return direction === 'asc' ? a - b : b - a;\n};\n\ninterface FlamegraphSearchProps {\n  canvasPoolManager: CanvasPoolManager;\n  flamegraphs: Flamegraph | Flamegraph[];\n}\n\nfunction FlamegraphSearch({\n  flamegraphs,\n  canvasPoolManager,\n}: FlamegraphSearchProps): React.ReactElement | null {\n  const [search, dispatchSearch] = useFlamegraphSearch();\n  const [didInitialSearch, setDidInitialSearch] = useState(!search.query);\n\n  const allFrames = useMemo(() => {\n    if (Array.isArray(flamegraphs)) {\n      return flamegraphs.reduce(\n        (acc: FlamegraphFrame[], graph) => acc.concat(graph.frames),\n        []\n      );\n    }\n\n    return flamegraphs.frames;\n  }, [flamegraphs]);\n\n  const searchIndex = useMemo(() => {\n    return new Fuse(allFrames, {\n      keys: ['frame.name'],\n      threshold: 0.3,\n      includeMatches: true,\n      findAllMatches: true,\n      ignoreLocation: true,\n    });\n  }, [allFrames]);\n\n  const onZoomIntoFrame = useCallback(\n    (frame: FlamegraphFrame) => {\n      canvasPoolManager.dispatch('zoom at frame', [frame, 'min']);\n      canvasPoolManager.dispatch('highlight frame', [frame, 'selected']);\n    },\n    [canvasPoolManager]\n  );\n\n  useEffect(() => {\n    if (typeof search.index !== 'number') {\n      return;\n    }\n\n    const frames = memoizedSortFrameResults(search.results);\n    if (frames[search.index]) {\n      onZoomIntoFrame(frames[search.index]);\n    }\n  }, [search.results, search.index, onZoomIntoFrame]);\n\n  const handleChange: (value: string) => void = useCallback(\n    value => {\n      if (!value) {\n        dispatchSearch({type: 'clear search'});\n        return;\n      }\n\n      dispatchSearch({\n        type: 'set results',\n        payload: {\n          results: frameSearch(value, allFrames, searchIndex),\n          query: value,\n        },\n      });\n    },\n    [dispatchSearch, allFrames, searchIndex]\n  );\n\n  useEffect(() => {\n    if (didInitialSearch || allFrames.length === 0) {\n      return;\n    }\n    handleChange(search.query);\n    setDidInitialSearch(true);\n  }, [didInitialSearch, handleChange, allFrames, search.query]);\n\n  const onNextSearchClick = useCallback(() => {\n    const frames = memoizedSortFrameResults(search.results);\n    if (!frames.length) {\n      return;\n    }\n\n    if (search.index === null || search.index === frames.length - 1) {\n      dispatchSearch({type: 'set search index position', payload: 0});\n      return;\n    }\n\n    dispatchSearch({\n      type: 'set search index position',\n      payload: search.index + 1,\n    });\n  }, [search.results, search.index, dispatchSearch]);\n\n  const onPreviousSearchClick = useCallback(() => {\n    const frames = memoizedSortFrameResults(search.results);\n    if (!frames.length) {\n      return;\n    }\n\n    if (search.index === null || search.index === 0) {\n      dispatchSearch({\n        type: 'set search index position',\n        payload: frames.length - 1,\n      });\n      return;\n    }\n\n    dispatchSearch({\n      type: 'set search index position',\n      payload: search.index - 1,\n    });\n  }, [search.results, search.index, dispatchSearch]);\n\n  const handleKeyDown = useCallback(\n    (evt: React.KeyboardEvent<HTMLInputElement>) => {\n      if (evt.key === 'ArrowDown') {\n        evt.preventDefault();\n        onNextSearchClick();\n      } else if (evt.key === 'ArrowUp') {\n        evt.preventDefault();\n        onPreviousSearchClick();\n      }\n    },\n    [onNextSearchClick, onPreviousSearchClick]\n  );\n\n  return (\n    <StyledSearchBar\n      size=\"xs\"\n      placeholder={t('Find Frames')}\n      query={search.query}\n      onChange={handleChange}\n      onKeyDown={handleKeyDown}\n    />\n  );\n}\n\nconst StyledSearchBar = styled(SearchBar)`\n  flex: 1 1 100%;\n`;\n\nexport {FlamegraphSearch};\n","import styled from '@emotion/styled';\n\nimport space from 'sentry/styles/space';\n\ninterface FlamegraphToolbarProps {\n  children: React.ReactNode;\n}\n\nexport const FlamegraphToolbar = styled('div')<FlamegraphToolbarProps>`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin: ${space(1)};\n  gap: ${space(1)};\n`;\n","import {Fragment} from 'react';\n\nimport Button from 'sentry/components/button';\nimport ButtonBar from 'sentry/components/buttonBar';\nimport {t} from 'sentry/locale';\nimport {FlamegraphPreferences} from 'sentry/utils/profiling/flamegraph/flamegraphStateProvider/flamegraphPreferences';\n\ninterface FlamegraphViewSelectMenuProps {\n  onSortingChange: (sorting: FlamegraphViewSelectMenuProps['sorting']) => void;\n  onViewChange: (view: FlamegraphViewSelectMenuProps['view']) => void;\n  sorting: FlamegraphPreferences['sorting'];\n  view: FlamegraphPreferences['view'];\n}\n\nfunction FlamegraphViewSelectMenu({\n  view,\n  onViewChange,\n  sorting,\n  onSortingChange,\n}: FlamegraphViewSelectMenuProps): React.ReactElement {\n  return (\n    <Fragment>\n      <ButtonBar merged active={sorting}>\n        <Button\n          barId=\"call order\"\n          size=\"xs\"\n          onClick={() => onSortingChange('call order')}\n        >\n          {t('Call Order')}\n        </Button>\n        <Button\n          barId=\"left heavy\"\n          size=\"xs\"\n          onClick={() => onSortingChange('left heavy')}\n        >\n          {t('Left Heavy')}\n        </Button>\n      </ButtonBar>\n      <ButtonBar merged active={view}>\n        <Button barId=\"bottom up\" size=\"xs\" onClick={() => onViewChange('bottom up')}>\n          {t('Bottom Up')}\n        </Button>\n        <Button barId=\"top down\" size=\"xs\" onClick={() => onViewChange('top down')}>\n          {t('Top Down')}\n        </Button>\n      </ButtonBar>\n    </Fragment>\n  );\n}\n\nexport {FlamegraphViewSelectMenu};\n","import {useCallback, useEffect, useMemo, useRef, useState} from 'react';\nimport styled from '@emotion/styled';\nimport {mat3, vec2} from 'gl-matrix';\n\nimport space from 'sentry/styles/space';\nimport {CallTreeNode} from 'sentry/utils/profiling/callTreeNode';\nimport {CanvasPoolManager, CanvasScheduler} from 'sentry/utils/profiling/canvasScheduler';\nimport {DifferentialFlamegraph} from 'sentry/utils/profiling/differentialFlamegraph';\nimport {Flamegraph} from 'sentry/utils/profiling/flamegraph';\nimport {useFlamegraphProfiles} from 'sentry/utils/profiling/flamegraph/useFlamegraphProfiles';\nimport {useFlamegraphSearch} from 'sentry/utils/profiling/flamegraph/useFlamegraphSearch';\nimport {\n  useDispatchFlamegraphState,\n  useFlamegraphState,\n} from 'sentry/utils/profiling/flamegraph/useFlamegraphState';\nimport {useFlamegraphTheme} from 'sentry/utils/profiling/flamegraph/useFlamegraphTheme';\nimport {FlamegraphCanvas} from 'sentry/utils/profiling/flamegraphCanvas';\nimport {FlamegraphView} from 'sentry/utils/profiling/flamegraphView';\nimport {formatColorForFrame, Rect} from 'sentry/utils/profiling/gl/utils';\nimport {useContextMenu} from 'sentry/utils/profiling/hooks/useContextMenu';\nimport {useInternalFlamegraphDebugMode} from 'sentry/utils/profiling/hooks/useInternalFlamegraphDebugMode';\nimport {FlamegraphRenderer} from 'sentry/utils/profiling/renderers/flamegraphRenderer';\nimport {GridRenderer} from 'sentry/utils/profiling/renderers/gridRenderer';\nimport {SampleTickRenderer} from 'sentry/utils/profiling/renderers/sampleTickRenderer';\nimport {SelectedFrameRenderer} from 'sentry/utils/profiling/renderers/selectedFrameRenderer';\nimport {TextRenderer} from 'sentry/utils/profiling/renderers/textRenderer';\nimport usePrevious from 'sentry/utils/usePrevious';\n\nimport {FlamegraphFrame} from '../../utils/profiling/flamegraphFrame';\n\nimport {BoundTooltip} from './boundTooltip';\nimport {FlamegraphOptionsContextMenu} from './flamegraphOptionsContextMenu';\n\nfunction formatWeightToProfileDuration(frame: CallTreeNode, flamegraph: Flamegraph) {\n  return `(${Math.round((frame.totalWeight / flamegraph.profile.duration) * 100)}%)`;\n}\n\ninterface FlamegraphZoomViewProps {\n  canvasBounds: Rect;\n  canvasPoolManager: CanvasPoolManager;\n  flamegraph: Flamegraph | DifferentialFlamegraph;\n  flamegraphCanvas: FlamegraphCanvas | null;\n  flamegraphCanvasRef: HTMLCanvasElement | null;\n  flamegraphOverlayCanvasRef: HTMLCanvasElement | null;\n  flamegraphRenderer: FlamegraphRenderer | null;\n  flamegraphView: FlamegraphView | null;\n  setFlamegraphCanvasRef: React.Dispatch<React.SetStateAction<HTMLCanvasElement | null>>;\n  setFlamegraphOverlayCanvasRef: React.Dispatch<\n    React.SetStateAction<HTMLCanvasElement | null>\n  >;\n}\n\nfunction FlamegraphZoomView({\n  canvasPoolManager,\n  canvasBounds,\n  flamegraphRenderer,\n  flamegraph,\n  flamegraphCanvas,\n  flamegraphCanvasRef,\n  flamegraphOverlayCanvasRef,\n  flamegraphView,\n  setFlamegraphCanvasRef,\n  setFlamegraphOverlayCanvasRef,\n}: FlamegraphZoomViewProps): React.ReactElement {\n  const flamegraphTheme = useFlamegraphTheme();\n  const [flamegraphProfile] = useFlamegraphProfiles();\n  const [flamegraphSearch] = useFlamegraphSearch();\n  const isInternalFlamegraphDebugModeEnabled = useInternalFlamegraphDebugMode();\n\n  const [lastInteraction, setLastInteraction] = useState<\n    'pan' | 'click' | 'zoom' | 'scroll' | null\n  >(null);\n\n  const [dispatch, {previousState, nextState}] = useDispatchFlamegraphState();\n\n  const scheduler = useMemo(() => new CanvasScheduler(), []);\n\n  const [flamegraphState, dispatchFlamegraphState] = useFlamegraphState();\n  const [startPanVector, setStartPanVector] = useState<vec2 | null>(null);\n  const [configSpaceCursor, setConfigSpaceCursor] = useState<vec2 | null>(null);\n\n  const textRenderer: TextRenderer | null = useMemo(() => {\n    if (!flamegraphOverlayCanvasRef) {\n      return null;\n    }\n    return new TextRenderer(flamegraphOverlayCanvasRef, flamegraph, flamegraphTheme);\n  }, [flamegraph, flamegraphOverlayCanvasRef, flamegraphTheme]);\n\n  const gridRenderer: GridRenderer | null = useMemo(() => {\n    if (!flamegraphOverlayCanvasRef) {\n      return null;\n    }\n    return new GridRenderer(\n      flamegraphOverlayCanvasRef,\n      flamegraphTheme,\n      flamegraph.formatter\n    );\n  }, [flamegraphOverlayCanvasRef, flamegraph, flamegraphTheme]);\n\n  const sampleTickRenderer: SampleTickRenderer | null = useMemo(() => {\n    if (!isInternalFlamegraphDebugModeEnabled) {\n      return null;\n    }\n\n    if (!flamegraphOverlayCanvasRef || !flamegraphView?.configSpace) {\n      return null;\n    }\n    return new SampleTickRenderer(\n      flamegraphOverlayCanvasRef,\n      flamegraph,\n      flamegraphView.configSpace,\n      flamegraphTheme\n    );\n  }, [\n    isInternalFlamegraphDebugModeEnabled,\n    flamegraphOverlayCanvasRef,\n    flamegraph,\n    flamegraphView?.configSpace,\n    flamegraphTheme,\n  ]);\n\n  const selectedFrameRenderer = useMemo(() => {\n    if (!flamegraphOverlayCanvasRef) {\n      return null;\n    }\n    return new SelectedFrameRenderer(flamegraphOverlayCanvasRef);\n  }, [flamegraphOverlayCanvasRef]);\n\n  const hoveredNode: FlamegraphFrame | null = useMemo(() => {\n    if (!configSpaceCursor || !flamegraphRenderer) {\n      return null;\n    }\n    return flamegraphRenderer.getHoveredNode(configSpaceCursor);\n  }, [configSpaceCursor, flamegraphRenderer]);\n\n  const focusedRects: Rect[] = useMemo(() => {\n    if (!flamegraphProfile.focusFrame) {\n      return [];\n    }\n\n    const rects: Rect[] = [];\n\n    const frames: FlamegraphFrame[] = [...flamegraph.root.children];\n    while (frames.length > 0) {\n      const frame = frames.pop()!;\n      if (\n        frame.frame.name === flamegraphProfile.focusFrame.name &&\n        frame.frame.image === flamegraphProfile.focusFrame.package\n      ) {\n        rects.push(new Rect(frame.start, frame.depth, frame.end - frame.start, 1));\n      }\n\n      for (let i = 0; i < frame.children.length; i++) {\n        frames.push(frame.children[i]);\n      }\n    }\n\n    return rects;\n  }, [flamegraph, flamegraphProfile.focusFrame]);\n\n  useEffect(() => {\n    const onKeyDown = (evt: KeyboardEvent) => {\n      if (!flamegraphView) {\n        return;\n      }\n\n      if (evt.key === 'z' && evt.metaKey) {\n        const action = evt.shiftKey ? 'redo' : 'undo';\n\n        if (action === 'undo') {\n          const previousPosition = previousState?.position?.view;\n\n          // If previous position is empty, reset the view to it's max\n          if (previousPosition?.isEmpty()) {\n            canvasPoolManager.dispatch('reset zoom', []);\n          } else if (\n            previousPosition &&\n            !previousPosition?.equals(flamegraphView.configView)\n          ) {\n            // We need to always dispatch with the height of the current view,\n            // because the height may have changed due to window resizing and\n            // calling it with the old height may result in the flamegraph\n            // being drawn into a very small or very large area.\n            canvasPoolManager.dispatch('set config view', [\n              previousPosition.withHeight(flamegraphView.configView.height),\n            ]);\n          }\n        }\n\n        if (action === 'redo') {\n          const nextPosition = nextState?.position?.view;\n\n          if (nextPosition && !nextPosition.equals(flamegraphView.configView)) {\n            // We need to always dispatch with the height of the current view,\n            // because the height may have changed due to window resizing and\n            // calling it with the old height may result in the flamegraph\n            // being drawn into a very small or very large area.\n            canvasPoolManager.dispatch('set config view', [\n              nextPosition.withHeight(flamegraphView.configView.height),\n            ]);\n          }\n        }\n\n        dispatchFlamegraphState({type: action});\n      }\n    };\n\n    document.addEventListener('keydown', onKeyDown);\n\n    return () => {\n      document.removeEventListener('keydown', onKeyDown);\n    };\n  }, [\n    canvasPoolManager,\n    dispatchFlamegraphState,\n    nextState,\n    previousState,\n    flamegraphView,\n  ]);\n\n  const previousInteraction = usePrevious(lastInteraction);\n  const beforeInteractionConfigView = useRef<Rect | null>(null);\n\n  useEffect(() => {\n    if (!flamegraphView) {\n      return;\n    }\n\n    // Check if we are starting a new interaction\n    if (previousInteraction === null && lastInteraction) {\n      beforeInteractionConfigView.current = flamegraphView.configView.clone();\n      return;\n    }\n\n    if (\n      beforeInteractionConfigView.current &&\n      !beforeInteractionConfigView.current.equals(flamegraphView.configView)\n    ) {\n      dispatch({type: 'checkpoint', payload: flamegraphView.configView.clone()});\n    }\n  }, [dispatch, lastInteraction, previousInteraction, flamegraphView]);\n\n  useEffect(() => {\n    if (!flamegraphCanvas || !flamegraphView || !flamegraphRenderer) {\n      return undefined;\n    }\n\n    const drawRectangles = () => {\n      flamegraphRenderer.draw(\n        flamegraphView.fromConfigView(flamegraphCanvas.physicalSpace),\n        flamegraphState.search.results\n      );\n    };\n\n    scheduler.registerBeforeFrameCallback(drawRectangles);\n    scheduler.draw();\n\n    return () => {\n      scheduler.unregisterBeforeFrameCallback(drawRectangles);\n    };\n  }, [\n    flamegraphCanvas,\n    flamegraphRenderer,\n    flamegraphState.search.results,\n    scheduler,\n    flamegraphView,\n  ]);\n\n  useEffect(() => {\n    if (!flamegraphCanvas || !flamegraphView || !textRenderer || !gridRenderer) {\n      return undefined;\n    }\n\n    const clearOverlayCanvas = () => {\n      textRenderer.context.clearRect(\n        0,\n        0,\n        textRenderer.canvas.width,\n        textRenderer.canvas.height\n      );\n    };\n\n    const drawText = () => {\n      textRenderer.draw(\n        flamegraphView.configView,\n        flamegraphView.fromConfigView(flamegraphCanvas.physicalSpace),\n        flamegraphSearch.results\n      );\n    };\n\n    const drawGrid = () => {\n      gridRenderer.draw(\n        flamegraphView.configView,\n        flamegraphCanvas.physicalSpace,\n        flamegraphView.fromConfigView(flamegraphCanvas.physicalSpace),\n        flamegraphView.toConfigView(flamegraphCanvas.logicalSpace)\n      );\n    };\n\n    const drawInternalSampleTicks = () => {\n      if (!sampleTickRenderer) {\n        return;\n      }\n      sampleTickRenderer.draw(\n        flamegraphView.fromConfigView(flamegraphCanvas.physicalSpace),\n        flamegraphView.configView\n      );\n    };\n\n    scheduler.registerBeforeFrameCallback(clearOverlayCanvas);\n    scheduler.registerAfterFrameCallback(drawText);\n    scheduler.registerAfterFrameCallback(drawGrid);\n    scheduler.registerAfterFrameCallback(drawInternalSampleTicks);\n\n    scheduler.draw();\n\n    return () => {\n      scheduler.unregisterBeforeFrameCallback(clearOverlayCanvas);\n      scheduler.unregisterAfterFrameCallback(drawText);\n      scheduler.unregisterAfterFrameCallback(drawGrid);\n      scheduler.unregisterAfterFrameCallback(drawInternalSampleTicks);\n    };\n  }, [\n    flamegraphCanvas,\n    flamegraphView,\n    scheduler,\n    flamegraph,\n    flamegraphTheme,\n    textRenderer,\n    gridRenderer,\n    sampleTickRenderer,\n    canvasPoolManager,\n    flamegraphSearch,\n  ]);\n\n  useEffect(() => {\n    if (!flamegraphCanvas || !flamegraphView || !selectedFrameRenderer) {\n      return undefined;\n    }\n\n    const drawFocusedFrameBorder = () => {\n      selectedFrameRenderer.draw(\n        focusedRects,\n        {\n          BORDER_COLOR: flamegraphTheme.COLORS.FOCUSED_FRAME_BORDER_COLOR,\n          BORDER_WIDTH: flamegraphTheme.SIZES.FOCUSED_FRAME_BORDER_WIDTH,\n        },\n        flamegraphView.fromConfigView(flamegraphCanvas.physicalSpace)\n      );\n    };\n\n    scheduler.registerAfterFrameCallback(drawFocusedFrameBorder);\n    scheduler.draw();\n\n    return () => {\n      scheduler.unregisterAfterFrameCallback(drawFocusedFrameBorder);\n    };\n  }, [\n    flamegraphCanvas,\n    flamegraphView,\n    flamegraphTheme,\n    focusedRects,\n    scheduler,\n    selectedFrameRenderer,\n  ]);\n\n  useEffect(() => {\n    if (!flamegraphCanvas || !flamegraphView || !selectedFrameRenderer) {\n      return undefined;\n    }\n\n    const state: {selectedNode: FlamegraphFrame | null} = {\n      selectedNode: null,\n    };\n\n    const onNodeHighlight = (\n      node: FlamegraphFrame | null,\n      mode: 'hover' | 'selected'\n    ) => {\n      if (mode === 'selected') {\n        state.selectedNode = node;\n      }\n      scheduler.draw();\n    };\n\n    const drawSelectedFrameBorder = () => {\n      if (state.selectedNode) {\n        selectedFrameRenderer.draw(\n          [\n            new Rect(\n              state.selectedNode.start,\n              state.selectedNode.depth,\n              state.selectedNode.end - state.selectedNode.start,\n              1\n            ),\n          ],\n          {\n            BORDER_COLOR: flamegraphTheme.COLORS.SELECTED_FRAME_BORDER_COLOR,\n            BORDER_WIDTH: flamegraphTheme.SIZES.FRAME_BORDER_WIDTH,\n          },\n          flamegraphView.fromConfigView(flamegraphCanvas.physicalSpace)\n        );\n      }\n    };\n\n    scheduler.on('highlight frame', onNodeHighlight);\n    scheduler.registerAfterFrameCallback(drawSelectedFrameBorder);\n\n    return () => {\n      scheduler.off('highlight frame', onNodeHighlight);\n      scheduler.unregisterAfterFrameCallback(drawSelectedFrameBorder);\n    };\n  }, [\n    flamegraphView,\n    flamegraphCanvas,\n    scheduler,\n    selectedFrameRenderer,\n    flamegraphTheme,\n  ]);\n\n  useEffect(() => {\n    if (!flamegraphCanvas || !flamegraphView || !selectedFrameRenderer) {\n      return undefined;\n    }\n\n    const drawHoveredFrameBorder = () => {\n      if (hoveredNode) {\n        selectedFrameRenderer.draw(\n          [\n            new Rect(\n              hoveredNode.start,\n              hoveredNode.depth,\n              hoveredNode.end - hoveredNode.start,\n              1\n            ),\n          ],\n          {\n            BORDER_COLOR: flamegraphTheme.COLORS.HOVERED_FRAME_BORDER_COLOR,\n            BORDER_WIDTH: flamegraphTheme.SIZES.HOVERED_FRAME_BORDER_WIDTH,\n          },\n          flamegraphView.fromConfigView(flamegraphCanvas.physicalSpace)\n        );\n      }\n    };\n\n    scheduler.registerAfterFrameCallback(drawHoveredFrameBorder);\n    scheduler.draw();\n\n    return () => {\n      scheduler.unregisterAfterFrameCallback(drawHoveredFrameBorder);\n    };\n  }, [\n    flamegraphView,\n    flamegraphCanvas,\n    scheduler,\n    hoveredNode,\n    selectedFrameRenderer,\n    flamegraphTheme,\n  ]);\n\n  useEffect(() => {\n    if (!flamegraphCanvas || !flamegraphView) {\n      return undefined;\n    }\n\n    const onResetZoom = () => {\n      setConfigSpaceCursor(null);\n    };\n\n    const onZoomIntoFrame = () => {\n      setConfigSpaceCursor(null);\n    };\n\n    scheduler.on('reset zoom', onResetZoom);\n    scheduler.on('zoom at frame', onZoomIntoFrame);\n\n    return () => {\n      scheduler.off('reset zoom', onResetZoom);\n      scheduler.off('zoom at frame', onZoomIntoFrame);\n    };\n  }, [\n    flamegraphCanvas,\n    canvasPoolManager,\n    dispatchFlamegraphState,\n    scheduler,\n    flamegraphView,\n  ]);\n\n  useEffect(() => {\n    canvasPoolManager.registerScheduler(scheduler);\n    return () => canvasPoolManager.unregisterScheduler(scheduler);\n  }, [canvasPoolManager, scheduler]);\n\n  const onCanvasMouseDown = useCallback((evt: React.MouseEvent<HTMLCanvasElement>) => {\n    const logicalMousePos = vec2.fromValues(\n      evt.nativeEvent.offsetX,\n      evt.nativeEvent.offsetY\n    );\n\n    const physicalMousePos = vec2.scale(\n      vec2.create(),\n      logicalMousePos,\n      window.devicePixelRatio\n    );\n\n    setLastInteraction('click');\n    setStartPanVector(physicalMousePos);\n  }, []);\n\n  const onCanvasMouseUp = useCallback(\n    (evt: React.MouseEvent<HTMLCanvasElement>) => {\n      evt.preventDefault();\n      evt.stopPropagation();\n\n      if (!configSpaceCursor) {\n        setLastInteraction(null);\n        setStartPanVector(null);\n        return;\n      }\n\n      // Only dispatch the zoom action if the new clicked node is not the same as the old selected node.\n      // This essentially tracks double click action on a rectangle\n      if (lastInteraction === 'click') {\n        if (\n          hoveredNode &&\n          flamegraphState.profiles.selectedRoot &&\n          hoveredNode === flamegraphState.profiles.selectedRoot\n        ) {\n          // If double click is fired on a node, then zoom into it\n          canvasPoolManager.dispatch('zoom at frame', [hoveredNode, 'exact']);\n        }\n\n        canvasPoolManager.dispatch('highlight frame', [hoveredNode, 'selected']);\n        dispatchFlamegraphState({type: 'set selected root', payload: hoveredNode});\n      }\n\n      setLastInteraction(null);\n      setStartPanVector(null);\n    },\n    [\n      configSpaceCursor,\n      flamegraphState.profiles.selectedRoot,\n      dispatchFlamegraphState,\n      hoveredNode,\n      canvasPoolManager,\n      lastInteraction,\n    ]\n  );\n\n  const onMouseDrag = useCallback(\n    (evt: React.MouseEvent<HTMLCanvasElement>) => {\n      if (!flamegraphCanvas || !flamegraphView || !startPanVector) {\n        return;\n      }\n\n      const logicalMousePos = vec2.fromValues(\n        evt.nativeEvent.offsetX,\n        evt.nativeEvent.offsetY\n      );\n\n      const physicalMousePos = vec2.scale(\n        vec2.create(),\n        logicalMousePos,\n        window.devicePixelRatio\n      );\n\n      const physicalDelta = vec2.subtract(\n        vec2.create(),\n        startPanVector,\n        physicalMousePos\n      );\n\n      if (physicalDelta[0] === 0 && physicalDelta[1] === 0) {\n        return;\n      }\n\n      const physicalToConfig = mat3.invert(\n        mat3.create(),\n        flamegraphView.fromConfigView(flamegraphCanvas.physicalSpace)\n      );\n      const [m00, m01, m02, m10, m11, m12] = physicalToConfig;\n\n      const configDelta = vec2.transformMat3(vec2.create(), physicalDelta, [\n        m00,\n        m01,\n        m02,\n        m10,\n        m11,\n        m12,\n        0,\n        0,\n        0,\n      ]);\n\n      canvasPoolManager.dispatch('transform config view', [\n        mat3.fromTranslation(mat3.create(), configDelta),\n      ]);\n\n      setStartPanVector(physicalMousePos);\n    },\n    [flamegraphCanvas, flamegraphView, startPanVector, canvasPoolManager]\n  );\n\n  const onCanvasMouseMove = useCallback(\n    (evt: React.MouseEvent<HTMLCanvasElement>) => {\n      if (!flamegraphCanvas || !flamegraphView) {\n        return;\n      }\n\n      const configSpaceMouse = flamegraphView.getConfigViewCursor(\n        vec2.fromValues(evt.nativeEvent.offsetX, evt.nativeEvent.offsetY),\n        flamegraphCanvas\n      );\n\n      setConfigSpaceCursor(configSpaceMouse);\n\n      if (startPanVector) {\n        onMouseDrag(evt);\n        setLastInteraction('pan');\n      } else {\n        setLastInteraction(null);\n      }\n    },\n    [flamegraphCanvas, flamegraphView, setConfigSpaceCursor, onMouseDrag, startPanVector]\n  );\n\n  const onCanvasMouseLeave = useCallback(() => {\n    setConfigSpaceCursor(null);\n    setStartPanVector(null);\n    setLastInteraction(null);\n  }, []);\n\n  const zoom = useCallback(\n    (evt: WheelEvent) => {\n      if (!flamegraphCanvas || !flamegraphView) {\n        return;\n      }\n\n      const identity = mat3.identity(mat3.create());\n      const scale = 1 - evt.deltaY * 0.01 * -1; // -1 to invert scale\n\n      const mouseInConfigView = flamegraphView.getConfigViewCursor(\n        vec2.fromValues(evt.offsetX, evt.offsetY),\n        flamegraphCanvas\n      );\n\n      const configCenter = vec2.fromValues(\n        mouseInConfigView[0],\n        flamegraphView.configView.y\n      );\n\n      const invertedConfigCenter = vec2.multiply(\n        vec2.create(),\n        vec2.fromValues(-1, -1),\n        configCenter\n      );\n\n      const translated = mat3.translate(mat3.create(), identity, configCenter);\n      const scaled = mat3.scale(mat3.create(), translated, vec2.fromValues(scale, 1));\n      const translatedBack = mat3.translate(mat3.create(), scaled, invertedConfigCenter);\n\n      canvasPoolManager.dispatch('transform config view', [translatedBack]);\n    },\n    [flamegraphCanvas, flamegraphView, canvasPoolManager]\n  );\n\n  const scroll = useCallback(\n    (evt: WheelEvent) => {\n      if (!flamegraphCanvas || !flamegraphView) {\n        return;\n      }\n\n      const physicalDelta = vec2.fromValues(evt.deltaX, evt.deltaY);\n      const physicalToConfig = mat3.invert(\n        mat3.create(),\n        flamegraphView.fromConfigView(flamegraphCanvas.physicalSpace)\n      );\n      const [m00, m01, m02, m10, m11, m12] = physicalToConfig;\n\n      const configDelta = vec2.transformMat3(vec2.create(), physicalDelta, [\n        m00,\n        m01,\n        m02,\n        m10,\n        m11,\n        m12,\n        0,\n        0,\n        0,\n      ]);\n\n      const translate = mat3.fromTranslation(mat3.create(), configDelta);\n      canvasPoolManager.dispatch('transform config view', [translate]);\n    },\n    [flamegraphCanvas, flamegraphView, canvasPoolManager]\n  );\n\n  useEffect(() => {\n    if (!flamegraphCanvasRef) {\n      return undefined;\n    }\n\n    let wheelStopTimeoutId: number | undefined;\n    function onCanvasWheel(evt: WheelEvent) {\n      window.clearTimeout(wheelStopTimeoutId);\n      wheelStopTimeoutId = window.setTimeout(() => {\n        setLastInteraction(null);\n      }, 300);\n\n      evt.preventDefault();\n\n      // When we zoom, we want to clear cursor so that any tooltips\n      // rendered on the flamegraph are removed from the flamegraphView\n      setConfigSpaceCursor(null);\n\n      // pinch to zoom is recognized as `ctrlKey + wheelEvent`\n      if (evt.metaKey || evt.ctrlKey) {\n        zoom(evt);\n        setLastInteraction('zoom');\n      } else {\n        scroll(evt);\n        setLastInteraction('scroll');\n      }\n    }\n\n    flamegraphCanvasRef.addEventListener('wheel', onCanvasWheel);\n\n    return () => {\n      window.clearTimeout(wheelStopTimeoutId);\n      flamegraphCanvasRef.removeEventListener('wheel', onCanvasWheel);\n    };\n  }, [flamegraphCanvasRef, zoom, scroll]);\n\n  const contextMenu = useContextMenu({container: flamegraphCanvasRef});\n\n  return (\n    <CanvasContainer>\n      <Canvas\n        ref={canvas => setFlamegraphCanvasRef(canvas)}\n        onMouseDown={onCanvasMouseDown}\n        onMouseUp={onCanvasMouseUp}\n        onMouseMove={onCanvasMouseMove}\n        onMouseLeave={onCanvasMouseLeave}\n        onContextMenu={contextMenu.handleContextMenu}\n        style={{cursor: lastInteraction === 'pan' ? 'grab' : 'default'}}\n      />\n      <Canvas\n        ref={canvas => setFlamegraphOverlayCanvasRef(canvas)}\n        style={{\n          pointerEvents: 'none',\n        }}\n      />\n      <FlamegraphOptionsContextMenu contextMenu={contextMenu} />\n      {flamegraphCanvas &&\n      flamegraphRenderer &&\n      flamegraphView &&\n      configSpaceCursor &&\n      hoveredNode?.frame?.name ? (\n        <BoundTooltip\n          bounds={canvasBounds}\n          cursor={configSpaceCursor}\n          flamegraphCanvas={flamegraphCanvas}\n          flamegraphView={flamegraphView}\n        >\n          <HoveredFrameMainInfo>\n            <FrameColorIndicator\n              backgroundColor={formatColorForFrame(hoveredNode, flamegraphRenderer)}\n            />\n            {flamegraphRenderer.flamegraph.formatter(hoveredNode.node.totalWeight)}{' '}\n            {formatWeightToProfileDuration(\n              hoveredNode.node,\n              flamegraphRenderer.flamegraph\n            )}{' '}\n            {hoveredNode.frame.name}\n          </HoveredFrameMainInfo>\n          <HoveredFrameTimelineInfo>\n            {flamegraphRenderer.flamegraph.timelineFormatter(hoveredNode.start)}{' '}\n            {' \\u2014 '}\n            {flamegraphRenderer.flamegraph.timelineFormatter(hoveredNode.end)}\n          </HoveredFrameTimelineInfo>\n        </BoundTooltip>\n      ) : null}\n    </CanvasContainer>\n  );\n}\n\nconst HoveredFrameTimelineInfo = styled('div')`\n  color: ${p => p.theme.subText};\n`;\n\nconst HoveredFrameMainInfo = styled('div')`\n  display: flex;\n  align-items: center;\n`;\n\nconst FrameColorIndicator = styled('div')<{\n  backgroundColor: React.CSSProperties['backgroundColor'];\n}>`\n  width: 12px;\n  height: 12px;\n  min-width: 12px;\n  min-height: 12px;\n  border-radius: 2px;\n  display: inline-block;\n  background-color: ${p => p.backgroundColor};\n  margin-right: ${space(1)};\n`;\n\nconst CanvasContainer = styled('div')`\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  position: relative;\n`;\n\nconst Canvas = styled('canvas')`\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  user-select: none;\n  position: absolute;\n`;\n\nexport {FlamegraphZoomView};\n","import {Fragment, useCallback, useEffect, useMemo, useRef, useState} from 'react';\nimport styled from '@emotion/styled';\nimport {mat3, vec2} from 'gl-matrix';\n\nimport {CanvasPoolManager, CanvasScheduler} from 'sentry/utils/profiling/canvasScheduler';\nimport {Flamegraph} from 'sentry/utils/profiling/flamegraph';\nimport {useDispatchFlamegraphState} from 'sentry/utils/profiling/flamegraph/useFlamegraphState';\nimport {useFlamegraphTheme} from 'sentry/utils/profiling/flamegraph/useFlamegraphTheme';\nimport {FlamegraphCanvas} from 'sentry/utils/profiling/flamegraphCanvas';\nimport {FlamegraphView} from 'sentry/utils/profiling/flamegraphView';\nimport {Rect} from 'sentry/utils/profiling/gl/utils';\nimport {FlamegraphRenderer} from 'sentry/utils/profiling/renderers/flamegraphRenderer';\nimport {PositionIndicatorRenderer} from 'sentry/utils/profiling/renderers/positionIndicatorRenderer';\nimport usePrevious from 'sentry/utils/usePrevious';\n\ninterface FlamegraphZoomViewMinimapProps {\n  canvasPoolManager: CanvasPoolManager;\n  flamegraph: Flamegraph;\n  flamegraphMiniMapCanvas: FlamegraphCanvas | null;\n  flamegraphMiniMapCanvasRef: HTMLCanvasElement | null;\n  flamegraphMiniMapOverlayCanvasRef: HTMLCanvasElement | null;\n  flamegraphMiniMapView: FlamegraphView | null;\n  setFlamegraphMiniMapCanvasRef: React.Dispatch<\n    React.SetStateAction<HTMLCanvasElement | null>\n  >;\n  setFlamegraphMiniMapOverlayCanvasRef: React.Dispatch<\n    React.SetStateAction<HTMLCanvasElement | null>\n  >;\n}\n\nfunction FlamegraphZoomViewMinimap({\n  canvasPoolManager,\n  flamegraph,\n  flamegraphMiniMapCanvas,\n  flamegraphMiniMapCanvasRef,\n  flamegraphMiniMapOverlayCanvasRef,\n  flamegraphMiniMapView,\n  setFlamegraphMiniMapCanvasRef,\n  setFlamegraphMiniMapOverlayCanvasRef,\n}: FlamegraphZoomViewMinimapProps): React.ReactElement {\n  const flamegraphTheme = useFlamegraphTheme();\n  const [lastInteraction, setLastInteraction] = useState<\n    'pan' | 'click' | 'zoom' | 'scroll' | 'select' | null\n  >(null);\n\n  const [dispatch] = useDispatchFlamegraphState();\n\n  const [configSpaceCursor, setConfigSpaceCursor] = useState<vec2 | null>(null);\n\n  const scheduler = useMemo(() => new CanvasScheduler(), []);\n\n  const flamegraphMiniMapRenderer = useMemo(() => {\n    if (!flamegraphMiniMapCanvasRef) {\n      return null;\n    }\n\n    const BAR_HEIGHT =\n      flamegraphTheme.SIZES.MINIMAP_HEIGHT /\n      (flamegraph.depth + flamegraphTheme.SIZES.FLAMEGRAPH_DEPTH_OFFSET);\n\n    return new FlamegraphRenderer(flamegraphMiniMapCanvasRef, flamegraph, {\n      ...flamegraphTheme,\n      SIZES: {\n        ...flamegraphTheme.SIZES,\n        BAR_HEIGHT,\n      },\n    });\n  }, [flamegraph, flamegraphMiniMapCanvasRef, flamegraphTheme]);\n\n  const positionIndicatorRenderer: PositionIndicatorRenderer | null = useMemo(() => {\n    if (!flamegraphMiniMapOverlayCanvasRef) {\n      return null;\n    }\n\n    return new PositionIndicatorRenderer(\n      flamegraphMiniMapOverlayCanvasRef,\n      flamegraphTheme\n    );\n  }, [flamegraphMiniMapOverlayCanvasRef, flamegraphTheme]);\n\n  useEffect(() => {\n    if (\n      !flamegraphMiniMapCanvas ||\n      !flamegraphMiniMapView ||\n      !flamegraphMiniMapRenderer\n    ) {\n      return undefined;\n    }\n\n    const drawRectangles = () => {\n      flamegraphMiniMapRenderer.draw(\n        flamegraphMiniMapView.fromConfigSpace(flamegraphMiniMapCanvas.physicalSpace),\n        new Map()\n      );\n    };\n\n    scheduler.registerBeforeFrameCallback(drawRectangles);\n\n    return () => {\n      scheduler.unregisterBeforeFrameCallback(drawRectangles);\n    };\n  }, [\n    flamegraphMiniMapCanvas,\n    flamegraphMiniMapRenderer,\n    scheduler,\n    flamegraphMiniMapView,\n  ]);\n\n  useEffect(() => {\n    if (\n      !flamegraphMiniMapCanvas ||\n      !flamegraphMiniMapView ||\n      !positionIndicatorRenderer\n    ) {\n      return undefined;\n    }\n\n    const clearOverlayCanvas = () => {\n      positionIndicatorRenderer.context.clearRect(\n        0,\n        0,\n        positionIndicatorRenderer.canvas.width,\n        positionIndicatorRenderer.canvas.height\n      );\n    };\n\n    const drawPosition = () => {\n      positionIndicatorRenderer.draw(\n        flamegraphMiniMapView.configView,\n        flamegraphMiniMapView.configSpace,\n        flamegraphMiniMapView.fromConfigSpace(flamegraphMiniMapCanvas.physicalSpace)\n      );\n    };\n\n    scheduler.registerBeforeFrameCallback(clearOverlayCanvas);\n    scheduler.registerAfterFrameCallback(drawPosition);\n\n    scheduler.draw();\n\n    return () => {\n      scheduler.unregisterBeforeFrameCallback(clearOverlayCanvas);\n      scheduler.unregisterAfterFrameCallback(drawPosition);\n    };\n  }, [\n    flamegraphMiniMapCanvas,\n    flamegraphMiniMapView,\n    scheduler,\n    positionIndicatorRenderer,\n  ]);\n\n  const previousInteraction = usePrevious(lastInteraction);\n  const beforeInteractionConfigView = useRef<Rect | null>(null);\n\n  useEffect(() => {\n    if (!flamegraphMiniMapView) {\n      return;\n    }\n\n    // Check if we are starting a new interaction\n    if (previousInteraction === null && lastInteraction) {\n      beforeInteractionConfigView.current = flamegraphMiniMapView.configView.clone();\n      return;\n    }\n\n    if (\n      beforeInteractionConfigView.current &&\n      !beforeInteractionConfigView.current.equals(flamegraphMiniMapView.configView)\n    ) {\n      dispatch({\n        type: 'checkpoint',\n        payload: flamegraphMiniMapView.configView.clone(),\n      });\n    }\n  }, [lastInteraction, flamegraphMiniMapView, dispatch, previousInteraction]);\n\n  const [startDragVector, setStartDragConfigSpaceCursor] = useState<vec2 | null>(null);\n  const [lastDragVector, setLastDragVector] = useState<vec2 | null>(null);\n\n  useEffect(() => {\n    canvasPoolManager.registerScheduler(scheduler);\n    return () => canvasPoolManager.unregisterScheduler(scheduler);\n  }, [scheduler, canvasPoolManager]);\n\n  const onMouseDrag = useCallback(\n    (evt: React.MouseEvent<HTMLCanvasElement>) => {\n      if (!lastDragVector || !flamegraphMiniMapCanvas || !flamegraphMiniMapView) {\n        return;\n      }\n\n      const logicalMousePos = vec2.fromValues(\n        evt.nativeEvent.offsetX,\n        evt.nativeEvent.offsetY\n      );\n      const physicalMousePos = vec2.scale(\n        vec2.create(),\n        logicalMousePos,\n        window.devicePixelRatio\n      );\n\n      const physicalDelta = vec2.subtract(\n        vec2.create(),\n        physicalMousePos,\n        lastDragVector\n      );\n\n      if (physicalDelta[0] === 0 && physicalDelta[1] === 0) {\n        return;\n      }\n\n      const physicalToConfig = mat3.invert(\n        mat3.create(),\n        flamegraphMiniMapView.fromConfigSpace(flamegraphMiniMapCanvas.physicalSpace)\n      );\n\n      const configDelta = vec2.transformMat3(\n        vec2.create(),\n        physicalDelta,\n        physicalToConfig\n      );\n\n      canvasPoolManager.dispatch('transform config view', [\n        mat3.fromTranslation(mat3.create(), configDelta),\n      ]);\n\n      setLastDragVector(physicalMousePos);\n    },\n    [flamegraphMiniMapCanvas, flamegraphMiniMapView, lastDragVector, canvasPoolManager]\n  );\n\n  const onMinimapCanvasMouseMove = useCallback(\n    (evt: React.MouseEvent<HTMLCanvasElement>) => {\n      if (!flamegraphMiniMapCanvas || !flamegraphMiniMapView) {\n        return;\n      }\n\n      const configSpaceMouse = flamegraphMiniMapView.getConfigSpaceCursor(\n        vec2.fromValues(evt.nativeEvent.offsetX, evt.nativeEvent.offsetY),\n        flamegraphMiniMapCanvas\n      );\n\n      setConfigSpaceCursor(configSpaceMouse);\n\n      if (lastDragVector) {\n        onMouseDrag(evt);\n        setLastInteraction('pan');\n        return;\n      }\n      if (startDragVector) {\n        const start = vec2.min(vec2.create(), startDragVector, configSpaceMouse);\n        const end = vec2.max(vec2.create(), startDragVector, configSpaceMouse);\n\n        const rect = new Rect(\n          start[0],\n          configSpaceMouse[1] - flamegraphMiniMapView.configView.height / 2,\n          end[0] - start[0],\n          flamegraphMiniMapView.configView.height\n        );\n        canvasPoolManager.dispatch('set config view', [rect]);\n        setLastInteraction('select');\n        return;\n      }\n\n      setLastInteraction(null);\n    },\n    [\n      flamegraphMiniMapCanvas,\n      flamegraphMiniMapView,\n      canvasPoolManager,\n      lastDragVector,\n      onMouseDrag,\n      startDragVector,\n    ]\n  );\n\n  const onMinimapScroll = useCallback(\n    (evt: WheelEvent) => {\n      if (!flamegraphMiniMapCanvas || !flamegraphMiniMapView) {\n        return;\n      }\n\n      {\n        const physicalDelta = vec2.fromValues(evt.deltaX * 0.8, evt.deltaY);\n        const physicalToConfig = mat3.invert(\n          mat3.create(),\n          flamegraphMiniMapView.fromConfigView(flamegraphMiniMapCanvas.physicalSpace)\n        );\n        const [m00, m01, m02, m10, m11, m12] = physicalToConfig;\n\n        const configDelta = vec2.transformMat3(vec2.create(), physicalDelta, [\n          m00,\n          m01,\n          m02,\n          m10,\n          m11,\n          m12,\n          0,\n          0,\n          0,\n        ]);\n\n        const translate = mat3.fromTranslation(mat3.create(), configDelta);\n        canvasPoolManager.dispatch('transform config view', [translate]);\n      }\n    },\n    [flamegraphMiniMapCanvas, flamegraphMiniMapView, canvasPoolManager]\n  );\n\n  const onMinimapZoom = useCallback(\n    (evt: WheelEvent) => {\n      if (!flamegraphMiniMapCanvas || !flamegraphMiniMapView) {\n        return;\n      }\n\n      const identity = mat3.identity(mat3.create());\n      const scale = 1 - evt.deltaY * 0.001 * -1; // -1 to invert scale\n\n      const mouseInConfigSpace = flamegraphMiniMapView.getConfigSpaceCursor(\n        vec2.fromValues(evt.offsetX, evt.offsetY),\n        flamegraphMiniMapCanvas\n      );\n\n      const configCenter = vec2.fromValues(\n        mouseInConfigSpace[0],\n        flamegraphMiniMapView.configView.y\n      );\n\n      const invertedConfigCenter = vec2.multiply(\n        vec2.create(),\n        vec2.fromValues(-1, -1),\n        configCenter\n      );\n\n      const translated = mat3.translate(mat3.create(), identity, configCenter);\n      const scaled = mat3.scale(mat3.create(), translated, vec2.fromValues(scale, 1));\n      const translatedBack = mat3.translate(mat3.create(), scaled, invertedConfigCenter);\n\n      canvasPoolManager.dispatch('transform config view', [translatedBack]);\n    },\n    [flamegraphMiniMapCanvas, flamegraphMiniMapView, canvasPoolManager]\n  );\n\n  const onMinimapCanvasMouseDown = useCallback(\n    evt => {\n      if (\n        !configSpaceCursor ||\n        !flamegraphMiniMapCanvas ||\n        !flamegraphMiniMapView ||\n        !canvasPoolManager\n      ) {\n        return;\n      }\n\n      const logicalMousePos = vec2.fromValues(\n        evt.nativeEvent.offsetX,\n        evt.nativeEvent.offsetY\n      );\n      const physicalMousePos = vec2.scale(\n        vec2.create(),\n        logicalMousePos,\n        window.devicePixelRatio\n      );\n\n      if (flamegraphMiniMapView.configView.contains(configSpaceCursor)) {\n        setLastDragVector(physicalMousePos);\n      } else {\n        const startConfigSpaceCursor = flamegraphMiniMapView.getConfigSpaceCursor(\n          vec2.fromValues(evt.nativeEvent.offsetX, evt.nativeEvent.offsetY),\n          flamegraphMiniMapCanvas\n        );\n        setStartDragConfigSpaceCursor(startConfigSpaceCursor);\n      }\n      setLastInteraction('select');\n    },\n    [configSpaceCursor, flamegraphMiniMapCanvas, flamegraphMiniMapView, canvasPoolManager]\n  );\n\n  const onMinimapCanvasMouseUp = useCallback(() => {\n    setConfigSpaceCursor(null);\n    setStartDragConfigSpaceCursor(null);\n    setLastDragVector(null);\n    setLastInteraction(null);\n  }, []);\n\n  useEffect(() => {\n    if (!flamegraphMiniMapCanvasRef) {\n      return undefined;\n    }\n\n    let wheelStopTimeoutId: number | undefined;\n    function onCanvasWheel(evt: WheelEvent) {\n      window.clearTimeout(wheelStopTimeoutId);\n      wheelStopTimeoutId = window.setTimeout(() => {\n        setLastInteraction(null);\n      }, 300);\n\n      evt.preventDefault();\n\n      // When we zoom, we want to clear cursor so that any tooltips\n      // rendered on the flamegraph are removed from the view\n      setConfigSpaceCursor(null);\n\n      if (evt.metaKey || evt.ctrlKey) {\n        onMinimapZoom(evt);\n        setLastInteraction('zoom');\n      } else {\n        onMinimapScroll(evt);\n        setLastInteraction('scroll');\n      }\n    }\n\n    flamegraphMiniMapCanvasRef.addEventListener('wheel', onCanvasWheel);\n\n    return () => {\n      window.clearTimeout(wheelStopTimeoutId);\n      flamegraphMiniMapCanvasRef.removeEventListener('wheel', onCanvasWheel);\n    };\n  }, [flamegraphMiniMapCanvasRef, onMinimapZoom, onMinimapScroll]);\n\n  useEffect(() => {\n    window.addEventListener('mouseup', onMinimapCanvasMouseUp);\n\n    return () => {\n      window.removeEventListener('mouseup', onMinimapCanvasMouseUp);\n    };\n  }, [onMinimapCanvasMouseUp]);\n\n  useEffect(() => {\n    if (!flamegraphMiniMapCanvasRef) {\n      return undefined;\n    }\n\n    const onCanvasWheel = (evt: WheelEvent) => {\n      evt.preventDefault();\n      const isZoom = evt.metaKey;\n\n      // @TODO figure out what key to use for other platforms\n      if (isZoom) {\n        onMinimapZoom(evt);\n      } else {\n        onMinimapScroll(evt);\n      }\n    };\n\n    flamegraphMiniMapCanvasRef.addEventListener('wheel', onCanvasWheel);\n    return () => flamegraphMiniMapCanvasRef?.removeEventListener('wheel', onCanvasWheel);\n  }, [flamegraphMiniMapCanvasRef, onMinimapScroll, onMinimapZoom]);\n\n  return (\n    <Fragment>\n      <Canvas\n        ref={c => setFlamegraphMiniMapCanvasRef(c)}\n        onMouseDown={onMinimapCanvasMouseDown}\n        onMouseMove={onMinimapCanvasMouseMove}\n        onMouseLeave={onMinimapCanvasMouseUp}\n        cursor={\n          configSpaceCursor &&\n          flamegraphMiniMapView?.configView.contains(configSpaceCursor)\n            ? 'grab'\n            : 'col-resize'\n        }\n      />\n      <OverlayCanvas ref={c => setFlamegraphMiniMapOverlayCanvasRef(c)} />\n    </Fragment>\n  );\n}\n\nconst Canvas = styled('canvas')<{cursor?: React.CSSProperties['cursor']}>`\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  cursor: ${props => props.cursor ?? 'default'};\n  user-select: none;\n`;\n\nconst OverlayCanvas = styled(Canvas)`\n  pointer-events: none;\n`;\n\nexport {FlamegraphZoomViewMinimap};\n","import {useCallback, useState} from 'react';\nimport styled from '@emotion/styled';\n\nimport Button from 'sentry/components/button';\nimport {t} from 'sentry/locale';\nimport {LightFlamegraphTheme} from 'sentry/utils/profiling/flamegraph/flamegraphTheme';\nimport {\n  importDroppedProfile,\n  ProfileGroup,\n} from 'sentry/utils/profiling/profile/importProfile';\n\nexport interface ProfileDragDropImportProps {\n  children: React.ReactNode;\n  onImport: (profile: ProfileGroup) => void;\n}\n\nfunction ProfileDragDropImport({\n  onImport,\n  children,\n}: ProfileDragDropImportProps): React.ReactElement {\n  const [dropState, setDropState] = useState<\n    'idle' | 'dragover' | 'processing' | 'errored'\n  >('idle');\n  const [errorMessage, setErrorMessage] = useState<string | null>(null);\n\n  const onDrop = useCallback(\n    (evt: React.DragEvent<HTMLDivElement>) => {\n      evt.preventDefault();\n      evt.stopPropagation();\n\n      const file = evt.dataTransfer.items[0].getAsFile();\n\n      if (file) {\n        setDropState('processing');\n        importDroppedProfile(file)\n          .then(profile => {\n            setDropState('idle');\n            setErrorMessage(null);\n\n            onImport(profile);\n          })\n          .catch(e => {\n            setDropState('errored');\n            setErrorMessage(e.message);\n          });\n      }\n    },\n    [onImport]\n  );\n\n  const onDragEnter = useCallback((evt: React.DragEvent<HTMLDivElement>) => {\n    evt.preventDefault();\n    evt.stopPropagation();\n    setDropState('dragover');\n  }, []);\n\n  const onDragLeave = useCallback((evt: React.DragEvent<HTMLDivElement>) => {\n    evt.preventDefault();\n    evt.stopPropagation();\n    setDropState('idle');\n  }, []);\n\n  // This is required to indicate that onDrop is supported on this element\n  const onDragOver = useCallback((evt: React.DragEvent<HTMLDivElement>) => {\n    evt.preventDefault();\n  }, []);\n\n  const onDismiss = useCallback(() => {\n    setDropState('idle');\n    setErrorMessage(null);\n  }, []);\n\n  return (\n    <DragDropContainer onDragEnter={onDragEnter}>\n      {dropState === 'idle' ? null : dropState === 'errored' ? (\n        <Overlay>\n          {t('Failed to import profile with error')}\n          <p>{errorMessage}</p>\n          <div>\n            <Button onClick={onDismiss}>{t('Dismiss')}</Button>\n          </div>\n        </Overlay>\n      ) : (\n        <Overlay onDrop={onDrop} onDragOver={onDragOver} onDragLeave={onDragLeave}>\n          {t('Drop profile here')}\n        </Overlay>\n      )}\n      {children}\n    </DragDropContainer>\n  );\n}\n\nconst DragDropContainer = styled('div')`\n  display: flex;\n  flex-direction: column;\n  flex: 1 1 100%;\n`;\n\nconst Overlay = styled('div')`\n  position: absolute;\n  left: 0;\n  bottom: 0;\n  width: 100%;\n  height: calc(100% - ${LightFlamegraphTheme.SIZES.TIMELINE_HEIGHT}px);\n  display: grid;\n  grid: auto/50%;\n  place-content: center;\n  z-index: ${p => p.theme.zIndex.modal};\n  text-align: center;\n  background-color: ${p => p.theme.surface100};\n`;\n\nexport {ProfileDragDropImport};\n","import {cloneElement, useMemo, useRef} from 'react';\nimport styled from '@emotion/styled';\n\nimport {FlamegraphPreferences} from 'sentry/utils/profiling/flamegraph/flamegraphStateProvider/flamegraphPreferences';\nimport {FlamegraphTheme} from 'sentry/utils/profiling/flamegraph/flamegraphTheme';\nimport {useFlamegraphPreferencesValue} from 'sentry/utils/profiling/flamegraph/useFlamegraphPreferences';\nimport {useFlamegraphTheme} from 'sentry/utils/profiling/flamegraph/useFlamegraphTheme';\nimport {\n  useResizableDrawer,\n  UseResizableDrawerOptions,\n} from 'sentry/utils/profiling/hooks/useResizableDrawer';\n\n// 664px is approximately the width where we start to scroll inside\n// 30px is the min height to where the drawer can still be resized\nconst MIN_FRAMESTACK_DIMENSIONS: [number, number] = [664, 30];\ninterface ProfilingFlamechartLayoutProps {\n  flamechart: React.ReactElement;\n  frameStack: React.ReactElement;\n  minimap: React.ReactElement;\n}\n\nexport function ProfilingFlamechartLayout(props: ProfilingFlamechartLayoutProps) {\n  const flamegraphTheme = useFlamegraphTheme();\n  const {layout} = useFlamegraphPreferencesValue();\n  const frameStackRef = useRef<HTMLDivElement>(null);\n\n  const resizableOptions: UseResizableDrawerOptions = useMemo(() => {\n    const initialDimensions: [number, number] = [\n      // Half the screen minus the ~sidebar width\n      window.innerWidth * 0.5 - 220,\n      (flamegraphTheme.SIZES.FLAMEGRAPH_DEPTH_OFFSET + 2) *\n        flamegraphTheme.SIZES.BAR_HEIGHT,\n    ];\n\n    const onResize = (newDimensions: [number, number]) => {\n      if (!frameStackRef.current) {\n        return;\n      }\n\n      if (layout === 'table left' || layout === 'table right') {\n        frameStackRef.current.style.width = `${newDimensions[0]}px`;\n        frameStackRef.current.style.height = `100%`;\n      } else {\n        frameStackRef.current.style.height = `${newDimensions[1]}px`;\n        frameStackRef.current.style.width = `100%`;\n      }\n    };\n\n    return {\n      initialDimensions,\n      onResize,\n      direction:\n        layout === 'table left'\n          ? 'horizontal-ltr'\n          : layout === 'table right'\n          ? 'horizontal-rtl'\n          : 'vertical',\n      min: MIN_FRAMESTACK_DIMENSIONS,\n    };\n  }, [\n    flamegraphTheme.SIZES.FLAMEGRAPH_DEPTH_OFFSET,\n    flamegraphTheme.SIZES.BAR_HEIGHT,\n    layout,\n  ]);\n\n  const {onMouseDown} = useResizableDrawer(resizableOptions);\n\n  return (\n    <ProfilingFlamechartLayoutContainer>\n      <ProfilingFlamechartGrid layout={layout}>\n        <MinimapContainer height={flamegraphTheme.SIZES.MINIMAP_HEIGHT}>\n          {props.minimap}\n        </MinimapContainer>\n        <ZoomViewContainer>{props.flamechart}</ZoomViewContainer>\n        <FrameStackContainer ref={frameStackRef} layout={layout}>\n          {cloneElement(props.frameStack, {onResize: onMouseDown})}\n        </FrameStackContainer>\n      </ProfilingFlamechartGrid>\n    </ProfilingFlamechartLayoutContainer>\n  );\n}\n\nconst ProfilingFlamechartLayoutContainer = styled('div')`\n  display: flex;\n  flex: 1 1 100%;\n`;\n\nconst ProfilingFlamechartGrid = styled('div')<{\n  layout?: FlamegraphPreferences['layout'];\n}>`\n  display: grid;\n  width: 100%;\n  grid-template-rows: ${({layout}) =>\n    layout === 'table bottom'\n      ? 'auto 1fr'\n      : layout === 'table right'\n      ? '100px auto'\n      : '100px auto'};\n  grid-template-columns: ${({layout}) =>\n    layout === 'table bottom'\n      ? '100%'\n      : layout === 'table left'\n      ? `min-content auto`\n      : `auto min-content`};\n\n  /* false positive for grid layout */\n  /* stylelint-disable */\n  grid-template-areas: ${({layout}) =>\n    layout === 'table bottom'\n      ? `\n        'minimap'\n        'flamegraph'\n        'frame-stack'\n        `\n      : layout === 'table right'\n      ? `\n        'minimap    frame-stack'\n        'flamegraph frame-stack'\n      `\n      : layout === 'table left'\n      ? `\n        'frame-stack minimap'\n        'frame-stack flamegraph'\n    `\n      : ''};\n`;\n\nconst MinimapContainer = styled('div')<{\n  height: FlamegraphTheme['SIZES']['MINIMAP_HEIGHT'];\n}>`\n  position: relative;\n  height: ${p => p.height}px;\n  grid-area: minimap;\n`;\n\nconst ZoomViewContainer = styled('div')`\n  display: flex;\n  flex-direction: column;\n  flex: 1 1 100%;\n  grid-area: flamegraph;\n  position: relative;\n`;\n\nconst FrameStackContainer = styled('div')<{layout: FlamegraphPreferences['layout']}>`\n  grid-area: frame-stack;\n  position: relative;\n  overflow: auto;\n  min-width: ${MIN_FRAMESTACK_DIMENSIONS[0]}px;\n\n  > div {\n    position: absolute;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n  }\n`;\n","import {useCallback, useMemo} from 'react';\nimport styled from '@emotion/styled';\n\nimport CompactSelect from 'sentry/components/forms/compactSelect';\nimport {ControlProps, GeneralSelectValue} from 'sentry/components/forms/selectControl';\nimport {IconList} from 'sentry/icons';\nimport {tn} from 'sentry/locale';\nimport space from 'sentry/styles/space';\nimport {SelectValue} from 'sentry/types';\nimport {defined} from 'sentry/utils';\nimport {FlamegraphState} from 'sentry/utils/profiling/flamegraph/flamegraphStateProvider/index';\nimport {ProfileGroup} from 'sentry/utils/profiling/profile/importProfile';\nimport {Profile} from 'sentry/utils/profiling/profile/profile';\nimport {makeFormatter} from 'sentry/utils/profiling/units/units';\n\ninterface ThreadSelectorProps {\n  onThreadIdChange: (threadId: Profile['threadId']) => void;\n  profileGroup: ProfileGroup;\n  threadId: FlamegraphState['profiles']['threadId'];\n}\n\nfunction ThreadMenuSelector<OptionType extends GeneralSelectValue = GeneralSelectValue>({\n  threadId,\n  onThreadIdChange,\n  profileGroup,\n}: ThreadSelectorProps) {\n  const options: SelectValue<number>[] = useMemo(() => {\n    return [...profileGroup.profiles].sort(compareProfiles).map(profile => ({\n      label: profile.name\n        ? `tid (${profile.threadId}): ${profile.name}`\n        : `tid (${profile.threadId})`,\n      value: profile.threadId,\n      details: (\n        <ThreadLabelDetails\n          duration={makeFormatter(profile.unit)(profile.duration)}\n          samples={profile.samples.length}\n        />\n      ),\n    }));\n  }, [profileGroup]);\n\n  const handleChange: NonNullable<ControlProps<OptionType>['onChange']> = useCallback(\n    opt => {\n      if (defined(opt)) {\n        onThreadIdChange(opt.value);\n      }\n    },\n    [onThreadIdChange]\n  );\n\n  return (\n    <CompactSelect\n      triggerProps={{\n        icon: <IconList size=\"xs\" />,\n        size: 'xs',\n      }}\n      options={options}\n      value={threadId}\n      onChange={handleChange}\n      isSearchable\n    />\n  );\n}\n\ninterface ThreadLabelDetailsProps {\n  duration: string;\n  samples: number;\n}\n\nfunction ThreadLabelDetails(props: ThreadLabelDetailsProps) {\n  return (\n    <DetailsContainer>\n      <div>{props.duration}</div>\n      <div>{tn('%s sample', '%s samples', props.samples)}</div>\n    </DetailsContainer>\n  );\n}\n\ntype ProfileLight = {\n  duration: Profile['duration'];\n  name: Profile['name'];\n  threadId: Profile['threadId'];\n};\n\nfunction compareProfiles(a: ProfileLight, b: ProfileLight): number {\n  if (!b.duration) {\n    return -1;\n  }\n  if (!a.duration) {\n    return 1;\n  }\n\n  if (a.name.startsWith('(tid') && b.name.startsWith('(tid')) {\n    return -1;\n  }\n  if (a.name.startsWith('(tid')) {\n    return -1;\n  }\n  if (b.name.startsWith('(tid')) {\n    return -1;\n  }\n  if (a.name.includes('main')) {\n    return -1;\n  }\n  if (b.name.includes('main')) {\n    return 1;\n  }\n  return a.name > b.name ? -1 : 1;\n}\n\nconst DetailsContainer = styled('div')`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  gap: ${space(1)};\n`;\n\nexport {ThreadMenuSelector};\n","import {mat3} from 'gl-matrix';\n\nimport {Rect} from './gl/utils';\nimport {FlamegraphFrame} from './flamegraphFrame';\n\ntype DrawFn = () => void;\ntype ArgumentTypes<F> = F extends (...args: infer A) => any ? A : never;\n\nexport interface FlamegraphEvents {\n  ['highlight frame']: (\n    frame: FlamegraphFrame | null,\n    mode: 'hover' | 'selected'\n  ) => void;\n  ['reset zoom']: () => void;\n  ['set config view']: (configView: Rect) => void;\n  ['transform config view']: (transform: mat3) => void;\n  ['zoom at frame']: (frame: FlamegraphFrame, strategy: 'min' | 'exact') => void;\n}\n\ntype EventStore = {[K in keyof FlamegraphEvents]: Set<FlamegraphEvents[K]>};\n\nexport class CanvasScheduler {\n  beforeFrameCallbacks: Set<DrawFn> = new Set();\n  afterFrameCallbacks: Set<DrawFn> = new Set();\n\n  onDisposeCallbacks: Set<() => void> = new Set();\n  requestAnimationFrame: number | null = null;\n\n  events: EventStore = {\n    ['reset zoom']: new Set<FlamegraphEvents['reset zoom']>(),\n    ['highlight frame']: new Set<FlamegraphEvents['highlight frame']>(),\n    ['set config view']: new Set<FlamegraphEvents['set config view']>(),\n    ['transform config view']: new Set<FlamegraphEvents['transform config view']>(),\n    ['zoom at frame']: new Set<FlamegraphEvents['zoom at frame']>(),\n  };\n\n  onDispose(cb: () => void): void {\n    if (this.onDisposeCallbacks.has(cb)) {\n      return;\n    }\n\n    this.onDisposeCallbacks.add(cb);\n  }\n\n  on<K extends keyof FlamegraphEvents>(eventName: K, cb: FlamegraphEvents[K]): void {\n    const set = this.events[eventName] as unknown as Set<FlamegraphEvents[K]>;\n    if (set.has(cb)) {\n      return;\n    }\n    set.add(cb);\n  }\n\n  off<K extends keyof FlamegraphEvents>(eventName: K, cb: FlamegraphEvents[K]): void {\n    const set = this.events[eventName] as unknown as Set<FlamegraphEvents[K]>;\n\n    if (set.has(cb)) {\n      set.delete(cb);\n    }\n  }\n\n  dispatch<K extends keyof FlamegraphEvents>(\n    event: K,\n    ...args: ArgumentTypes<FlamegraphEvents[K]>\n  ): void {\n    for (const handler of this.events[event]) {\n      // @ts-ignore\n      handler(...args);\n    }\n  }\n\n  private registerCallback(cb: DrawFn, pool: Set<DrawFn>) {\n    if (pool.has(cb)) {\n      return;\n    }\n    pool.add(cb);\n  }\n\n  private unregisterCallback(cb: DrawFn, pool: Set<DrawFn>) {\n    if (pool.has(cb)) {\n      pool.delete(cb);\n    }\n  }\n\n  registerBeforeFrameCallback(cb: DrawFn): void {\n    this.registerCallback(cb, this.beforeFrameCallbacks);\n  }\n  unregisterBeforeFrameCallback(cb: DrawFn): void {\n    this.unregisterCallback(cb, this.beforeFrameCallbacks);\n  }\n  registerAfterFrameCallback(cb: DrawFn): void {\n    this.registerCallback(cb, this.afterFrameCallbacks);\n  }\n  unregisterAfterFrameCallback(cb: DrawFn): void {\n    this.unregisterCallback(cb, this.afterFrameCallbacks);\n  }\n\n  dispose(): void {\n    for (const cb of this.onDisposeCallbacks) {\n      this.onDisposeCallbacks.delete(cb);\n      cb();\n    }\n    for (const type in this.events) {\n      this.events[type].clear();\n    }\n  }\n\n  drawSync(): void {\n    for (const cb of this.beforeFrameCallbacks) {\n      cb();\n    }\n\n    for (const cb of this.afterFrameCallbacks) {\n      cb();\n    }\n  }\n\n  draw(): void {\n    if (this.requestAnimationFrame) {\n      window.cancelAnimationFrame(this.requestAnimationFrame);\n    }\n\n    this.requestAnimationFrame = window.requestAnimationFrame(() => {\n      for (const cb of this.beforeFrameCallbacks) {\n        cb();\n      }\n\n      for (const cb of this.afterFrameCallbacks) {\n        cb();\n      }\n      this.requestAnimationFrame = null;\n    });\n  }\n}\n\nexport class CanvasPoolManager {\n  schedulers: Set<CanvasScheduler> = new Set();\n\n  registerScheduler(scheduler: CanvasScheduler): void {\n    if (this.schedulers.has(scheduler)) {\n      return;\n    }\n    this.schedulers.add(scheduler);\n  }\n\n  dispatch<K extends keyof FlamegraphEvents>(\n    event: K,\n    args: ArgumentTypes<FlamegraphEvents[K]>\n  ): void {\n    for (const scheduler of this.schedulers) {\n      scheduler.dispatch(event, ...args);\n    }\n  }\n\n  unregisterScheduler(scheduler: CanvasScheduler): void {\n    if (this.schedulers.has(scheduler)) {\n      scheduler.dispose();\n      this.schedulers.delete(scheduler);\n    }\n  }\n\n  drawSync(): void {\n    for (const scheduler of this.schedulers) {\n      scheduler.drawSync();\n    }\n  }\n\n  draw(): void {\n    for (const scheduler of this.schedulers) {\n      scheduler.draw();\n    }\n  }\n}\n","import {ColorChannels, FlamegraphTheme, LCH} from '../flamegraph/flamegraphTheme';\nimport {FlamegraphFrame} from '../flamegraphFrame';\n\nconst uniqueBy = <T,>(arr: ReadonlyArray<T>, predicate: (t: T) => unknown): Array<T> => {\n  const cb = typeof predicate === 'function' ? predicate : (o: T) => o[predicate];\n\n  return [\n    ...arr\n      .reduce((map, item) => {\n        const key = item === null || item === undefined ? item : cb(item);\n\n        if (key === undefined || key === null) {\n          return map;\n        }\n        map.has(key) || map.set(key, item);\n\n        return map;\n      }, new Map())\n      .values(),\n  ];\n};\n\n// These were taken from speedscope, originally described in\n// https://en.wikipedia.org/wiki/HSL_and_HSV#From_luma/chroma/hue\nexport const fract = (x: number): number => x - Math.floor(x);\nexport const triangle = (x: number): number => 2.0 * Math.abs(fract(x) - 0.5) - 1.0;\nexport function fromLumaChromaHue(L: number, C: number, H: number): ColorChannels {\n  const hPrime = H / 60;\n  const X = C * (1 - Math.abs((hPrime % 2) - 1));\n  const [R1, G1, B1] =\n    hPrime < 1\n      ? [C, X, 0]\n      : hPrime < 2\n      ? [X, C, 0]\n      : hPrime < 3\n      ? [0, C, X]\n      : hPrime < 4\n      ? [0, X, C]\n      : hPrime < 5\n      ? [X, 0, C]\n      : [C, 0, X];\n\n  const m = L - (0.3 * R1 + 0.59 * G1 + 0.11 * B1);\n\n  return [clamp(R1 + m, 0, 1), clamp(G1 + m, 0, 1), clamp(B1 + m, 0, 1.0)];\n}\n\nexport const makeStackToColor = (\n  fallback: [number, number, number, number]\n): FlamegraphTheme['COLORS']['STACK_TO_COLOR'] => {\n  return (\n    frames: ReadonlyArray<FlamegraphFrame>,\n    colorMap: FlamegraphTheme['COLORS']['COLOR_MAP'],\n    colorBucket: FlamegraphTheme['COLORS']['COLOR_BUCKET']\n  ) => {\n    const colors = colorMap(frames, colorBucket);\n    const length = frames.length;\n\n    // Length * number of frames * color components\n    const colorBuffer: number[] = new Array(length * 4 * 6);\n\n    for (let index = 0; index < length; index++) {\n      const c = colors.get(frames[index].key);\n      const colorWithAlpha = c ? c.concat(1) : fallback;\n\n      for (let i = 0; i < 6; i++) {\n        const offset = index * 6 * 4 + i * 4;\n        colorBuffer[offset] = colorWithAlpha[0];\n        colorBuffer[offset + 1] = colorWithAlpha[1];\n        colorBuffer[offset + 2] = colorWithAlpha[2];\n        colorBuffer[offset + 3] = colorWithAlpha[3];\n      }\n    }\n\n    return {\n      colorBuffer,\n      colorMap: colors,\n    };\n  };\n};\n\nexport const isNumber = (input: unknown): input is number => {\n  return typeof input === 'number' && !isNaN(input);\n};\n\nexport function clamp(number: number, min?: number, max?: number): number {\n  if (!isNumber(min) && !isNumber(max)) {\n    throw new Error('Clamp requires at least a min or max parameter');\n  }\n\n  if (isNumber(min) && isNumber(max)) {\n    return number < min ? min : number > max ? max : number;\n  }\n\n  if (isNumber(max)) {\n    return number > max ? max : number;\n  }\n\n  if (isNumber(min)) {\n    return number < min ? min : number;\n  }\n\n  throw new Error('Unreachable case detected');\n}\n\nexport function toRGBAString(r: number, g: number, b: number, alpha: number): string {\n  return `rgba(${clamp(r * 255, 0, 255)}, ${clamp(g * 255, 0, 255)}, ${clamp(\n    b * 255,\n    0,\n    255\n  )}, ${alpha})`;\n}\n\nexport function defaultFrameSortKey(frame: FlamegraphFrame): string {\n  return frame.frame.name + (frame.frame.image || '');\n}\n\nfunction defaultFrameSort(a: FlamegraphFrame, b: FlamegraphFrame): number {\n  return defaultFrameSortKey(a) > defaultFrameSortKey(b) ? 1 : -1;\n}\n\nexport const makeColorBucketTheme = (lch: LCH) => {\n  return (t: number): ColorChannels => {\n    const x = triangle(30.0 * t);\n    const H = 360.0 * (0.9 * t);\n    const C = lch.C_0 + lch.C_d * x;\n    const L = lch.L_0 - lch.L_d * x;\n    return fromLumaChromaHue(L, C, H);\n  };\n};\n\nexport const makeColorMap = (\n  frames: ReadonlyArray<FlamegraphFrame>,\n  colorBucket: FlamegraphTheme['COLORS']['COLOR_BUCKET'],\n  sortBy: (a: FlamegraphFrame, b: FlamegraphFrame) => number = defaultFrameSort\n): Map<FlamegraphFrame['frame']['key'], ColorChannels> => {\n  const colors = new Map<FlamegraphFrame['frame']['key'], ColorChannels>();\n\n  const sortedFrames = [...frames].sort(sortBy);\n  const uniqueFrames = uniqueBy(frames, f => f.frame.name + f.frame.image);\n\n  const colorsByName = new Map<FlamegraphFrame['frame']['key'], ColorChannels>();\n\n  for (let i = 0; i < sortedFrames.length; i++) {\n    const frame = sortedFrames[i];\n    const nameKey = frame.frame.name + frame.frame.image ?? '';\n\n    if (!colorsByName.has(nameKey)) {\n      const color = colorBucket(\n        Math.floor((255 * i) / uniqueFrames.length) / 256,\n        frame.frame\n      );\n      colorsByName.set(nameKey, color);\n    }\n\n    colors.set(frame.key, colorsByName.get(nameKey)!);\n  }\n\n  return colors;\n};\n\nexport const makeColorMapByRecursion = (\n  frames: ReadonlyArray<FlamegraphFrame>,\n  colorBucket: FlamegraphTheme['COLORS']['COLOR_BUCKET']\n): Map<FlamegraphFrame['frame']['key'], ColorChannels> => {\n  const colors = new Map<FlamegraphFrame['frame']['key'], ColorChannels>();\n\n  const sortedFrames = [...frames]\n    .sort((a, b) => a.frame.name.localeCompare(b.frame.name))\n    .filter(f => f.node.isRecursive());\n\n  const colorsByName = new Map<FlamegraphFrame['frame']['key'], ColorChannels>();\n\n  for (let i = 0; i < sortedFrames.length; i++) {\n    const frame = sortedFrames[i];\n    const nameKey = frame.frame.name + frame.frame.image ?? '';\n\n    if (!colorsByName.has(nameKey)) {\n      const color = colorBucket(\n        Math.floor((255 * i) / sortedFrames.length) / 256,\n        frame.frame\n      );\n\n      colorsByName.set(nameKey, color);\n    }\n\n    colors.set(frame.key, colorsByName.get(nameKey)!);\n  }\n\n  return colors;\n};\n\nexport const makeColorMapByImage = (\n  frames: ReadonlyArray<FlamegraphFrame>,\n  colorBucket: FlamegraphTheme['COLORS']['COLOR_BUCKET']\n): Map<FlamegraphFrame['frame']['key'], ColorChannels> => {\n  const colors = new Map<FlamegraphFrame['frame']['key'], ColorChannels>();\n\n  const reverseFrameToImageIndex: Record<string, FlamegraphFrame[]> = {};\n\n  const uniqueFrames = uniqueBy(frames, f => f.frame.image);\n  const sortedFrames = [...uniqueFrames].sort((a, b) =>\n    (a.frame.image ?? '') > (b.frame.image ?? '') ? 1 : -1\n  );\n\n  for (let i = 0; i < frames.length; i++) {\n    const frame = frames[i];\n    const key = frame.frame.image ?? '';\n\n    if (!reverseFrameToImageIndex[key]) {\n      reverseFrameToImageIndex[key] = [];\n    }\n    reverseFrameToImageIndex[key].push(frame);\n  }\n\n  for (let i = 0; i < sortedFrames.length; i++) {\n    const imageFrames = reverseFrameToImageIndex[sortedFrames[i]?.frame?.image ?? ''];\n\n    for (let j = 0; j < imageFrames.length; j++) {\n      colors.set(\n        imageFrames[j].key,\n        colorBucket(\n          Math.floor((255 * i) / sortedFrames.length) / 256,\n          imageFrames[j].frame\n        )\n      );\n    }\n  }\n\n  return colors;\n};\n\nexport const makeColorMapBySystemVsApplication = (\n  frames: ReadonlyArray<FlamegraphFrame>,\n  colorBucket: FlamegraphTheme['COLORS']['COLOR_BUCKET']\n): Map<FlamegraphFrame['frame']['key'], ColorChannels> => {\n  const colors = new Map<FlamegraphFrame['key'], ColorChannels>();\n\n  for (let i = 0; i < frames.length; i++) {\n    const frame = frames[i];\n\n    if (frame.frame.is_application) {\n      colors.set(frame.key, colorBucket(0.7, frame.frame));\n      continue;\n    }\n\n    colors.set(frame.key, colorBucket(0.09, frame.frame));\n  }\n\n  return colors;\n};\n\nexport const makeColorMapByFrequency = (\n  frames: ReadonlyArray<FlamegraphFrame>,\n  colorBucket: FlamegraphTheme['COLORS']['COLOR_BUCKET']\n): Map<FlamegraphFrame['frame']['key'], ColorChannels> => {\n  let max = 0;\n\n  const countMap = new Map<FlamegraphFrame['frame']['key'], number>();\n  const colors = new Map<FlamegraphFrame['key'], ColorChannels>();\n\n  for (let i = 0; i < frames.length; i++) {\n    const frame = frames[i];\n    const key = frame.frame.name + frame.frame.image;\n\n    if (!countMap.has(key)) {\n      countMap.set(key, 0);\n    }\n\n    const previousCount = countMap.get(key)!;\n\n    countMap.set(key, previousCount + 1);\n    max = Math.max(max, previousCount + 1);\n  }\n\n  for (let i = 0; i < frames.length; i++) {\n    const key = frames[i].frame.name + frames[i].frame.image;\n    const count = countMap.get(key)!;\n    const [r, g, b] = colorBucket(0.7, frames[i].frame);\n    const color: ColorChannels = [r, g, b, Math.max(count / max, 0.1)];\n\n    colors.set(frames[i].key, color);\n  }\n\n  return colors;\n};\n","import {FlamegraphFrame} from 'sentry/utils/profiling/flamegraphFrame';\n\n// Utility fn to filter a tree.\n// The filtering is done in two steps - the first step marks nodes\n// that should be kept in the tree. The second step iterates over all of the\n// nodes that should be kept in the tree and finds their new parent nodes\n// by walking up the node.parent reference chain and checking if the parent\n// is in the set of nodes that should be kept.\n\n// A tiny but important implementation details is that we only need to find every node's\n// first new parent and not all of the parents. That is because we rely on insertion order\n// of nodesToKeep (dfs). This effectively means that when a node is marked as kept, all of\n// it's parent nodes have already been considered and exist in our new tree.\nexport function filterFlamegraphTree(\n  roots: FlamegraphFrame[],\n  skipFn: (frame: FlamegraphFrame) => boolean\n): FlamegraphFrame[] {\n  const stack: FlamegraphFrame[] = [];\n  const nodesToKeep = new Map<FlamegraphFrame['frame']['key'], FlamegraphFrame>();\n\n  // dfs to find nodes we want to keep.\n  // Iteration order is important because we want to keep the order of the\n  // original tree which allows us to rebuild it starting from the root.\n  for (const root of roots) {\n    stack.push(root);\n\n    while (stack.length > 0) {\n      const node = stack.pop();\n\n      if (!node) {\n        continue;\n      }\n\n      // If this is not a skippable node, add it to the set\n      if (!skipFn(node)) {\n        nodesToKeep.set(node.key, node);\n      }\n\n      // enqueue children\n      for (let i = 0; i < node.children.length; i++) {\n        stack.push(node.children[node.children.length - i - 1]);\n      }\n    }\n  }\n\n  // Rebuild the tree by iterating over the nodes we want to keep and\n  // finding a new parent for each node.\n  const tree: FlamegraphFrame[] = [];\n  const nodes = new Map<FlamegraphFrame['frame']['key'], FlamegraphFrame>();\n  for (const node of nodesToKeep.values()) {\n    // We clear the children when we create a copy so we dont carry\n    // over nodes that were not meant to be kept.\n    const cpy = {...node, children: []};\n\n    // Find the first parent that we are not supposed to skip\n    let parent = node.parent;\n    // While we have a parent and while that parent is not a node we want to keep\n    while (parent) {\n      if (nodesToKeep.has(parent.key)) {\n        // We found a base, break\n        break;\n      }\n\n      parent = parent.parent;\n    }\n\n    // Reassign parent. We can guarantee that parent is not null because\n    // we are iterating over values in insertion order (maps guarantee this)\n    cpy.parent = (parent ? nodes.get(parent.key) : null) || null;\n    if (cpy.parent) {\n      cpy.parent.children.push(cpy);\n    } else {\n      // If the frame's root does not exist or it may have\n      // been filtered out, push the node to the roots\n      tree.push(cpy);\n    }\n\n    // Set the new node in the map\n    nodes.set(cpy.key, cpy);\n  }\n\n  return tree;\n}\n","import {lastOfArray} from 'sentry/utils';\nimport {FlamegraphFrame} from 'sentry/utils/profiling/flamegraphFrame';\n\nimport {Rect} from './gl/utils';\nimport {Profile} from './profile/profile';\nimport {makeFormatter, makeTimelineFormatter} from './units/units';\nimport {CallTreeNode} from './callTreeNode';\nimport {Frame} from './frame';\n\n// Intermediary flamegraph data structure for rendering a profile. Constructs a list of frames from a profile\n// and appends them to a virtual root. Taken mostly from speedscope with a few modifications. This should get\n// removed as we port to our own format for profiles. The general idea is to iterate over profiles while\n// keeping an intermediary stack so as to resemble the execution of the program.\nexport class Flamegraph {\n  profile: Profile;\n  frames: FlamegraphFrame[] = [];\n\n  profileIndex: number;\n\n  inverted?: boolean = false;\n  leftHeavy?: boolean = false;\n\n  depth = 0;\n  configSpace: Rect = new Rect(0, 0, 0, 0);\n  root: FlamegraphFrame = {\n    key: -1,\n    parent: null,\n    frame: new Frame({...Frame.Root}),\n    node: new CallTreeNode(new Frame({...Frame.Root}), null),\n    depth: -1,\n    start: 0,\n    end: 0,\n    children: [],\n  };\n\n  formatter: (value: number) => string;\n  timelineFormatter: (value: number) => string;\n\n  static Empty(): Flamegraph {\n    return new Flamegraph(Profile.Empty(), 0, {\n      inverted: false,\n      leftHeavy: false,\n    });\n  }\n\n  static From(from: Flamegraph, {inverted = false, leftHeavy = false}): Flamegraph {\n    return new Flamegraph(from.profile, from.profileIndex, {inverted, leftHeavy});\n  }\n\n  constructor(\n    profile: Profile,\n    profileIndex: number,\n    {\n      inverted = false,\n      leftHeavy = false,\n      configSpace,\n    }: {configSpace?: Rect; inverted?: boolean; leftHeavy?: boolean} = {}\n  ) {\n    this.inverted = inverted;\n    this.leftHeavy = leftHeavy;\n\n    // @TODO check if we can get rid of this profile reference\n    this.profile = profile;\n    this.profileIndex = profileIndex;\n\n    // If a custom config space is provided, use it and draw the chart in it\n    this.frames = leftHeavy\n      ? this.buildLeftHeavyGraph(profile, configSpace ? configSpace.x : 0)\n      : this.buildCallOrderGraph(profile, configSpace ? configSpace.x : 0);\n\n    this.formatter = makeFormatter(profile.unit);\n    this.timelineFormatter = makeTimelineFormatter(profile.unit);\n\n    // If the profile duration is 0, set the flamegraph duration\n    // to 1 second so we can render a placeholder grid\n    this.configSpace = new Rect(\n      0,\n      0,\n      this.profile.unit === 'nanoseconds'\n        ? 1e9\n        : this.profile.unit === 'microseconds'\n        ? 1e6\n        : this.profile.unit === 'milliseconds'\n        ? 1e3\n        : 1,\n      this.depth\n    );\n\n    if (this.profile.duration) {\n      this.configSpace = new Rect(\n        configSpace ? configSpace.x : this.profile.startedAt,\n        0,\n        configSpace ? configSpace.width : this.profile.duration,\n        this.depth\n      );\n    }\n\n    const weight = this.root.children.reduce(\n      (acc, frame) => acc + frame.node.totalWeight,\n      0\n    );\n\n    this.root.node.addToTotalWeight(weight);\n    this.root.end = this.root.start + weight;\n    this.root.frame.addToTotalWeight(weight);\n  }\n\n  buildCallOrderGraph(profile: Profile, offset: number): FlamegraphFrame[] {\n    const frames: FlamegraphFrame[] = [];\n    const stack: FlamegraphFrame[] = [];\n    let idx = 0;\n\n    const openFrame = (node: CallTreeNode, value: number) => {\n      const parent = lastOfArray(stack);\n\n      const frame: FlamegraphFrame = {\n        key: idx,\n        frame: node.frame,\n        node,\n        parent,\n        children: [],\n        depth: 0,\n        start: offset + value,\n        end: offset + value,\n      };\n\n      if (parent) {\n        parent.children.push(frame);\n      } else {\n        this.root.children.push(frame);\n      }\n\n      stack.push(frame);\n      idx++;\n    };\n\n    const closeFrame = (_: CallTreeNode, value: number) => {\n      const stackTop = stack.pop();\n\n      if (!stackTop) {\n        // This is unreachable because the profile importing logic already checks this\n        throw new Error('Unbalanced stack');\n      }\n\n      stackTop.end = offset + value;\n      stackTop.depth = stack.length;\n\n      if (stackTop.end - stackTop.start === 0) {\n        return;\n      }\n\n      frames.unshift(stackTop);\n      this.depth = Math.max(stackTop.depth, this.depth);\n    };\n\n    profile.forEach(openFrame, closeFrame);\n    return frames;\n  }\n\n  buildLeftHeavyGraph(profile: Profile, offset: number): FlamegraphFrame[] {\n    const frames: FlamegraphFrame[] = [];\n    const stack: FlamegraphFrame[] = [];\n\n    const sortTree = (node: CallTreeNode) => {\n      node.children.sort((a, b) => -(a.totalWeight - b.totalWeight));\n      node.children.forEach(c => sortTree(c));\n    };\n\n    sortTree(profile.appendOrderTree);\n\n    const virtualRoot: FlamegraphFrame = {\n      key: -1,\n      frame: CallTreeNode.Root.frame,\n      node: CallTreeNode.Root,\n      parent: null,\n      children: [],\n      depth: 0,\n      start: 0,\n      end: 0,\n    };\n\n    this.root = virtualRoot;\n    let idx = 0;\n\n    const openFrame = (node: CallTreeNode, value: number) => {\n      const parent = lastOfArray(stack);\n      const frame: FlamegraphFrame = {\n        key: idx,\n        frame: node.frame,\n        node,\n        parent,\n        children: [],\n        depth: 0,\n        start: offset + value,\n        end: offset + value,\n      };\n\n      if (parent) {\n        parent.children.push(frame);\n      } else {\n        this.root.children.push(frame);\n      }\n\n      stack.push(frame);\n      idx++;\n    };\n\n    const closeFrame = (_node: CallTreeNode, value: number) => {\n      const stackTop = stack.pop();\n\n      if (!stackTop) {\n        throw new Error('Unbalanced stack');\n      }\n\n      stackTop.end = offset + value;\n      stackTop.depth = stack.length;\n\n      // Dont draw 0 width frames\n      if (stackTop.end - stackTop.start === 0) {\n        return;\n      }\n      frames.unshift(stackTop);\n      this.depth = Math.max(stackTop.depth, this.depth);\n    };\n\n    function visit(node: CallTreeNode, start: number) {\n      if (!node.frame.isRoot()) {\n        openFrame(node, start);\n      }\n\n      let childTime = 0;\n\n      node.children.forEach(child => {\n        visit(child, start + childTime);\n        childTime += child.totalWeight;\n      });\n\n      if (!node.frame.isRoot()) {\n        closeFrame(node, start + node.totalWeight);\n      }\n    }\n    visit(profile.appendOrderTree, 0);\n    return frames;\n  }\n\n  setConfigSpace(configSpace: Rect): Flamegraph {\n    this.configSpace = configSpace;\n    return this;\n  }\n}\n","export type FlamegraphColorCodings = [\n  'by symbol name',\n  'by system / application',\n  'by library',\n  'by recursion',\n  'by frequency'\n];\n\nexport type FlamegraphSorting = ['left heavy', 'call order'];\nexport type FlamegraphViewOptions = ['top down', 'bottom up'];\nexport type FlamegraphAxisOptions = ['standalone', 'transaction'];\n\nexport interface FlamegraphPreferences {\n  colorCoding: FlamegraphColorCodings[number];\n  layout: 'table right' | 'table bottom' | 'table left';\n  sorting: FlamegraphSorting[number];\n  view: FlamegraphViewOptions[number];\n  xAxis: FlamegraphAxisOptions[number];\n}\n\ntype FlamegraphPreferencesAction =\n  | {payload: FlamegraphPreferences['colorCoding']; type: 'set color coding'}\n  | {payload: FlamegraphPreferences['sorting']; type: 'set sorting'}\n  | {payload: FlamegraphPreferences['view']; type: 'set view'}\n  | {payload: FlamegraphPreferences['layout']; type: 'set layout'}\n  | {\n      payload: FlamegraphPreferences['xAxis'];\n      type: 'set xAxis';\n    };\n\nexport function flamegraphPreferencesReducer(\n  state: FlamegraphPreferences,\n  action: FlamegraphPreferencesAction\n): FlamegraphPreferences {\n  switch (action.type) {\n    case 'set layout': {\n      return {\n        ...state,\n        layout: action.payload,\n      };\n    }\n    case 'set color coding': {\n      return {\n        ...state,\n        colorCoding: action.payload,\n      };\n    }\n    case 'set sorting': {\n      return {\n        ...state,\n        sorting: action.payload,\n      };\n    }\n    case 'set view': {\n      return {\n        ...state,\n        view: action.payload,\n      };\n    }\n    case 'set xAxis': {\n      return {...state, xAxis: action.payload};\n    }\n    default: {\n      return state;\n    }\n  }\n}\n","import {FlamegraphFrame} from 'sentry/utils/profiling/flamegraphFrame';\n\ntype SetFocusFrame = {\n  payload: {\n    name: string;\n    package: string;\n  };\n  type: 'set highlight frame name';\n};\n\ntype SetProfilesThreadId = {\n  payload: number;\n  type: 'set thread id';\n};\n\ntype SetRootNode = {\n  payload: FlamegraphFrame | null;\n  type: 'set selected root';\n};\n\ntype FlamegraphProfilesAction = SetFocusFrame | SetProfilesThreadId | SetRootNode;\n\nexport type FlamegraphProfiles = {\n  focusFrame: SetFocusFrame['payload'] | null;\n  selectedRoot: FlamegraphFrame | null;\n  threadId: number | null;\n};\n\nexport function flamegraphProfilesReducer(\n  state: FlamegraphProfiles,\n  action: FlamegraphProfilesAction\n): FlamegraphProfiles {\n  switch (action.type) {\n    case 'set highlight frame name': {\n      return {\n        ...state,\n        focusFrame: action.payload,\n      };\n    }\n    case 'set selected root': {\n      return {...state, selectedRoot: action.payload};\n    }\n    case 'set thread id': {\n      // When the profile index changes, we want to drop the selected and hovered nodes\n      return {\n        ...state,\n        selectedRoot: null,\n        threadId: action.payload,\n      };\n    }\n    default: {\n      return state;\n    }\n  }\n}\n","import type Fuse from 'fuse.js';\n\nimport {FlamegraphFrame} from 'sentry/utils/profiling/flamegraphFrame';\n\nexport type FlamegraphSearchResult = {\n  frame: FlamegraphFrame;\n  match: Fuse.RangeTuple;\n};\n\nexport type FlamegraphSearch = {\n  index: number | null;\n  query: string;\n  results: Map<string, FlamegraphSearchResult>;\n};\n\ntype ClearFlamegraphSearchAction = {\n  type: 'clear search';\n};\n\ntype SetFlamegraphResultsAction = {\n  payload: {\n    query: string;\n    results: FlamegraphSearch['results'];\n  };\n  type: 'set results';\n};\n\ntype FlamegraphSearchArrowNavigationAction = {\n  payload: number;\n  type: 'set search index position';\n};\n\ntype FlamegraphSearchAction =\n  | ClearFlamegraphSearchAction\n  | FlamegraphSearchArrowNavigationAction\n  | SetFlamegraphResultsAction;\n\nexport function flamegraphSearchReducer(\n  state: FlamegraphSearch,\n  action: FlamegraphSearchAction\n): FlamegraphSearch {\n  switch (action.type) {\n    case 'clear search': {\n      return {\n        ...state,\n        query: '',\n        index: null,\n        results: new Map(),\n      };\n    }\n    case 'set results': {\n      return {...state, ...action.payload};\n    }\n    case 'set search index position': {\n      return {...state, index: action.payload};\n    }\n    default: {\n      return state;\n    }\n  }\n}\n","import {Rect} from 'sentry/utils/profiling/gl/utils';\n\ntype FlamegraphZoomPositionAction = {\n  payload: Rect;\n  type: 'checkpoint';\n};\n\ntype FlamegraphZoomPosition = {\n  view: Rect;\n};\n\nexport function flamegraphZoomPositionReducer(\n  state: FlamegraphZoomPosition,\n  action: FlamegraphZoomPositionAction\n): FlamegraphZoomPosition {\n  switch (action.type) {\n    case 'checkpoint': {\n      return {view: Rect.From(action.payload)};\n    }\n    default: {\n      return state;\n    }\n  }\n}\n","import {createContext, useEffect} from 'react';\nimport {browserHistory} from 'react-router';\nimport {Query} from 'history';\n\nimport {DeepPartial} from 'sentry/types/utils';\nimport {defined} from 'sentry/utils';\nimport {Flamegraph} from 'sentry/utils/profiling/flamegraph';\nimport {FlamegraphFrame} from 'sentry/utils/profiling/flamegraphFrame';\nimport {Rect} from 'sentry/utils/profiling/gl/utils';\nimport {makeCombinedReducers} from 'sentry/utils/useCombinedReducer';\nimport {useLocalStorageState} from 'sentry/utils/useLocalStorageState';\nimport {useLocation} from 'sentry/utils/useLocation';\nimport {\n  UndoableReducer,\n  UndoableReducerAction,\n  useUndoableReducer,\n} from 'sentry/utils/useUndoableReducer';\nimport {useProfileGroup} from 'sentry/views/profiling/profileGroupProvider';\n\nimport {useFlamegraphStateValue} from '../useFlamegraphState';\n\nimport {\n  FlamegraphAxisOptions,\n  FlamegraphColorCodings,\n  flamegraphPreferencesReducer,\n  FlamegraphSorting,\n  FlamegraphViewOptions,\n} from './flamegraphPreferences';\nimport {FlamegraphProfiles, flamegraphProfilesReducer} from './flamegraphProfiles';\nimport {flamegraphSearchReducer} from './flamegraphSearch';\nimport {flamegraphZoomPositionReducer} from './flamegraphZoomPosition';\n\n// Intersect the types so we can properly guard\ntype PossibleQuery =\n  | Query\n  | (Pick<FlamegraphState['preferences'], 'colorCoding' | 'sorting' | 'view' | 'xAxis'> &\n      Pick<FlamegraphState['search'], 'query'>);\n\nfunction isColorCoding(\n  value: PossibleQuery['colorCoding'] | FlamegraphState['preferences']['colorCoding']\n): value is FlamegraphState['preferences']['colorCoding'] {\n  const values: FlamegraphColorCodings = [\n    'by symbol name',\n    'by system / application',\n    'by library',\n    'by recursion',\n    'by frequency',\n  ];\n\n  return values.includes(value as any);\n}\n\nfunction isLayout(\n  value: PossibleQuery['colorCoding'] | FlamegraphState['preferences']['colorCoding']\n): value is FlamegraphState['preferences']['layout'] {\n  return value === 'table right' || value === 'table bottom' || value === 'table left';\n}\n\nfunction isSorting(\n  value: PossibleQuery['sorting'] | FlamegraphState['preferences']['sorting']\n): value is FlamegraphState['preferences']['sorting'] {\n  const values: FlamegraphSorting = ['left heavy', 'call order'];\n  return values.includes(value as any);\n}\n\nfunction isView(\n  value: PossibleQuery['view'] | FlamegraphState['preferences']['view']\n): value is FlamegraphState['preferences']['view'] {\n  const values: FlamegraphViewOptions = ['top down', 'bottom up'];\n  return values.includes(value as any);\n}\n\nfunction isXAxis(\n  value: PossibleQuery['xAxis'] | FlamegraphState['preferences']['xAxis']\n): value is FlamegraphState['preferences']['xAxis'] {\n  const values: FlamegraphAxisOptions = ['standalone', 'transaction'];\n  return values.includes(value as any);\n}\n\nexport function decodeFlamegraphStateFromQueryParams(\n  query: Query\n): DeepPartial<FlamegraphState> {\n  return {\n    profiles: {\n      focusFrame:\n        typeof query.frameName === 'string' && typeof query.framePackage === 'string'\n          ? {\n              name: query.frameName,\n              package: query.framePackage,\n            }\n          : null,\n      threadId:\n        typeof query.tid === 'string' && !isNaN(parseInt(query.tid, 10))\n          ? parseInt(query.tid, 10)\n          : null,\n    },\n    position: {view: Rect.decode(query.fov) ?? Rect.Empty()},\n    preferences: {\n      layout: isLayout(query.layout)\n        ? query.layout\n        : DEFAULT_FLAMEGRAPH_STATE.preferences.layout,\n      colorCoding: isColorCoding(query.colorCoding)\n        ? query.colorCoding\n        : DEFAULT_FLAMEGRAPH_STATE.preferences.colorCoding,\n      sorting: isSorting(query.sorting)\n        ? query.sorting\n        : DEFAULT_FLAMEGRAPH_STATE.preferences.sorting,\n      view: isView(query.view) ? query.view : DEFAULT_FLAMEGRAPH_STATE.preferences.view,\n      xAxis: isXAxis(query.xAxis)\n        ? query.xAxis\n        : DEFAULT_FLAMEGRAPH_STATE.preferences.xAxis,\n    },\n    search: {\n      query: typeof query.query === 'string' ? query.query : '',\n    },\n  };\n}\n\nexport function encodeFlamegraphStateToQueryParams(state: FlamegraphState) {\n  return {\n    colorCoding: state.preferences.colorCoding,\n    sorting: state.preferences.sorting,\n    view: state.preferences.view,\n    xAxis: state.preferences.xAxis,\n    query: state.search.query,\n    ...(state.position.view.isEmpty()\n      ? {fov: undefined}\n      : {fov: Rect.encode(state.position.view)}),\n    ...(typeof state.profiles.threadId === 'number'\n      ? {tid: state.profiles.threadId}\n      : {}),\n  };\n}\n\nexport const combinedReducers = makeCombinedReducers({\n  profiles: flamegraphProfilesReducer,\n  position: flamegraphZoomPositionReducer,\n  preferences: flamegraphPreferencesReducer,\n  search: flamegraphSearchReducer,\n});\n\nexport type FlamegraphState = React.ReducerState<FlamegraphStateReducer>['current'];\ntype FlamegraphAction = React.Dispatch<\n  UndoableReducerAction<React.ReducerAction<FlamegraphStateReducer>>\n>;\n\ntype FlamegraphStateReducer = UndoableReducer<typeof combinedReducers>;\n\nexport function FlamegraphStateQueryParamSync() {\n  const location = useLocation();\n  const state = useFlamegraphStateValue();\n\n  useEffect(() => {\n    browserHistory.replace({\n      ...location,\n      query: {\n        ...location.query,\n        ...encodeFlamegraphStateToQueryParams(state),\n      },\n    });\n    // We only want to sync the query params when the state changes\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [state]);\n\n  return null;\n}\n\nexport const FLAMEGRAPH_LOCALSTORAGE_PREFERENCES_KEY = 'flamegraph-preferences';\nexport function FlamegraphStateLocalStorageSync() {\n  const state = useFlamegraphStateValue();\n  const [_, setState] = useLocalStorageState<DeepPartial<FlamegraphState>>(\n    FLAMEGRAPH_LOCALSTORAGE_PREFERENCES_KEY,\n    {\n      preferences: {\n        layout: DEFAULT_FLAMEGRAPH_STATE.preferences.layout,\n      },\n    }\n  );\n\n  useEffect(() => {\n    setState({\n      preferences: {\n        layout: state.preferences.layout,\n      },\n    });\n    // We only want to sync the local storage when the state changes\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [state.preferences.layout]);\n\n  return null;\n}\n\nexport type FlamegraphStateContextValue = [\n  FlamegraphState,\n  FlamegraphAction,\n  {\n    nextState: FlamegraphState | undefined;\n    previousState: FlamegraphState | undefined;\n  }\n];\n\nexport const FlamegraphStateContext = createContext<FlamegraphStateContextValue | null>(\n  null\n);\ninterface FlamegraphStateProviderProps {\n  children: React.ReactNode;\n  initialState?: DeepPartial<FlamegraphState>;\n}\n\nexport const DEFAULT_FLAMEGRAPH_STATE: FlamegraphState = {\n  profiles: {\n    selectedRoot: null,\n    threadId: null,\n    focusFrame: null,\n  },\n  position: {\n    view: Rect.Empty(),\n  },\n  preferences: {\n    colorCoding: 'by symbol name',\n    sorting: 'call order',\n    view: 'top down',\n    xAxis: 'standalone',\n    layout: 'table bottom',\n  },\n  search: {\n    index: null,\n    results: new Map(),\n    query: '',\n  },\n};\n\nexport function FlamegraphStateProvider(\n  props: FlamegraphStateProviderProps\n): React.ReactElement {\n  const [profileGroup] = useProfileGroup();\n\n  const reducer = useUndoableReducer(combinedReducers, {\n    profiles: {\n      focusFrame:\n        props.initialState?.profiles?.focusFrame?.name &&\n        props.initialState?.profiles?.focusFrame?.package\n          ? {\n              name: props.initialState.profiles.focusFrame.name,\n              package: props.initialState.profiles.focusFrame.package,\n            }\n          : DEFAULT_FLAMEGRAPH_STATE.profiles.focusFrame,\n      selectedRoot: null,\n      threadId:\n        props.initialState?.profiles?.threadId ??\n        DEFAULT_FLAMEGRAPH_STATE.profiles.threadId,\n    },\n    position: {\n      view: (props.initialState?.position?.view ??\n        DEFAULT_FLAMEGRAPH_STATE.position.view) as Rect,\n    },\n    preferences: {\n      layout:\n        props.initialState?.preferences?.layout ??\n        DEFAULT_FLAMEGRAPH_STATE.preferences.layout,\n      colorCoding:\n        props.initialState?.preferences?.colorCoding ??\n        DEFAULT_FLAMEGRAPH_STATE.preferences.colorCoding,\n      sorting:\n        props.initialState?.preferences?.sorting ??\n        DEFAULT_FLAMEGRAPH_STATE.preferences.sorting,\n      view:\n        props.initialState?.preferences?.view ??\n        DEFAULT_FLAMEGRAPH_STATE.preferences.view,\n      xAxis:\n        props.initialState?.preferences?.xAxis ??\n        DEFAULT_FLAMEGRAPH_STATE.preferences.xAxis,\n    },\n    search: {\n      ...DEFAULT_FLAMEGRAPH_STATE.search,\n      query: props.initialState?.search?.query ?? DEFAULT_FLAMEGRAPH_STATE.search.query,\n    },\n  });\n\n  useEffect(() => {\n    if (reducer[0].profiles.threadId === null && profileGroup.type === 'resolved') {\n      /**\n       * When a focus frame is specified, we need to override the active thread.\n       * We look at each thread and pick the one that scores the highest.\n       */\n      if (defined(reducer[0].profiles.focusFrame)) {\n        const candidate = profileGroup.data.profiles.reduce(\n          (prevCandidate, profile) => {\n            const flamegraph = new Flamegraph(profile, profile.threadId, {\n              inverted: false,\n              leftHeavy: false,\n              configSpace: undefined,\n            });\n\n            const score = scoreFlamegraph(flamegraph, reducer[0].profiles.focusFrame);\n\n            return score <= prevCandidate.score\n              ? prevCandidate\n              : {\n                  score,\n                  threadId: profile.threadId,\n                };\n          },\n          {score: 0, threadId: null} as Candidate\n        );\n\n        if (defined(candidate.threadId)) {\n          reducer[1]({type: 'set thread id', payload: candidate.threadId});\n          return;\n        }\n      }\n\n      if (typeof profileGroup.data.activeProfileIndex === 'number') {\n        const threadID =\n          profileGroup.data.profiles[profileGroup.data.activeProfileIndex].threadId;\n\n        if (threadID) {\n          reducer[1]({\n            type: 'set thread id',\n            payload: threadID,\n          });\n        }\n      }\n    }\n  }, [props.initialState?.profiles?.threadId, profileGroup, reducer]);\n\n  return (\n    <FlamegraphStateContext.Provider value={reducer}>\n      {props.children}\n    </FlamegraphStateContext.Provider>\n  );\n}\n\ntype Candidate = {\n  score: number;\n  threadId: number | null;\n};\n\nfunction scoreFlamegraph(\n  flamegraph: Flamegraph,\n  focusFrame: FlamegraphProfiles['focusFrame']\n): number {\n  if (!defined(focusFrame)) {\n    return 0;\n  }\n\n  let score = 0;\n\n  const frames: FlamegraphFrame[] = [...flamegraph.root.children];\n  while (frames.length > 0) {\n    const frame = frames.pop()!;\n    if (\n      frame.frame.name === focusFrame.name &&\n      frame.frame.image === focusFrame.package\n    ) {\n      score += frame.node.totalWeight;\n    }\n\n    for (let i = 0; i < frame.children.length; i++) {\n      frames.push(frame.children[i]);\n    }\n  }\n\n  return score;\n}\n","import {\n  makeColorBucketTheme,\n  makeColorMap,\n  makeStackToColor,\n} from 'sentry/utils/profiling/colors/utils';\nimport {FlamegraphFrame} from 'sentry/utils/profiling/flamegraphFrame';\nimport {Frame} from 'sentry/utils/profiling/frame';\nimport {darkTheme, lightTheme} from 'sentry/utils/theme';\n\nconst MONOSPACE_FONT = `ui-monospace, Menlo, Monaco, 'Cascadia Mono', 'Segoe UI Mono', 'Roboto Mono',\n'Oxygen Mono', 'Ubuntu Monospace', 'Source Code Pro', 'Fira Mono', 'Droid Sans Mono',\n'Courier New', monospace`;\n\nconst FRAME_FONT = lightTheme.text.familyMono;\n\n// Luma chroma hue settings\nexport interface LCH {\n  C_0: number;\n  C_d: number;\n  L_0: number;\n  L_d: number;\n}\n// Color can be rgb or rgba. I want to probably eliminate rgb and just use rgba, but we would be allocating 25% more memory,\n// and I'm not sure about the impact we'd need. There is a tradeoff between memory and runtime performance checks that I'll need to evaluate at some point.\nexport type ColorChannels = [number, number, number] | [number, number, number, number];\n\nexport interface FlamegraphTheme {\n  // @TODO, most colors are defined as strings, which is a mistake as we loose a lot of functionality and impose constraints.\n  // They should instead be defined as arrays of numbers so we can use them with glsl and avoid unnecessary parsing\n  COLORS: {\n    BAR_LABEL_FONT_COLOR: string;\n    COLOR_BUCKET: (t: number, frame?: Frame) => ColorChannels;\n    COLOR_MAP: (\n      frames: ReadonlyArray<FlamegraphFrame>,\n      colorBucket: FlamegraphTheme['COLORS']['COLOR_BUCKET'],\n      sortByKey?: (a: FlamegraphFrame, b: FlamegraphFrame) => number\n    ) => Map<FlamegraphFrame['frame']['key'], ColorChannels>;\n    CURSOR_CROSSHAIR: string;\n    DIFFERENTIAL_DECREASE: ColorChannels;\n    DIFFERENTIAL_INCREASE: ColorChannels;\n    FOCUSED_FRAME_BORDER_COLOR: string;\n    FRAME_FALLBACK_COLOR: [number, number, number, number];\n    GRID_FRAME_BACKGROUND_COLOR: string;\n    GRID_LINE_COLOR: string;\n    HIGHLIGHTED_LABEL_COLOR: ColorChannels;\n    HOVERED_FRAME_BORDER_COLOR: string;\n    LABEL_FONT_COLOR: string;\n    MINIMAP_POSITION_OVERLAY_BORDER_COLOR: string;\n    MINIMAP_POSITION_OVERLAY_COLOR: string;\n    REQUEST_2XX_RESPONSE: string;\n    REQUEST_4XX_RESPONSE: string;\n\n    REQUEST_DNS_TIME: string;\n    REQUEST_SSL_TIME: string;\n    REQUEST_TCP_TIME: string;\n    // Nice color picker for GLSL colors - https://keiwando.com/color-picker/\n    REQUEST_WAIT_TIME: string;\n    SAMPLE_TICK_COLOR: ColorChannels;\n    SEARCH_RESULT_FRAME_COLOR: string;\n    SELECTED_FRAME_BORDER_COLOR: string;\n    SPAN_FRAME_BACKGROUND: string;\n    SPAN_FRAME_BORDER: string;\n    STACK_TO_COLOR: (\n      frames: ReadonlyArray<FlamegraphFrame>,\n      colorMapFn: FlamegraphTheme['COLORS']['COLOR_MAP'],\n      colorBucketFn: FlamegraphTheme['COLORS']['COLOR_BUCKET']\n    ) => {\n      colorBuffer: Array<number>;\n      colorMap: Map<Frame['key'], ColorChannels>;\n    };\n  };\n  CONFIG: {\n    HIGHLIGHT_RECURSION: boolean;\n  };\n  FONTS: {\n    FONT: string;\n    FRAME_FONT: string;\n  };\n  SIZES: {\n    BAR_FONT_SIZE: number;\n    BAR_HEIGHT: number;\n    BAR_PADDING: number;\n    FLAMEGRAPH_DEPTH_OFFSET: number;\n    FOCUSED_FRAME_BORDER_WIDTH: number;\n    FRAME_BORDER_WIDTH: number;\n    GRID_LINE_WIDTH: number;\n    HOVERED_FRAME_BORDER_WIDTH: number;\n    INTERNAL_SAMPLE_TICK_LINE_WIDTH: number;\n    LABEL_FONT_PADDING: number;\n    LABEL_FONT_SIZE: number;\n    MINIMAP_HEIGHT: number;\n    MINIMAP_POSITION_OVERLAY_BORDER_WIDTH: number;\n    REQUEST_BAR_HEIGHT: number;\n    REQUEST_DEPTH_OFFSET: number;\n    REQUEST_FONT_SIZE: number;\n    // Request\n    REQUEST_TAIL_HEIGHT: number;\n\n    // Spans\n    SPANS_BAR_HEIGHT: number;\n    SPANS_DEPTH_OFFSET: number;\n    SPANS_FONT_SIZE: number;\n    TIMELINE_HEIGHT: number;\n    TOOLTIP_FONT_SIZE: number;\n  };\n}\n\n// Luma chroma hue settings for light theme\nexport const LCH_LIGHT = {\n  C_0: 0.25,\n  C_d: 0.2,\n  L_0: 0.8,\n  L_d: 0.15,\n};\n\n// Luma chroma hue settings for dark theme\nexport const LCH_DARK = {\n  C_0: 0.2,\n  C_d: 0.1,\n  L_0: 0.2,\n  L_d: 0.1,\n};\n\nexport const LightFlamegraphTheme: FlamegraphTheme = {\n  CONFIG: {\n    HIGHLIGHT_RECURSION: false,\n  },\n  SIZES: {\n    BAR_FONT_SIZE: 11,\n    BAR_HEIGHT: 20,\n    BAR_PADDING: 4,\n    FLAMEGRAPH_DEPTH_OFFSET: 12,\n    FOCUSED_FRAME_BORDER_WIDTH: 2,\n    FRAME_BORDER_WIDTH: 2,\n    GRID_LINE_WIDTH: 2,\n    HOVERED_FRAME_BORDER_WIDTH: 1,\n    INTERNAL_SAMPLE_TICK_LINE_WIDTH: 1,\n    LABEL_FONT_PADDING: 6,\n    LABEL_FONT_SIZE: 10,\n    MINIMAP_HEIGHT: 100,\n    MINIMAP_POSITION_OVERLAY_BORDER_WIDTH: 2,\n    REQUEST_BAR_HEIGHT: 14,\n    REQUEST_DEPTH_OFFSET: 4,\n    REQUEST_FONT_SIZE: 10,\n    REQUEST_TAIL_HEIGHT: 8,\n    SPANS_BAR_HEIGHT: 14,\n    SPANS_DEPTH_OFFSET: 4,\n    SPANS_FONT_SIZE: 10,\n    TIMELINE_HEIGHT: 20,\n    TOOLTIP_FONT_SIZE: 12,\n  },\n  COLORS: {\n    BAR_LABEL_FONT_COLOR: '#000',\n    COLOR_BUCKET: makeColorBucketTheme(LCH_LIGHT),\n    COLOR_MAP: makeColorMap,\n    CURSOR_CROSSHAIR: '#bbbbbb',\n    DIFFERENTIAL_DECREASE: [0.309, 0.2058, 0.98],\n    DIFFERENTIAL_INCREASE: [0.98, 0.2058, 0.4381],\n    FOCUSED_FRAME_BORDER_COLOR: lightTheme.focus,\n    FRAME_FALLBACK_COLOR: [0, 0, 0, 0.035],\n    GRID_FRAME_BACKGROUND_COLOR: 'rgba(255, 255, 255, 0.8)',\n    GRID_LINE_COLOR: '#e5e7eb',\n    HIGHLIGHTED_LABEL_COLOR: [255, 255, 0],\n    HOVERED_FRAME_BORDER_COLOR: 'rgba(0, 0, 0, 0.8)',\n    LABEL_FONT_COLOR: '#1f233a',\n    MINIMAP_POSITION_OVERLAY_BORDER_COLOR: 'rgba(0,0,0, 0.2)',\n    MINIMAP_POSITION_OVERLAY_COLOR: 'rgba(0,0,0,0.1)',\n    REQUEST_2XX_RESPONSE: 'rgba(218, 231, 209, 1)',\n    REQUEST_4XX_RESPONSE: 'rgba(255,96, 96, 1)',\n    REQUEST_DNS_TIME: `rgba(57, 146, 152, 1)`,\n    REQUEST_SSL_TIME: `rgba(207,84,218, 1)`,\n    REQUEST_TCP_TIME: `rgba(242, 146,57,1)`,\n    REQUEST_WAIT_TIME: `rgba(253,252,224, 1)`,\n    SAMPLE_TICK_COLOR: [255, 0, 0, 0.5],\n    SEARCH_RESULT_FRAME_COLOR: 'vec4(0.99, 0.70, 0.35, 1.0)',\n    SELECTED_FRAME_BORDER_COLOR: lightTheme.blue400,\n    SPAN_FRAME_BACKGROUND: 'rgba(231, 231, 231, 0.5)',\n    SPAN_FRAME_BORDER: 'rgba(200, 200, 200, 1)',\n    STACK_TO_COLOR: makeStackToColor([0, 0, 0, 0.035]),\n  },\n  FONTS: {\n    FONT: MONOSPACE_FONT,\n    FRAME_FONT,\n  },\n};\n\nexport const DarkFlamegraphTheme: FlamegraphTheme = {\n  CONFIG: {\n    HIGHLIGHT_RECURSION: false,\n  },\n  SIZES: {\n    BAR_FONT_SIZE: 11,\n    BAR_HEIGHT: 20,\n    BAR_PADDING: 4,\n    FLAMEGRAPH_DEPTH_OFFSET: 12,\n    FOCUSED_FRAME_BORDER_WIDTH: 1,\n    FRAME_BORDER_WIDTH: 2,\n    GRID_LINE_WIDTH: 2,\n    HOVERED_FRAME_BORDER_WIDTH: 1,\n    INTERNAL_SAMPLE_TICK_LINE_WIDTH: 1,\n    LABEL_FONT_PADDING: 6,\n    LABEL_FONT_SIZE: 10,\n    MINIMAP_HEIGHT: 100,\n    MINIMAP_POSITION_OVERLAY_BORDER_WIDTH: 2,\n    REQUEST_BAR_HEIGHT: 14,\n    REQUEST_DEPTH_OFFSET: 4,\n    REQUEST_FONT_SIZE: 10,\n    REQUEST_TAIL_HEIGHT: 8,\n    SPANS_BAR_HEIGHT: 14,\n    SPANS_DEPTH_OFFSET: 4,\n    SPANS_FONT_SIZE: 10,\n    TIMELINE_HEIGHT: 20,\n    TOOLTIP_FONT_SIZE: 12,\n  },\n  COLORS: {\n    BAR_LABEL_FONT_COLOR: 'rgb(255 255 255 / 80%)',\n    COLOR_BUCKET: makeColorBucketTheme(LCH_DARK),\n    COLOR_MAP: makeColorMap,\n    CURSOR_CROSSHAIR: '#828285',\n    DIFFERENTIAL_DECREASE: [0.309, 0.2058, 0.98],\n    DIFFERENTIAL_INCREASE: [0.98, 0.2058, 0.4381],\n    FOCUSED_FRAME_BORDER_COLOR: darkTheme.focus,\n    FRAME_FALLBACK_COLOR: [1, 1, 1, 0.1],\n    GRID_FRAME_BACKGROUND_COLOR: 'rgba(0, 0, 0, 0.4)',\n    GRID_LINE_COLOR: '#222227',\n    HIGHLIGHTED_LABEL_COLOR: [255, 255, 0],\n    HOVERED_FRAME_BORDER_COLOR: 'rgba(255, 255, 255, 0.8)',\n    LABEL_FONT_COLOR: 'rgba(255, 255, 255, 0.8)',\n    MINIMAP_POSITION_OVERLAY_BORDER_COLOR: 'rgba(255,255,255, 0.2)',\n    MINIMAP_POSITION_OVERLAY_COLOR: 'rgba(255,255,255,0.1)',\n    REQUEST_2XX_RESPONSE: 'rgba(218, 231, 209, 1)',\n    REQUEST_4XX_RESPONSE: 'rgba(255,96, 96, 1)',\n    REQUEST_DNS_TIME: `rgba(57, 146, 152, 1)`,\n    REQUEST_SSL_TIME: `rgba(207,84,218, 1)`,\n    REQUEST_TCP_TIME: `rgba(242, 146,57,1)`,\n    REQUEST_WAIT_TIME: `rgba(253,252,224, 1)`,\n    SAMPLE_TICK_COLOR: [255, 0, 0, 0.5],\n    SEARCH_RESULT_FRAME_COLOR: 'vec4(0.99, 0.70, 0.35, 0.7)',\n    SELECTED_FRAME_BORDER_COLOR: lightTheme.blue400,\n    SPAN_FRAME_BACKGROUND: 'rgba(232, 232, 232, 0.2)',\n    SPAN_FRAME_BORDER: '#57575b',\n    STACK_TO_COLOR: makeStackToColor([1, 1, 1, 0.1]),\n  },\n  FONTS: {\n    FONT: MONOSPACE_FONT,\n    FRAME_FONT,\n  },\n};\n","import {createContext, useMemo} from 'react';\n\nimport ConfigStore from 'sentry/stores/configStore';\nimport {useLegacyStore} from 'sentry/stores/useLegacyStore';\n\nimport {\n  makeColorMapByFrequency,\n  makeColorMapByImage,\n  makeColorMapByRecursion,\n  makeColorMapBySystemVsApplication,\n} from '../colors/utils';\n\nimport {\n  DarkFlamegraphTheme,\n  FlamegraphTheme,\n  LightFlamegraphTheme,\n} from './flamegraphTheme';\nimport {useFlamegraphPreferencesValue} from './useFlamegraphPreferences';\n\nexport const FlamegraphThemeContext = createContext<FlamegraphTheme | null>(null);\n\ninterface FlamegraphThemeProviderProps {\n  children: React.ReactNode;\n}\n\nfunction FlamegraphThemeProvider(\n  props: FlamegraphThemeProviderProps\n): React.ReactElement {\n  const {theme} = useLegacyStore(ConfigStore);\n  const flamegraphPreferences = useFlamegraphPreferencesValue();\n\n  const activeFlamegraphTheme = useMemo((): FlamegraphTheme => {\n    const base = theme === 'light' ? LightFlamegraphTheme : DarkFlamegraphTheme;\n\n    switch (flamegraphPreferences.colorCoding) {\n      case 'by symbol name': {\n        return base;\n      }\n      case 'by recursion': {\n        return {...base, COLORS: {...base.COLORS, COLOR_MAP: makeColorMapByRecursion}};\n      }\n      case 'by library': {\n        return {...base, COLORS: {...base.COLORS, COLOR_MAP: makeColorMapByImage}};\n      }\n      case 'by system / application': {\n        return {\n          ...base,\n          COLORS: {...base.COLORS, COLOR_MAP: makeColorMapBySystemVsApplication},\n        };\n      }\n      case 'by frequency': {\n        return {\n          ...base,\n          COLORS: {...base.COLORS, COLOR_MAP: makeColorMapByFrequency},\n        };\n      }\n      default: {\n        throw new TypeError(\n          `Unsupported flamegraph color coding ${flamegraphPreferences.colorCoding}`\n        );\n      }\n    }\n  }, [theme, flamegraphPreferences.colorCoding]);\n\n  return (\n    <FlamegraphThemeContext.Provider value={activeFlamegraphTheme}>\n      {props.children}\n    </FlamegraphThemeContext.Provider>\n  );\n}\n\nexport {FlamegraphThemeProvider};\n","import {useContext} from 'react';\n\nimport {\n  FlamegraphStateContext,\n  FlamegraphStateContextValue,\n} from './flamegraphStateProvider';\n\nexport function useFlamegraphPreferences(): [\n  FlamegraphStateContextValue[0]['preferences'],\n  FlamegraphStateContextValue[1]\n] {\n  const context = useContext(FlamegraphStateContext);\n\n  if (context === null) {\n    throw new Error('useFlamegraphPreferences called outside of FlamegraphStateProvider');\n  }\n\n  return [context[0].preferences, context[1]];\n}\n\nexport function useFlamegraphPreferencesValue(): FlamegraphStateContextValue[0]['preferences'] {\n  const context = useContext(FlamegraphStateContext);\n\n  if (context === null) {\n    throw new Error(\n      'useFlamegraphPreferencesValue called outside of FlamegraphStateProvider'\n    );\n  }\n\n  return context[0].preferences;\n}\n","import {useContext} from 'react';\n\nimport {\n  FlamegraphStateContext,\n  FlamegraphStateContextValue,\n} from './flamegraphStateProvider/index';\n\nexport function useFlamegraphProfiles(): [\n  FlamegraphStateContextValue[0]['profiles'],\n  FlamegraphStateContextValue[1]\n] {\n  const context = useContext(FlamegraphStateContext);\n\n  if (context === null) {\n    throw new Error('useFlamegraphProfiles called outside of FlamegraphStateProvider');\n  }\n\n  return [context[0].profiles, context[1]];\n}\n\nexport function useFlamegraphProfilesValue(): FlamegraphStateContextValue[0]['profiles'] {\n  const context = useContext(FlamegraphStateContext);\n\n  if (context === null) {\n    throw new Error('useFlamegraphProfiles called outside of FlamegraphStateProvider');\n  }\n\n  return context[0].profiles;\n}\n","import {useContext} from 'react';\n\nimport {\n  FlamegraphStateContext,\n  FlamegraphStateContextValue,\n} from './flamegraphStateProvider';\n\nexport function useFlamegraphSearch(): [\n  FlamegraphStateContextValue[0]['search'],\n  FlamegraphStateContextValue[1]\n] {\n  const context = useContext(FlamegraphStateContext);\n\n  if (context === null) {\n    throw new Error('useFlamegraphSearch called outside of FlamegraphStateProvider');\n  }\n\n  return [context[0].search, context[1]];\n}\n\nexport function useFlamegraphSearchValue(): FlamegraphStateContextValue[0]['search'] {\n  const context = useContext(FlamegraphStateContext);\n\n  if (context === null) {\n    throw new Error('useFlamegraphSearchValue called outside of FlamegraphStateProvider');\n  }\n\n  return context[0].search;\n}\n","import {useContext} from 'react';\n\nimport {\n  FlamegraphStateContext,\n  FlamegraphStateContextValue,\n} from './flamegraphStateProvider';\n\nexport function useFlamegraphState(): FlamegraphStateContextValue {\n  const context = useContext(FlamegraphStateContext);\n\n  if (context === null) {\n    throw new Error('useFlamegraphState called outside of FlamegraphStateProvider');\n  }\n\n  return context;\n}\n\nexport function useFlamegraphStateValue(): FlamegraphStateContextValue[0] {\n  const context = useContext(FlamegraphStateContext);\n\n  if (context === null) {\n    throw new Error('useFlamegraphState called outside of FlamegraphStateProvider');\n  }\n\n  return context[0];\n}\n\nexport function useDispatchFlamegraphState(): [\n  FlamegraphStateContextValue[1],\n  FlamegraphStateContextValue[2]\n] {\n  const context = useContext(FlamegraphStateContext);\n\n  if (context === null) {\n    throw new Error('useFlamegraphState called outside of FlamegraphStateProvider');\n  }\n\n  return [context[1], context[2]];\n}\n","import {useContext} from 'react';\n\nimport {FlamegraphTheme} from './flamegraphTheme';\nimport {FlamegraphThemeContext} from './flamegraphThemeProvider';\n\nfunction useFlamegraphTheme(): FlamegraphTheme {\n  const ctx = useContext(FlamegraphThemeContext);\n\n  if (!ctx) {\n    throw new Error('useFlamegraphTheme was called outside of FlamegraphThemeProvider');\n  }\n\n  return ctx;\n}\n\nexport {useFlamegraphTheme};\n","import {mat3, vec2} from 'gl-matrix';\n\nimport {Rect, transformMatrixBetweenRect} from 'sentry/utils/profiling/gl/utils';\n\nexport class FlamegraphCanvas {\n  canvas: HTMLCanvasElement;\n  origin: vec2;\n\n  physicalSpace: Rect = Rect.Empty();\n  logicalSpace: Rect = Rect.Empty();\n\n  physicalToLogicalSpace: mat3 = mat3.create();\n  logicalToPhysicalSpace: mat3 = mat3.create();\n\n  constructor(canvas: HTMLCanvasElement, origin: vec2) {\n    this.canvas = canvas;\n    this.origin = origin;\n    this.initPhysicalSpace();\n  }\n\n  initPhysicalSpace() {\n    this.physicalSpace = new Rect(\n      this.origin[0],\n      this.origin[1],\n      this.canvas.width - this.origin[0],\n      this.canvas.height - this.origin[1]\n    );\n\n    this.logicalSpace = this.physicalSpace.scale(\n      1 / window.devicePixelRatio,\n      1 / window.devicePixelRatio\n    );\n\n    this.logicalToPhysicalSpace = transformMatrixBetweenRect(\n      this.logicalSpace,\n      this.physicalSpace\n    );\n\n    this.physicalToLogicalSpace = transformMatrixBetweenRect(\n      this.physicalSpace,\n      this.logicalSpace\n    );\n  }\n}\n","import {CallTreeNode} from './callTreeNode';\nimport {Frame} from './frame';\n\nexport interface FlamegraphFrame {\n  children: FlamegraphFrame[];\n  depth: number;\n  end: number;\n  frame: Frame;\n  key: number;\n  node: CallTreeNode;\n  parent: FlamegraphFrame | null;\n  start: number;\n  processId?: number;\n  threadId?: number;\n}\n\nexport function getFlamegraphFrameSearchId(frame: FlamegraphFrame) {\n  return (\n    frame.frame.name + (frame.frame.file ? frame.frame.file : '') + String(frame.start)\n  );\n}\n","import {mat3, vec2} from 'gl-matrix';\n\nimport {Flamegraph} from 'sentry/utils/profiling/flamegraph';\nimport {FlamegraphTheme} from 'sentry/utils/profiling/flamegraph/flamegraphTheme';\nimport {FlamegraphCanvas} from 'sentry/utils/profiling/flamegraphCanvas';\nimport {\n  computeClampedConfigView,\n  Rect,\n  transformMatrixBetweenRect,\n} from 'sentry/utils/profiling/gl/utils';\n\nexport class FlamegraphView {\n  flamegraph: Flamegraph;\n  theme: FlamegraphTheme;\n\n  configView: Rect = Rect.Empty();\n  configSpace: Rect = Rect.Empty();\n\n  constructor({\n    canvas,\n    flamegraph,\n    theme,\n  }: {\n    canvas: FlamegraphCanvas;\n    flamegraph: Flamegraph;\n    theme: FlamegraphTheme;\n  }) {\n    this.flamegraph = flamegraph;\n    this.theme = theme;\n    this.initConfigSpace(canvas);\n  }\n\n  private _initConfigSpace(canvas: FlamegraphCanvas): void {\n    const BAR_HEIGHT = this.theme.SIZES.BAR_HEIGHT * window.devicePixelRatio;\n\n    this.configSpace = new Rect(\n      0,\n      0,\n      this.flamegraph.configSpace.width,\n      Math.max(\n        this.flamegraph.depth + this.theme.SIZES.FLAMEGRAPH_DEPTH_OFFSET + 1,\n        canvas.physicalSpace.height / BAR_HEIGHT\n      )\n    );\n  }\n\n  private _initConfigView(canvas: FlamegraphCanvas, space: Rect): void {\n    const BAR_HEIGHT = this.theme.SIZES.BAR_HEIGHT * window.devicePixelRatio;\n\n    this.configView = Rect.From(space).withHeight(\n      canvas.physicalSpace.height / BAR_HEIGHT\n    );\n  }\n\n  initConfigSpace(canvas: FlamegraphCanvas): void {\n    this._initConfigSpace(canvas);\n    this._initConfigView(canvas, this.configSpace);\n  }\n\n  resizeConfigSpace(canvas: FlamegraphCanvas): void {\n    this._initConfigSpace(canvas);\n    this._initConfigView(canvas, this.configView);\n  }\n\n  resetConfigView(canvas: FlamegraphCanvas): void {\n    this._initConfigView(canvas, this.configSpace);\n  }\n\n  setConfigView(configView: Rect) {\n    this.configView = computeClampedConfigView(configView, {\n      width: {\n        min: this.flamegraph.profile.minFrameDuration,\n        max: this.configSpace.width,\n      },\n      height: {\n        min: 0,\n        max: this.configSpace.height,\n      },\n    });\n  }\n\n  transformConfigView(transformation: mat3) {\n    this.setConfigView(this.configView.transformRect(transformation));\n  }\n\n  toConfigSpace(space: Rect): mat3 {\n    const toConfigSpace = transformMatrixBetweenRect(space, this.configSpace);\n\n    if (this.flamegraph.inverted) {\n      mat3.multiply(toConfigSpace, this.configSpace.invertYTransform(), toConfigSpace);\n    }\n\n    return toConfigSpace;\n  }\n\n  toConfigView(space: Rect): mat3 {\n    const toConfigView = transformMatrixBetweenRect(space, this.configView);\n\n    if (this.flamegraph.inverted) {\n      mat3.multiply(toConfigView, this.configView.invertYTransform(), toConfigView);\n    }\n\n    return toConfigView;\n  }\n\n  fromConfigSpace(space: Rect): mat3 {\n    const fromConfigSpace = transformMatrixBetweenRect(this.configSpace, space);\n\n    if (this.flamegraph.inverted) {\n      mat3.multiply(fromConfigSpace, space.invertYTransform(), fromConfigSpace);\n    }\n\n    return fromConfigSpace;\n  }\n\n  fromConfigView(space: Rect): mat3 {\n    const fromConfigView = transformMatrixBetweenRect(this.configView, space);\n\n    if (this.flamegraph.inverted) {\n      mat3.multiply(fromConfigView, space.invertYTransform(), fromConfigView);\n    }\n\n    return fromConfigView;\n  }\n\n  getConfigSpaceCursor(logicalSpaceCursor: vec2, canvas: FlamegraphCanvas): vec2 {\n    const physicalSpaceCursor = vec2.transformMat3(\n      vec2.create(),\n      logicalSpaceCursor,\n      canvas.logicalToPhysicalSpace\n    );\n\n    return vec2.transformMat3(\n      vec2.create(),\n      physicalSpaceCursor,\n      this.toConfigSpace(canvas.physicalSpace)\n    );\n  }\n\n  getConfigViewCursor(logicalSpaceCursor: vec2, canvas: FlamegraphCanvas): vec2 {\n    const physicalSpaceCursor = vec2.transformMat3(\n      vec2.create(),\n      logicalSpaceCursor,\n      canvas.logicalToPhysicalSpace\n    );\n\n    return vec2.transformMat3(\n      vec2.create(),\n      physicalSpaceCursor,\n      this.toConfigView(canvas.physicalSpace)\n    );\n  }\n}\n","import Fuse from 'fuse.js';\nimport {mat3, vec2} from 'gl-matrix';\n\nimport {FlamegraphFrame} from 'sentry/utils/profiling/flamegraphFrame';\nimport {FlamegraphRenderer} from 'sentry/utils/profiling/renderers/flamegraphRenderer';\n\nimport {clamp} from '../colors/utils';\n\nexport function createShader(\n  gl: WebGLRenderingContext,\n  type: WebGLRenderingContext['VERTEX_SHADER'] | WebGLRenderingContext['FRAGMENT_SHADER'],\n  source: string\n): WebGLShader {\n  const shader = gl.createShader(type);\n  if (!shader) {\n    throw new Error('Could not create shader');\n  }\n  gl.shaderSource(shader, source);\n  gl.compileShader(shader);\n  const success = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n  if (success) {\n    return shader;\n  }\n\n  gl.deleteShader(shader);\n  throw new Error('Failed to compile shader');\n}\n\nexport function createProgram(\n  gl: WebGLRenderingContext,\n  vertexShader: WebGLShader,\n  fragmentShader: WebGLShader\n): WebGLProgram {\n  const program = gl.createProgram();\n  if (!program) {\n    throw new Error('Could not create program');\n  }\n  gl.attachShader(program, vertexShader);\n  gl.attachShader(program, fragmentShader);\n  gl.linkProgram(program);\n  const success = gl.getProgramParameter(program, gl.LINK_STATUS);\n  if (success) {\n    return program;\n  }\n\n  gl.deleteProgram(program);\n  throw new Error('Failed to create program');\n}\n\n// Create a projection matrix with origins at 0,0 in top left corner, scaled to width/height\nexport function makeProjectionMatrix(width: number, height: number): mat3 {\n  const projectionMatrix = mat3.create();\n\n  mat3.identity(projectionMatrix);\n  mat3.translate(projectionMatrix, projectionMatrix, vec2.fromValues(-1, 1));\n  mat3.scale(\n    projectionMatrix,\n    projectionMatrix,\n    vec2.divide(vec2.create(), vec2.fromValues(2, -2), vec2.fromValues(width, height))\n  );\n\n  return projectionMatrix;\n}\n\nconst canvasToDisplaySizeMap = new Map<HTMLCanvasElement, [number, number]>();\n\nfunction onResize(entries: ResizeObserverEntry[]) {\n  for (const entry of entries) {\n    let width;\n    let height;\n    let dpr = window.devicePixelRatio;\n    // @ts-ignore use as a progressive enhancement, some browsers don't support this yet\n    if (entry.devicePixelContentBoxSize) {\n      // NOTE: Only this path gives the correct answer\n      // The other paths are imperfect fallbacks\n      // for browsers that don't provide anyway to do this\n      // @ts-ignore\n      width = entry.devicePixelContentBoxSize[0].inlineSize;\n      // @ts-ignore\n      height = entry.devicePixelContentBoxSize[0].blockSize;\n      dpr = 1; // it's already in width and height\n    } else if (entry.contentBoxSize) {\n      if (entry.contentBoxSize[0]) {\n        width = entry.contentBoxSize[0].inlineSize;\n        height = entry.contentBoxSize[0].blockSize;\n      } else {\n        // @ts-ignore\n        width = entry.contentBoxSize.inlineSize;\n        // @ts-ignore\n        height = entry.contentBoxSize.blockSize;\n      }\n    } else {\n      width = entry.contentRect.width;\n      height = entry.contentRect.height;\n    }\n    const displayWidth = Math.round(width * dpr);\n    const displayHeight = Math.round(height * dpr);\n    canvasToDisplaySizeMap.set(entry.target as HTMLCanvasElement, [\n      displayWidth,\n      displayHeight,\n    ]);\n\n    resizeCanvasToDisplaySize(entry.target as HTMLCanvasElement);\n  }\n}\n\nexport const watchForResize = (\n  canvas: HTMLCanvasElement[],\n  callback?: () => void\n): ResizeObserver => {\n  const handler: ResizeObserverCallback = entries => {\n    onResize(entries);\n    callback?.();\n  };\n\n  for (const c of canvas) {\n    canvasToDisplaySizeMap.set(c, [c.width, c.height]);\n  }\n\n  const resizeObserver = new ResizeObserver(handler);\n\n  try {\n    // only call us of the number of device pixels changed\n    canvas.forEach(c => {\n      resizeObserver.observe(c, {box: 'device-pixel-content-box'});\n    });\n  } catch (ex) {\n    // device-pixel-content-box is not supported so fallback to this\n    canvas.forEach(c => {\n      resizeObserver.observe(c, {box: 'content-box'});\n    });\n  }\n\n  return resizeObserver;\n};\n\nexport function resizeCanvasToDisplaySize(canvas: HTMLCanvasElement): boolean {\n  // Get the size the browser is displaying the canvas in device pixels.\n  const size = canvasToDisplaySizeMap.get(canvas);\n\n  if (!size) {\n    const displayWidth = canvas.clientWidth * window.devicePixelRatio;\n    const displayHeight = canvas.clientHeight * window.devicePixelRatio;\n\n    canvas.width = displayWidth;\n    canvas.height = displayHeight;\n\n    return false;\n  }\n\n  const [displayWidth, displayHeight] = size;\n  // Check if the canvas is not the same size.\n  const needResize = canvas.width !== displayWidth || canvas.height !== displayHeight;\n\n  if (needResize) {\n    // Make the canvas the same size\n    canvas.width = displayWidth;\n    canvas.height = displayHeight;\n  }\n\n  return needResize;\n}\n\nexport function transformMatrixBetweenRect(from: Rect, to: Rect): mat3 {\n  return mat3.fromValues(\n    to.width / from.width,\n    0,\n    0,\n    0,\n    to.height / from.height,\n    0,\n    to.x - from.x * (to.width / from.width),\n    to.y - from.y * (to.height / from.height),\n    1\n  );\n}\n\n// Utility class to manipulate a virtual rect element. Some of the implementations are based off\n// speedscope, however they are not 100% accurate and we've made some changes. It is important to\n// note that contructing a lot of these objects at draw time is expensive and should be avoided.\nexport class Rect {\n  origin: vec2;\n  size: vec2;\n\n  constructor(x: number, y: number, width: number, height: number) {\n    this.origin = vec2.fromValues(x, y);\n    this.size = vec2.fromValues(width, height);\n  }\n\n  clone(): Rect {\n    return Rect.From(this);\n  }\n\n  isValid(): boolean {\n    return this.toMatrix().every(n => !isNaN(n));\n  }\n\n  isEmpty(): boolean {\n    return this.width === 0 && this.height === 0;\n  }\n\n  static Empty(): Rect {\n    return new Rect(0, 0, 0, 0);\n  }\n\n  static From(rect: Rect): Rect {\n    return new Rect(rect.x, rect.y, rect.width, rect.height);\n  }\n\n  get x(): number {\n    return this.origin[0];\n  }\n  get y(): number {\n    return this.origin[1];\n  }\n  get width(): number {\n    return this.size[0];\n  }\n  get height(): number {\n    return this.size[1];\n  }\n  get left(): number {\n    return this.x;\n  }\n  get right(): number {\n    return this.left + this.width;\n  }\n  get top(): number {\n    return this.y;\n  }\n  get bottom(): number {\n    return this.top + this.height;\n  }\n\n  static decode(query: string | ReadonlyArray<string> | null | undefined): Rect | null {\n    let maybeEncodedRect = query;\n\n    if (typeof query === 'string') {\n      maybeEncodedRect = query.split(',');\n    }\n\n    if (!Array.isArray(maybeEncodedRect)) {\n      return null;\n    }\n\n    if (maybeEncodedRect.length !== 4) {\n      return null;\n    }\n\n    const rect = new Rect(\n      ...(maybeEncodedRect.map(p => parseFloat(p)) as [number, number, number, number])\n    );\n\n    if (rect.isValid()) {\n      return rect;\n    }\n\n    return null;\n  }\n\n  static encode(rect: Rect): string {\n    return rect.toString();\n  }\n\n  toString() {\n    return [this.x, this.y, this.width, this.height].map(n => Math.round(n)).join(',');\n  }\n\n  toMatrix(): mat3 {\n    const {width: w, height: h, x, y} = this;\n    // it's easier to display a matrix as a 3x3 array. WebGl matrices are row first and not column first\n    // https://webglfundamentals.org/webgl/lessons/webgl-matrix-vs-math.html\n    // prettier-ignore\n    return mat3.fromValues(\n      w, 0, 0,\n      0, h, 0,\n      x, y, 1\n    )\n  }\n\n  hasIntersectionWith(other: Rect): boolean {\n    const top = Math.max(this.top, other.top);\n    const bottom = Math.max(top, Math.min(this.bottom, other.bottom));\n    if (bottom - top === 0) {\n      return false;\n    }\n\n    const left = Math.max(this.left, other.left);\n    const right = Math.max(left, Math.min(this.right, other.right));\n\n    if (right - left === 0) {\n      return false;\n    }\n    return true;\n  }\n\n  containsX(vec: vec2): boolean {\n    return vec[0] >= this.left && vec[0] <= this.right;\n  }\n  containsY(vec: vec2): boolean {\n    return vec[1] >= this.top && vec[1] <= this.bottom;\n  }\n\n  contains(vec: vec2): boolean {\n    return this.containsX(vec) && this.containsY(vec);\n  }\n\n  containsRect(rect: Rect): boolean {\n    return (\n      // left bound\n      this.left <= rect.left &&\n      // right bound\n      rect.right <= this.right &&\n      // top bound\n      this.top <= rect.top &&\n      // bottom bound\n      rect.bottom <= this.bottom\n    );\n  }\n\n  leftOverlapsWith(rect: Rect): boolean {\n    return rect.left <= this.left && rect.right >= this.left;\n  }\n\n  rightOverlapsWith(rect: Rect): boolean {\n    return this.right >= rect.left && this.right <= rect.right;\n  }\n\n  overlapsX(other: Rect): boolean {\n    return this.left <= other.right && this.right >= other.left;\n  }\n\n  overlapsY(other: Rect): boolean {\n    return this.top <= other.bottom && this.bottom >= other.top;\n  }\n\n  overlaps(other: Rect): boolean {\n    return this.overlapsX(other) && this.overlapsY(other);\n  }\n\n  transformRect(transform: mat3): Rect {\n    const x = this.x * transform[0] + this.y * transform[3] + transform[6];\n    const y = this.x * transform[1] + this.y * transform[4] + transform[7];\n    const width = this.width * transform[0] + this.height * transform[3];\n    const height = this.width * transform[1] + this.height * transform[4];\n\n    return new Rect(\n      x + (width < 0 ? width : 0),\n      y + (height < 0 ? height : 0),\n      Math.abs(width),\n      Math.abs(height)\n    );\n  }\n\n  /**\n   * Returns a transform that inverts the y axis within the rect.\n   * This causes the bottom of the rect to be the top of the rect and vice versa.\n   */\n  invertYTransform(): mat3 {\n    return mat3.fromValues(1, 0, 0, 0, -1, 0, 0, this.y * 2 + this.height, 1);\n  }\n\n  withHeight(height: number): Rect {\n    return new Rect(this.x, this.y, this.width, height);\n  }\n\n  withWidth(width: number): Rect {\n    return new Rect(this.x, this.y, width, this.height);\n  }\n\n  withX(x: number): Rect {\n    return new Rect(x, this.y, this.width, this.height);\n  }\n\n  withY(y: number) {\n    return new Rect(this.x, y, this.width, this.height);\n  }\n\n  toBounds(): [number, number, number, number] {\n    return [this.x, this.y, this.x + this.width, this.y + this.height];\n  }\n\n  toArray(): [number, number, number, number] {\n    return [this.x, this.y, this.width, this.height];\n  }\n\n  between(to: Rect): Rect {\n    return new Rect(to.x, to.y, to.width / this.width, to.height / this.height);\n  }\n\n  translate(x: number, y: number): Rect {\n    return new Rect(x, y, this.width, this.height);\n  }\n\n  translateX(x: number): Rect {\n    return new Rect(x, this.y, this.width, this.height);\n  }\n\n  translateY(y: number): Rect {\n    return new Rect(this.x, y, this.width, this.height);\n  }\n\n  scaleX(x: number): Rect {\n    return new Rect(this.x, this.y, this.width * x, this.height);\n  }\n\n  scaleY(y: number): Rect {\n    return new Rect(this.x, this.y, this.width, this.height * y);\n  }\n\n  scale(x: number, y: number): Rect {\n    return new Rect(this.x * x, this.y * y, this.width * x, this.height * y);\n  }\n\n  scaleOriginBy(x: number, y: number): Rect {\n    return new Rect(this.x * x, this.y * y, this.width, this.height);\n  }\n\n  scaledBy(x: number, y: number): Rect {\n    return new Rect(this.x, this.y, this.width * x, this.height * y);\n  }\n\n  equals(rect: Rect): boolean {\n    if (this.x !== rect.x) {\n      return false;\n    }\n    if (this.y !== rect.y) {\n      return false;\n    }\n    if (this.width !== rect.width) {\n      return false;\n    }\n    if (this.height !== rect.height) {\n      return false;\n    }\n    return true;\n  }\n\n  notEqualTo(rect: Rect): boolean {\n    return !this.equals(rect);\n  }\n}\n\nfunction getContext(canvas: HTMLCanvasElement, context: '2d'): CanvasRenderingContext2D;\nfunction getContext(canvas: HTMLCanvasElement, context: 'webgl'): WebGLRenderingContext;\nfunction getContext(canvas: HTMLCanvasElement, context: string): RenderingContext {\n  const ctx =\n    context === 'webgl'\n      ? canvas.getContext(context, {antialias: false})\n      : canvas.getContext(context);\n  if (!ctx) {\n    throw new Error(`Could not get context ${context}`);\n  }\n  return ctx;\n}\n\n// Exported separately as writing export function for each overload as\n// breaks the line width rules and makes it harder to read.\nexport {getContext};\n\nexport function measureText(string: string, ctx?: CanvasRenderingContext2D): Rect {\n  if (!string) {\n    return Rect.Empty();\n  }\n\n  const context = ctx || getContext(document.createElement('canvas'), '2d');\n  const measures = context.measureText(string);\n\n  return new Rect(\n    0,\n    0,\n    measures.width,\n    // https://stackoverflow.com/questions/1134586/how-can-you-find-the-height-of-text-on-an-html-canvas\n    measures.actualBoundingBoxAscent + measures.actualBoundingBoxDescent\n  );\n}\n\n// Taken from speedscope, computes min/max by halving the high/low end\n// of the range on each iteration as long as range precision is greater than the given precision.\nexport function findRangeBinarySearch(\n  {low, high}: {high: number; low: number},\n  fn: (val: number) => number,\n  target: number,\n  precision = 1\n): [number, number] {\n  // eslint-disable-next-line\n  while (true) {\n    if (high - low <= precision) {\n      return [low, high];\n    }\n\n    const mid = (high + low) / 2;\n    if (fn(mid) < target) {\n      low = mid;\n    } else {\n      high = mid;\n    }\n  }\n}\n\nexport function formatColorForFrame(\n  frame: FlamegraphFrame,\n  renderer: FlamegraphRenderer\n): string {\n  const color = renderer.getColorForFrame(frame);\n  if (color.length === 4) {\n    return `rgba(${color\n      .slice(0, 3)\n      .map(n => n * 255)\n      .join(',')}, ${color[3]})`;\n  }\n\n  return `rgba(${color.map(n => n * 255).join(',')}, 1.0)`;\n}\n\nexport const ELLIPSIS = '\\u2026';\ntype TrimTextCenter = {\n  end: number;\n  length: number;\n  start: number;\n  text: string;\n};\n\n// Similar to speedscope's implementation, utility fn to trim text in the center with a small bias towards prefixes.\nexport function trimTextCenter(text: string, low: number): TrimTextCenter {\n  if (low >= text.length) {\n    return {\n      text,\n      start: 0,\n      end: 0,\n      length: 0,\n    };\n  }\n\n  const prefixLength = Math.floor(low / 2);\n  // Use 1 character less than the low value to account for ellipsis and favor displaying the prefix\n  const postfixLength = low - prefixLength - 1;\n\n  const start = prefixLength;\n  const end = Math.floor(text.length - postfixLength + ELLIPSIS.length);\n  const trimText = `${text.substring(0, start)}${ELLIPSIS}${text.substring(end)}`;\n\n  return {\n    text: trimText,\n    start,\n    end,\n    length: end - start,\n  };\n}\n\n// Utility function to compute a clamped view. This is essentially a bounds check\n// to ensure that zoomed viewports stays in the bounds and does not escape the view.\nexport function computeClampedConfigView(\n  newConfigView: Rect,\n  {width, height}: {height: {max: number; min: number}; width: {max: number; min: number}}\n) {\n  if (!newConfigView.isValid()) {\n    throw new Error(newConfigView.toString());\n  }\n  const clampedWidth = clamp(newConfigView.width, width.min, width.max);\n  const clampedHeight = clamp(newConfigView.height, height.min, height.max);\n\n  const maxX = width.max - clampedWidth;\n  const maxY = clampedHeight >= height.max ? 0 : height.max - clampedHeight;\n\n  const clampedX = clamp(newConfigView.x, 0, maxX);\n  const clampedY = clamp(newConfigView.y, 0, maxY);\n\n  return new Rect(clampedX, clampedY, clampedWidth, clampedHeight);\n}\n\n/**\n * computeHighlightedBounds determines if a supplied boundary should be reduced in size\n * or shifted based on the results of a trim operation\n */\nexport function computeHighlightedBounds(\n  bounds: Fuse.RangeTuple,\n  trim: TrimTextCenter\n): Fuse.RangeTuple {\n  if (!trim.length) {\n    return bounds;\n  }\n\n  const isStartBetweenTrim = bounds[0] >= trim.start && bounds[0] <= trim.end;\n  const isEndBetweenTrim = bounds[1] >= trim.start && bounds[1] <= trim.end;\n  const isFullyTruncated = isStartBetweenTrim && isEndBetweenTrim;\n\n  // example:\n  // -[UIScrollView _smoothScrollDisplayLink:]\n\n  // \"smooth\" in \"-[UIScrollView _ScrollDisplayLink:]\"\n  //                              ^^\n  if (isFullyTruncated) {\n    return [trim.start, trim.start + 1];\n  }\n\n  if (bounds[0] < trim.start) {\n    // \"ScrollView\" in '-[UIScrollView _smrollDisplayLink:]'\n    //                      ^--------^\n    if (bounds[1] < trim.start) {\n      return [bounds[0], bounds[1]];\n    }\n\n    // \"smoothScroll\" in -[UIScrollView _smoothDisplayLink:]'\n    //                                   ^-----^\n    if (isEndBetweenTrim) {\n      return [bounds[0], trim.start + 1];\n    }\n\n    // \"smoothScroll\" in -[UIScrollView _smllDisplayLink:]'\n    //                                   ^---^\n    if (bounds[1] > trim.end) {\n      return [bounds[0], bounds[1] - trim.length + 1];\n    }\n  }\n\n  // \"smoothScroll\" in -[UIScrollView _scrollDisplayLink:]'\n  //                                   ^-----^\n  if (isStartBetweenTrim && bounds[1] > trim.end) {\n    return [trim.start, bounds[1] - trim.length + 1];\n  }\n\n  // \"display\" in -[UIScrollView _scrollDisplayLink:]'\n  //                                     ^-----^\n  if (bounds[0] > trim.end) {\n    return [bounds[0] - trim.length + 1, bounds[1] - trim.length + 1];\n  }\n\n  throw new Error(`Unhandled case: ${JSON.stringify(bounds)} ${trim}`);\n}\n\n// Utility function to allow zooming into frames using a specific strategy. Supports\n// min zooming and exact strategy. Min zooming means we will zoom into a frame by doing\n// the minimal number of moves to get a frame into view - for example, if the view is large\n// enough and the frame we are zooming to is just outside of the viewport to the right,\n// we will only move the viewport to the right until the frame is in view. Exact strategy\n// means we will zoom into the frame by moving the viewport to the exact location of the frame\n// and setting the width of the view to that of the frame.\nexport function computeConfigViewWithStategy(\n  strategy: 'min' | 'exact',\n  view: Rect,\n  frame: Rect\n): Rect {\n  if (strategy === 'exact') {\n    return frame.withHeight(view.height);\n  }\n\n  if (strategy === 'min') {\n    if (view.width <= frame.width) {\n      // If view width <= frame width, we need to zoom out, so the behavior is the\n      // same as if we were using 'exact'\n      return frame.withHeight(view.height);\n    }\n\n    if (view.containsRect(frame)) {\n      // If frame is in view, do nothing\n      return view;\n    }\n\n    let offset = view.clone();\n    if (frame.left < view.left) {\n      // If frame is to the left of the view, translate it left\n      // to frame.x so that start of the frame is in the view\n      offset = offset.withX(frame.x);\n    } else if (frame.right > view.right) {\n      // If the right boundary of a frame is outside of the view, translate the view\n      // by the difference between the right edge of the frame and the right edge of the view\n      offset = view.withX(offset.x + frame.right - offset.right);\n    }\n\n    if (frame.bottom < view.top) {\n      // If frame is above the view, translate view to top of frame\n      offset = offset.withY(frame.top);\n    } else if (frame.bottom > view.bottom) {\n      // If frame is below the view, translate view by the difference\n      // of the bottom edge of the frame and the view\n      offset = offset.translateY(offset.y + frame.bottom - offset.bottom);\n    }\n\n    return offset;\n  }\n\n  return frame.withHeight(view.height);\n}\n","import {useCallback, useEffect, useState} from 'react';\n\nimport {clamp} from 'sentry/utils/profiling/colors/utils';\nimport {Rect} from 'sentry/utils/profiling/gl/utils';\n\nimport {useKeyboardNavigation} from './useKeyboardNavigation';\n\nexport function computeBestContextMenuPosition(\n  mouse: Rect,\n  container: Rect,\n  target: Rect\n) {\n  const maxY = Math.floor(container.height - target.height);\n  const minY = container.top;\n\n  const minX = container.left;\n  const maxX = Math.floor(container.right - target.width);\n\n  // We add a tiny offset so that the menu is not directly where the user places their cursor.\n  const OFFSET = 6;\n\n  return {\n    left: clamp(mouse.x + OFFSET, minX, maxX),\n    top: clamp(mouse.y + OFFSET, minY, maxY),\n  };\n}\n\ninterface UseContextMenuOptions {\n  container: HTMLElement | null;\n}\n\nexport function useContextMenu({container}: UseContextMenuOptions) {\n  const [open, setOpen] = useState<boolean>(false);\n  const [menuCoordinates, setMenuCoordinates] = useState<Rect | null>(null);\n  const [contextMenuCoordinates, setContextMenuCoordinates] = useState<Rect | null>(null);\n  const [containerCoordinates, setContainerCoordinates] = useState<Rect | null>(null);\n\n  const itemProps = useKeyboardNavigation();\n\n  // We wrap the setOpen function in a useEffect so that we also clear the keyboard\n  // tabIndex when a menu is closed. This prevents tabIndex from being persisted between render\n  const wrapSetOpen = useCallback(\n    (newOpen: boolean) => {\n      if (!newOpen) {\n        itemProps.setTabIndex(null);\n      }\n      setOpen(newOpen);\n    },\n    [itemProps]\n  );\n\n  const getMenuProps = useCallback(() => {\n    const menuProps = itemProps.getMenuProps();\n\n    return {\n      ...menuProps,\n      onKeyDown: (evt: React.KeyboardEvent) => {\n        if (evt.key === 'Escape') {\n          wrapSetOpen(false);\n        }\n        menuProps.onKeyDown(evt);\n      },\n    };\n  }, [itemProps, wrapSetOpen]);\n\n  const getMenuItemProps = useCallback(() => {\n    const menuItemProps = itemProps.getItemProps();\n\n    return {\n      ...menuItemProps,\n      onKeyDown: (evt: React.KeyboardEvent) => {\n        if (evt.key === 'Escape') {\n          wrapSetOpen(false);\n        }\n        menuItemProps.onKeyDown(evt);\n      },\n    };\n  }, [itemProps, wrapSetOpen]);\n\n  const handleContextMenu = useCallback(\n    (evt: React.MouseEvent) => {\n      if (!container) {\n        return;\n      }\n      evt.preventDefault();\n      evt.stopPropagation();\n\n      const parentPosition = container.getBoundingClientRect();\n\n      setContextMenuCoordinates(\n        new Rect(\n          evt.clientX - parentPosition.left,\n          evt.clientY - parentPosition.top,\n          0,\n          0\n        )\n      );\n      wrapSetOpen(true);\n    },\n    [wrapSetOpen, container]\n  );\n\n  useEffect(() => {\n    const listener = (event: MouseEvent | TouchEvent) => {\n      // Do nothing if clicking ref's element or descendent elements\n      if (!itemProps.menuRef || itemProps.menuRef.contains(event.target as Node)) {\n        return;\n      }\n\n      setOpen(false);\n    };\n\n    document.addEventListener('mousedown', listener);\n    document.addEventListener('touchstart', listener);\n    return () => {\n      document.removeEventListener('mousedown', listener);\n      document.removeEventListener('touchstart', listener);\n    };\n  }, [itemProps.menuRef]);\n\n  // Observe the menu\n  useEffect(() => {\n    if (!itemProps.menuRef) {\n      return undefined;\n    }\n\n    const resizeObserver = new window.ResizeObserver(entries => {\n      const contentRect = entries[0].contentRect;\n      setMenuCoordinates(new Rect(0, 0, contentRect.width, contentRect.height));\n    });\n\n    resizeObserver.observe(itemProps.menuRef);\n\n    return () => {\n      resizeObserver.disconnect();\n    };\n  }, [itemProps.menuRef]);\n\n  // Observe the container\n  useEffect(() => {\n    if (!container) {\n      return undefined;\n    }\n\n    const resizeObserver = new window.ResizeObserver(entries => {\n      const contentRect = entries[0].contentRect;\n      setContainerCoordinates(new Rect(0, 0, contentRect.width, contentRect.height));\n    });\n\n    resizeObserver.observe(container);\n\n    return () => {\n      resizeObserver.disconnect();\n    };\n  }, [container]);\n\n  const position =\n    contextMenuCoordinates && containerCoordinates && menuCoordinates\n      ? computeBestContextMenuPosition(\n          contextMenuCoordinates,\n          containerCoordinates,\n          menuCoordinates\n        )\n      : null;\n\n  return {\n    open,\n    setOpen: wrapSetOpen,\n    position,\n    containerCoordinates,\n    contextMenuCoordinates: position,\n    menuRef: itemProps.menuRef,\n    handleContextMenu,\n    getMenuProps,\n    getMenuItemProps,\n  };\n}\n","import {useEffect, useState} from 'react';\n\nconst FLAMEGRAPH_DEBUG_MODE_KEY = '__fgdb__';\n\nexport function useInternalFlamegraphDebugMode() {\n  const [isEnabled, setIsEnabled] = useState(\n    sessionStorage.getItem(FLAMEGRAPH_DEBUG_MODE_KEY) === '1'\n  );\n\n  useEffect(() => {\n    function handleKeyDown(evt: KeyboardEvent) {\n      const isCtrlOrMeta = evt.ctrlKey || evt.metaKey;\n\n      if (isCtrlOrMeta && evt.shiftKey && evt.code === 'KeyI') {\n        setIsEnabled(val => {\n          const next = !val;\n          if (next) {\n            sessionStorage.setItem(FLAMEGRAPH_DEBUG_MODE_KEY, '1');\n          } else {\n            sessionStorage.removeItem(FLAMEGRAPH_DEBUG_MODE_KEY);\n          }\n          return next;\n        });\n      }\n    }\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  });\n\n  return isEnabled;\n}\n","import {useCallback, useEffect, useState} from 'react';\n\nexport function useRovingTabIndex(items: any[]) {\n  const [tabIndex, setTabIndex] = useState<number | null>(null);\n\n  const onKeyDown = useCallback(\n    (evt: React.KeyboardEvent) => {\n      if (items.length === 0) {\n        return;\n      }\n\n      if (evt.key === 'Escape') {\n        setTabIndex(null);\n      }\n\n      if (evt.key === 'ArrowDown' || evt.key === 'Tab') {\n        evt.preventDefault();\n\n        if (tabIndex === items.length - 1 || tabIndex === null) {\n          setTabIndex(0);\n        } else {\n          setTabIndex((tabIndex ?? 0) + 1);\n        }\n      }\n\n      if (evt.key === 'ArrowUp' || (evt.key === 'Tab' && evt.shiftKey)) {\n        evt.preventDefault();\n\n        if (tabIndex === 0 || tabIndex === null) {\n          setTabIndex(items.length - 1);\n        } else {\n          setTabIndex((tabIndex ?? 0) - 1);\n        }\n      }\n    },\n    [tabIndex, items]\n  );\n\n  return {\n    tabIndex,\n    setTabIndex,\n    onKeyDown,\n  };\n}\n\nexport function useKeyboardNavigation() {\n  const [menuRef, setMenuRef] = useState<HTMLDivElement | null>(null);\n  const items: {id: number; node: HTMLElement | null}[] = [];\n\n  const {tabIndex, setTabIndex, onKeyDown} = useRovingTabIndex(items);\n\n  useEffect(() => {\n    if (menuRef) {\n      if (tabIndex === null) {\n        menuRef.focus();\n      }\n    }\n  }, [menuRef, tabIndex]);\n\n  function getMenuProps() {\n    return {\n      tabIndex: -1,\n      ref: setMenuRef,\n      onKeyDown,\n    };\n  }\n\n  function getItemProps() {\n    const idx = items.length;\n    items.push({id: idx, node: null});\n\n    return {\n      tabIndex: tabIndex === idx ? 0 : -1,\n      ref: (node: HTMLElement | null) => {\n        if (items[idx]) {\n          if (tabIndex === idx) {\n            node?.focus();\n          }\n          items[idx].node = node;\n        }\n      },\n      onMouseEnter: () => {\n        setTabIndex(idx);\n      },\n      onKeyDown,\n    };\n  }\n\n  return {\n    menuRef,\n    getItemProps,\n    getMenuProps,\n    tabIndex,\n    setTabIndex,\n  };\n}\n","import {useCallback, useEffect, useRef, useState} from 'react';\n\nexport interface UseResizableDrawerOptions {\n  direction: 'horizontal-ltr' | 'horizontal-rtl' | 'vertical';\n  initialDimensions: [number, number];\n  min: [number, number];\n  onResize: (newDimensions: [number, number]) => void;\n}\n\nexport function useResizableDrawer(options: UseResizableDrawerOptions): {\n  dimensions: [number, number];\n  onMouseDown: React.MouseEventHandler<HTMLElement>;\n} {\n  const rafIdRef = useRef<number | null>(null);\n  const startResizeVectorRef = useRef<[number, number] | null>(null);\n  const [dimensions, setDimensions] = useState<[number, number]>([\n    options.initialDimensions[0],\n    options.initialDimensions[1],\n  ]);\n\n  // We intentionally fire this once at mount to ensure the dimensions are set and\n  // any potentional values set by CSS will be overriden.\n  useEffect(() => {\n    options.onResize(options.initialDimensions);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [options.direction]);\n\n  const dimensionsRef = useRef<[number, number]>(dimensions);\n  dimensionsRef.current = dimensions;\n\n  const onMouseMove = useCallback(\n    (event: MouseEvent) => {\n      document.body.style.pointerEvents = 'none';\n      document.body.style.userSelect = 'none';\n\n      if (rafIdRef.current !== null) {\n        window.cancelAnimationFrame(rafIdRef.current);\n      }\n\n      rafIdRef.current = window.requestAnimationFrame(() => {\n        if (!startResizeVectorRef.current) {\n          return;\n        }\n        const currentPositionVector: [number, number] = [event.clientX, event.clientY];\n\n        const distance = [\n          startResizeVectorRef.current[0] - currentPositionVector[0],\n          startResizeVectorRef.current[1] - currentPositionVector[1],\n        ];\n\n        startResizeVectorRef.current = currentPositionVector;\n\n        const newDimensions: [number, number] = [\n          // Round to 1px precision\n          Math.round(\n            Math.max(\n              options.min[0],\n              dimensionsRef.current[0] +\n                distance[0] * (options.direction === 'horizontal-ltr' ? -1 : 1)\n            )\n          ),\n          // Round to 1px precision\n          Math.round(\n            Math.max(options.min[1] ?? 0, dimensionsRef.current[1] + distance[1])\n          ),\n        ];\n\n        options.onResize(newDimensions);\n        setDimensions(newDimensions);\n      });\n    },\n    [options]\n  );\n\n  const onMouseUp = useCallback(() => {\n    document.body.style.pointerEvents = '';\n    document.body.style.userSelect = '';\n    document.removeEventListener('mousemove', onMouseMove);\n    document.removeEventListener('mouseup', onMouseUp);\n  }, [onMouseMove]);\n\n  const onMouseDown = useCallback(\n    (evt: React.MouseEvent<HTMLElement>) => {\n      startResizeVectorRef.current = [evt.clientX, evt.clientY];\n\n      document.addEventListener('mousemove', onMouseMove, {passive: true});\n      document.addEventListener('mouseup', onMouseUp);\n    },\n    [onMouseMove, onMouseUp]\n  );\n\n  useEffect(() => {\n    return () => {\n      if (rafIdRef.current !== null) {\n        window.cancelAnimationFrame(rafIdRef.current);\n      }\n    };\n  });\n\n  return {dimensions, onMouseDown};\n}\n","import {TreeLike} from 'sentry/utils/profiling/hooks/useVirtualizedTree/useVirtualizedTree';\n\nimport {VirtualizedTreeNode} from './VirtualizedTreeNode';\n\nexport class VirtualizedTree<T extends TreeLike> {\n  roots: VirtualizedTreeNode<T>[] = [];\n  flattened: VirtualizedTreeNode<T>[] = [];\n\n  constructor(roots: VirtualizedTreeNode<T>[], flattenedList?: VirtualizedTreeNode<T>[]) {\n    this.roots = roots;\n    this.flattened = flattenedList || VirtualizedTree.toExpandedList(this.roots);\n  }\n\n  // Rebuilds the tree\n  static fromRoots<T extends TreeLike>(\n    items: T[],\n    skipFn: (n: VirtualizedTreeNode<T>) => boolean = () => false,\n    expandedNodes?: Set<T>\n  ): VirtualizedTree<T> {\n    const roots: VirtualizedTreeNode<T>[] = [];\n\n    function toTreeNode(\n      node: T,\n      parent: VirtualizedTreeNode<T> | null,\n      collection: VirtualizedTreeNode<T>[] | null,\n      depth: number\n    ) {\n      const treeNode = new VirtualizedTreeNode<T>(\n        node,\n        parent,\n        depth,\n        expandedNodes ? expandedNodes.has(node) : false\n      );\n\n      // We cannot skip root nodes, so we check that the parent is not null.\n      // If the node should be skipped, then we don't add it to the tree and descend\n      // into its children without incrementing the depth.\n      if (parent && skipFn(treeNode)) {\n        for (let i = 0; i < node.children.length; i++) {\n          toTreeNode(node.children[i] as T, treeNode, parent.children, depth);\n        }\n        return;\n      }\n\n      if (collection) {\n        collection.push(treeNode);\n      }\n\n      for (let i = 0; i < node.children.length; i++) {\n        toTreeNode(node.children[i] as T, treeNode, treeNode.children, depth + 1);\n      }\n    }\n\n    for (let i = 0; i < items.length; i++) {\n      toTreeNode(items[i], null, roots, 0);\n    }\n\n    return new VirtualizedTree<T>(roots, undefined);\n  }\n\n  // Returns a list of nodes that are visible in the tree.\n  static toExpandedList<T extends TreeLike>(\n    nodes: VirtualizedTreeNode<T>[]\n  ): VirtualizedTreeNode<T>[] {\n    const list: VirtualizedTreeNode<T>[] = [];\n\n    function visit(node: VirtualizedTreeNode<T>): void {\n      list.push(node);\n\n      if (!node.expanded) {\n        return;\n      }\n\n      for (let i = 0; i < node.children.length; i++) {\n        visit(node.children[i]);\n      }\n    }\n\n    for (let i = 0; i < nodes.length; i++) {\n      visit(nodes[i]);\n    }\n\n    return list;\n  }\n\n  expandNode(\n    node: VirtualizedTreeNode<T>,\n    value: boolean,\n    opts?: {expandChildren: boolean}\n  ) {\n    // Because node.setExpanded handles toggling the node and all it's children, we still need to update the\n    // flattened list. To do that w/o having to rebuild the entire tree, we can just remove the node and add them\n    const removedOrAddedNodes = node.setExpanded(value, opts);\n\n    // If toggling the node resulted in no changes to the actual tree, do nothing\n    if (!removedOrAddedNodes.length) {\n      return removedOrAddedNodes;\n    }\n\n    // If a node was expanded, we need to add all of its children to the flattened list.\n    if (node.expanded) {\n      this.flattened.splice(this.flattened.indexOf(node) + 1, 0, ...removedOrAddedNodes);\n    } else {\n      // If a node was collapsed, we need to remove all of its children from the flattened list.\n      this.flattened.splice(this.flattened.indexOf(node) + 1, removedOrAddedNodes.length);\n    }\n\n    return removedOrAddedNodes;\n  }\n\n  // Sorts the entire tree and rebuilds the flattened list.\n  sort(sortFn: (a: VirtualizedTreeNode<T>, b: VirtualizedTreeNode<T>) => number) {\n    if (!this.roots.length) {\n      return;\n    }\n\n    function visit(node: VirtualizedTreeNode<T>) {\n      const sortedChildren = node.children.sort(sortFn);\n      for (let i = 0; i < sortedChildren.length; i++) {\n        visit(sortedChildren[i]);\n      }\n    }\n\n    const sortedRoots = this.roots.sort(sortFn);\n    for (let i = 0; i < sortedRoots.length; i++) {\n      visit(sortedRoots[i]);\n    }\n\n    this.flattened = VirtualizedTree.toExpandedList(this.roots);\n  }\n\n  getAllExpandedNodes(previouslyExpandedNodes: Set<T>): Set<T> {\n    const expandedNodes = new Set<T>([...previouslyExpandedNodes]);\n\n    function visit(node: VirtualizedTreeNode<T>) {\n      if (node.expanded) {\n        expandedNodes.add(node.node);\n      }\n\n      for (let i = 0; i < node.children.length; i++) {\n        visit(node.children[i]);\n      }\n    }\n\n    for (let i = 0; i < this.roots.length; i++) {\n      visit(this.roots[i]);\n    }\n\n    return expandedNodes;\n  }\n}\n","export class VirtualizedTreeNode<T> {\n  node: T;\n  parent: VirtualizedTreeNode<T> | null;\n  children: VirtualizedTreeNode<T>[];\n  expanded: boolean;\n  depth: number;\n\n  constructor(\n    node: T,\n    parent: VirtualizedTreeNode<T> | null,\n    depth: number,\n    expanded: boolean = false\n  ) {\n    this.node = node;\n    this.parent = parent;\n    this.expanded = expanded ?? false;\n    this.children = [];\n    this.depth = depth;\n  }\n\n  getVisibleChildrenCount(): number {\n    if (!this.expanded || !this.children.length) {\n      return 0;\n    }\n\n    let count = 0;\n    const queue = [...this.children];\n\n    while (queue.length > 0) {\n      const next = queue.pop();\n      if (next === undefined) {\n        throw new Error('Undefined queue node, this should never happen');\n      }\n\n      if (next.expanded) {\n        for (let i = 0; i < next.children.length; i++) {\n          queue.push(next.children[i]);\n        }\n      }\n      count++;\n    }\n\n    return count;\n  }\n\n  setExpanded(value: boolean, opts?: {expandChildren: boolean}) {\n    if (value === this.expanded) {\n      return [];\n    }\n\n    // We are closing a node, so we need to remove all of its children. To do that, we just get the\n    // count of visible children and return it.\n    if (!value) {\n      const removedCount = this.getVisibleChildrenCount();\n      this.expanded = value;\n      return new Array(removedCount);\n    }\n\n    // If we are opening a node, we need to add all of its children to the list and insert it\n    this.expanded = value;\n\n    // Collect the newly visible children.\n    const list: VirtualizedTreeNode<T>[] = [];\n    function visit(node: VirtualizedTreeNode<T>): void {\n      if (opts?.expandChildren) {\n        node.expanded = true;\n      }\n\n      list.push(node);\n\n      if (!node.expanded) {\n        return;\n      }\n\n      for (let i = 0; i < node.children.length; i++) {\n        visit(node.children[i]);\n      }\n    }\n\n    for (let i = 0; i < this.children.length; i++) {\n      visit(this.children[i]);\n    }\n\n    return list;\n  }\n}\n","import {\n  MutableRefObject,\n  useCallback,\n  useEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  useState,\n} from 'react';\nimport {Theme, useTheme} from '@emotion/react';\n\nimport {useEffectAfterFirstRender} from 'sentry/utils/useEffectAfterFirstRender';\n\nimport {VirtualizedTree} from './VirtualizedTree';\nimport {VirtualizedTreeNode} from './VirtualizedTreeNode';\n\ntype AnimationTimeoutId = {\n  id: number;\n};\n\nconst cancelAnimationTimeout = (frame: AnimationTimeoutId) =>\n  window.cancelAnimationFrame(frame.id);\n\n/**\n * Recursively calls requestAnimationFrame until a specified delay has been met or exceeded.\n * When the delay time has been reached the function you're timing out will be called.\n * This was copied from react-virtualized, with credits to the original author.\n *\n * Credit: Joe Lambert (https://gist.github.com/joelambert/1002116#file-requesttimeout-js)\n */\nconst requestAnimationTimeout = (\n  callback: Function,\n  delay: number\n): AnimationTimeoutId => {\n  let start;\n  // wait for end of processing current event handler, because event handler may be long\n  Promise.resolve().then(() => {\n    start = Date.now();\n  });\n\n  const timeout = () => {\n    if (start === undefined) {\n      frame.id = window.requestAnimationFrame(timeout);\n      return;\n    }\n    if (Date.now() - start >= delay) {\n      callback();\n    } else {\n      frame.id = window.requestAnimationFrame(timeout);\n    }\n  };\n\n  const frame: AnimationTimeoutId = {\n    id: window.requestAnimationFrame(timeout),\n  };\n\n  return frame;\n};\n\nexport interface TreeLike {\n  children: TreeLike[];\n}\n\ninterface VirtualizedState<T> {\n  overscroll: number;\n  roots: T[];\n  scrollHeight: number;\n  scrollTop: number;\n  tabIndexKey: number | null;\n}\n\ninterface SetScrollTop {\n  payload: number;\n  type: 'set scroll top';\n}\n\ninterface SetTabIndexKey {\n  payload: number | null;\n  type: 'set tab index key';\n}\ninterface SetContainerHeight {\n  payload: number;\n  type: 'set scroll height';\n}\n\ntype VirtualizedStateAction = SetScrollTop | SetContainerHeight | SetTabIndexKey;\n\nexport function VirtualizedTreeStateReducer<T>(\n  state: VirtualizedState<T>,\n  action: VirtualizedStateAction\n): VirtualizedState<T> {\n  switch (action.type) {\n    case 'set tab index key': {\n      return {...state, tabIndexKey: action.payload};\n    }\n    case 'set scroll top': {\n      return {...state, scrollTop: action.payload};\n    }\n    case 'set scroll height': {\n      return {...state, scrollHeight: action.payload};\n    }\n    default: {\n      return state;\n    }\n  }\n}\n\nfunction hideGhostRow({ref}: {ref: MutableRefObject<HTMLElement | null>}) {\n  if (ref.current) {\n    ref.current.style.opacity = '0';\n  }\n}\n\nfunction updateGhostRow({\n  ref,\n  tabIndexKey,\n  rowHeight,\n  scrollTop,\n  interaction,\n  theme,\n}: {\n  interaction: 'hover' | 'active';\n  ref: MutableRefObject<HTMLElement | null>;\n  rowHeight: number;\n  scrollTop: number;\n  tabIndexKey: number;\n  theme: Theme;\n}) {\n  if (!ref.current) {\n    return;\n  }\n  ref.current.style.left = '0';\n  ref.current.style.right = '0';\n  ref.current.style.height = `${rowHeight}px`;\n  ref.current.style.position = 'absolute';\n  ref.current.style.backgroundColor =\n    interaction === 'active' ? theme.blue300 : theme.surface100;\n  ref.current.style.pointerEvents = 'none';\n  ref.current.style.willChange = 'transform, opacity';\n  ref.current.style.transform = `translateY(${rowHeight * tabIndexKey - scrollTop}px)`;\n  ref.current.style.opacity = '1';\n}\nfunction findOptimisticStartIndex<T extends TreeLike>({\n  items,\n  overscroll,\n  rowHeight,\n  scrollTop,\n  viewport,\n}: {\n  items: VirtualizedTreeNode<T>[];\n  overscroll: number;\n  rowHeight: number;\n  scrollTop: number;\n  viewport: {bottom: number; top: number};\n}): number {\n  if (!items.length || viewport.top === 0) {\n    return 0;\n  }\n  return Math.max(Math.floor(scrollTop / rowHeight) - overscroll, 0);\n}\n\nfunction findVisibleItems<T extends TreeLike>({\n  items,\n  overscroll,\n  rowHeight,\n  scrollHeight,\n  scrollTop,\n}: {\n  items: VirtualizedTreeNode<T>[];\n  overscroll: NonNullable<UseVirtualizedListProps<T>['overscroll']>;\n  rowHeight: UseVirtualizedListProps<T>['rowHeight'];\n  scrollHeight: VirtualizedState<T>['scrollHeight'];\n  scrollTop: VirtualizedState<T>['scrollTop'];\n}) {\n  // This is overscroll height for single direction, when computing the total,\n  // we need to multiply this by 2 because we overscroll in both directions.\n  const OVERSCROLL_HEIGHT = overscroll * rowHeight;\n  const visibleItems: VisibleItem<T>[] = [];\n\n  // Clamp viewport to scrollHeight bounds [0, length * rowHeight] because some browsers may fire\n  // scrollTop with negative values when the user scrolls up past the top of the list (overscroll behavior)\n  const viewport = {\n    top: Math.max(scrollTop - OVERSCROLL_HEIGHT, 0),\n    bottom: Math.min(\n      scrollTop + scrollHeight + OVERSCROLL_HEIGHT,\n      items.length * rowHeight\n    ),\n  };\n\n  // Points to the position inside the visible array\n  let visibleItemIndex = 0;\n  // Points to the currently iterated item\n  let indexPointer = findOptimisticStartIndex({\n    items,\n    viewport,\n    scrollTop,\n    rowHeight,\n    overscroll,\n  });\n\n  // Max number of visible items in our list\n  const MAX_VISIBLE_ITEMS = Math.ceil((scrollHeight + OVERSCROLL_HEIGHT * 2) / rowHeight);\n  const ALL_ITEMS = items.length;\n\n  // While number of visible items is less than max visible items, and we haven't reached the end of the list\n  while (visibleItemIndex < MAX_VISIBLE_ITEMS && indexPointer < ALL_ITEMS) {\n    const elementTop = indexPointer * rowHeight;\n    const elementBottom = elementTop + rowHeight;\n\n    // An element is inside a viewport if the top of the element is below the top of the viewport\n    // and the bottom of the element is above the bottom of the viewport\n    if (elementTop >= viewport.top && elementBottom <= viewport.bottom) {\n      visibleItems[visibleItemIndex] = {\n        key: indexPointer,\n        ref: null,\n        styles: {position: 'absolute', top: elementTop},\n        item: items[indexPointer],\n      };\n\n      visibleItemIndex++;\n    }\n    indexPointer++;\n  }\n\n  return visibleItems;\n}\n\ninterface VisibleItem<T> {\n  item: VirtualizedTreeNode<T>;\n  key: number;\n  ref: HTMLElement | null;\n  styles: React.CSSProperties;\n}\n\nexport interface UseVirtualizedListProps<T extends TreeLike> {\n  renderRow: (\n    item: VisibleItem<T>,\n    itemHandlers: {\n      handleExpandTreeNode: (\n        node: VirtualizedTreeNode<T>,\n        opts?: {expandChildren: boolean}\n      ) => void;\n      handleRowClick: (evt: React.MouseEvent<HTMLElement>) => void;\n      handleRowKeyDown: (event: React.KeyboardEvent) => void;\n      handleRowMouseEnter: (event: React.MouseEvent<HTMLElement>) => void;\n      tabIndexKey: number | null;\n    }\n  ) => React.ReactNode;\n  rowHeight: number;\n  scrollContainer: HTMLElement | null;\n  tree: T[];\n  overscroll?: number;\n  skipFunction?: (node: VirtualizedTreeNode<T>) => boolean;\n  sortFunction?: (a: VirtualizedTreeNode<T>, b: VirtualizedTreeNode<T>) => number;\n}\n\nconst DEFAULT_OVERSCROLL_ITEMS = 5;\n\nfunction findCarryOverIndex<T extends TreeLike>(\n  previousNode: VirtualizedTreeNode<T> | null | undefined,\n  newTree: VirtualizedTree<T>\n): number | null {\n  if (!newTree.flattened.length || !previousNode) {\n    return null;\n  }\n\n  const newIndex = newTree.flattened.findIndex(n => n.node === previousNode.node);\n  if (newIndex === -1) {\n    return null;\n  }\n  return newIndex;\n}\n\nexport function useVirtualizedTree<T extends TreeLike>(\n  props: UseVirtualizedListProps<T>\n) {\n  const theme = useTheme();\n  const clickedGhostRowRef = useRef<HTMLDivElement | null>(null);\n  const hoveredGhostRowRef = useRef<HTMLDivElement | null>(null);\n\n  const previousHoveredRow = useRef<number | null>(null);\n\n  const [state, dispatch] = useReducer(VirtualizedTreeStateReducer, {\n    scrollTop: 0,\n    roots: props.tree,\n    tabIndexKey: null,\n    overscroll: props.overscroll ?? DEFAULT_OVERSCROLL_ITEMS,\n    scrollHeight: props.scrollContainer?.getBoundingClientRect()?.height ?? 0,\n  });\n\n  // Keep a ref to latest state to avoid re-rendering\n  const latestStateRef = useRef<typeof state>(state);\n  latestStateRef.current = state;\n  const [tree, setTree] = useState(() => {\n    const initialTree = VirtualizedTree.fromRoots(props.tree, props.skipFunction);\n\n    if (props.sortFunction) {\n      initialTree.sort(props.sortFunction);\n    }\n\n    return initialTree;\n  });\n\n  const cleanupAllHoveredRows = useCallback(() => {\n    previousHoveredRow.current = null;\n    for (const row of latestItemsRef.current) {\n      if (row.ref && row.ref.dataset.hovered) {\n        delete row.ref.dataset.hovered;\n      }\n    }\n  }, []);\n\n  const flattenedHistory = useRef<ReadonlyArray<VirtualizedTreeNode<T>>>(tree.flattened);\n  const expandedHistory = useRef<Set<T>>(tree.getAllExpandedNodes(new Set()));\n  useEffectAfterFirstRender(() => {\n    const newTree = VirtualizedTree.fromRoots(\n      props.tree,\n      props.skipFunction,\n      expandedHistory.current\n    );\n\n    if (props.sortFunction) {\n      newTree.sort(props.sortFunction);\n    }\n\n    const tabIndex = findCarryOverIndex(\n      typeof latestStateRef.current.tabIndexKey === 'number'\n        ? flattenedHistory.current[latestStateRef.current.tabIndexKey]\n        : null,\n      newTree\n    );\n\n    if (tabIndex) {\n      updateGhostRow({\n        ref: clickedGhostRowRef,\n        tabIndexKey: tabIndex,\n        rowHeight: props.rowHeight,\n        scrollTop: latestStateRef.current.scrollTop,\n        interaction: 'active',\n        theme,\n      });\n    } else {\n      hideGhostRow({ref: clickedGhostRowRef});\n    }\n\n    cleanupAllHoveredRows();\n    hideGhostRow({ref: hoveredGhostRowRef});\n\n    dispatch({type: 'set tab index key', payload: tabIndex});\n    setTree(newTree);\n\n    expandedHistory.current = newTree.getAllExpandedNodes(expandedHistory.current);\n    flattenedHistory.current = newTree.flattened;\n  }, [\n    props.tree,\n    props.skipFunction,\n    props.sortFunction,\n    props.rowHeight,\n    cleanupAllHoveredRows,\n    theme,\n  ]);\n\n  const items = useMemo(() => {\n    return findVisibleItems<T>({\n      items: tree.flattened,\n      scrollHeight: state.scrollHeight,\n      scrollTop: state.scrollTop,\n      overscroll: state.overscroll,\n      rowHeight: props.rowHeight,\n    });\n  }, [tree, state.overscroll, state.scrollHeight, state.scrollTop, props.rowHeight]);\n\n  const latestItemsRef = useRef(items);\n  latestItemsRef.current = items;\n\n  // On scroll, we update scrollTop position.\n  // Keep a rafId reference in the unlikely event where component unmounts before raf is executed.\n  const scrollEndTimeoutId = useRef<AnimationTimeoutId | undefined>(undefined);\n  const previousScrollHeight = useRef<number>(0);\n\n  useEffect(() => {\n    const scrollContainer = props.scrollContainer;\n\n    if (!scrollContainer) {\n      return undefined;\n    }\n\n    function handleScroll(evt) {\n      const top = Math.max(evt.target.scrollTop, 0);\n\n      if (previousScrollHeight.current === top) {\n        return;\n      }\n\n      evt.target.firstChild.style.pointerEvents = 'none';\n\n      if (scrollEndTimeoutId.current !== undefined) {\n        cancelAnimationTimeout(scrollEndTimeoutId.current);\n      }\n\n      scrollEndTimeoutId.current = requestAnimationTimeout(() => {\n        evt.target.firstChild.style.pointerEvents = 'auto';\n      }, 150);\n\n      dispatch({\n        type: 'set scroll top',\n        payload: top,\n      });\n\n      // On scroll, we need to update the selected ghost row and clear the hovered ghost row\n      if (latestStateRef.current.tabIndexKey !== null) {\n        updateGhostRow({\n          ref: clickedGhostRowRef,\n          tabIndexKey: latestStateRef.current.tabIndexKey,\n          scrollTop: Math.max(evt.target.scrollTop, 0),\n          interaction: 'active',\n          rowHeight: props.rowHeight,\n          theme,\n        });\n      }\n\n      cleanupAllHoveredRows();\n      hideGhostRow({\n        ref: hoveredGhostRowRef,\n      });\n\n      previousScrollHeight.current = top;\n    }\n\n    scrollContainer.addEventListener('scroll', handleScroll, {\n      passive: true,\n    });\n\n    return () => {\n      scrollContainer.removeEventListener('scroll', handleScroll);\n    };\n  }, [props.scrollContainer, props.rowHeight, cleanupAllHoveredRows, theme]);\n\n  useEffect(() => {\n    const scrollContainer = props.scrollContainer;\n\n    if (!scrollContainer) {\n      return undefined;\n    }\n\n    // Because nodes dont span the full width, it's possible for users to\n    // click or hover on a node at the far right end which is outside of the row width.\n    // In that case, we check if the cursor position overlaps with a row and select that row.\n    const handleClick = (evt: MouseEvent) => {\n      if (evt.target !== scrollContainer) {\n        // user clicked on an element inside the container, defer to onClick\n        return;\n      }\n\n      const rect = (evt.target as HTMLDivElement).getBoundingClientRect();\n      const index = Math.floor(\n        (latestStateRef.current.scrollTop + evt.clientY - rect.top) / props.rowHeight\n      );\n\n      // If a node exists at the index, select it\n      if (tree.flattened[index]) {\n        dispatch({type: 'set tab index key', payload: index});\n        updateGhostRow({\n          ref: clickedGhostRowRef,\n          tabIndexKey: index,\n          scrollTop: latestStateRef.current.scrollTop,\n          rowHeight: props.rowHeight,\n          interaction: 'active',\n          theme,\n        });\n      }\n    };\n\n    // Because nodes dont span the full width, it's possible for users to\n    // click on a node at the far right end which is outside of the row width.\n    // In that case, check if the top position where the user clicked overlaps\n    // with a row and select that row.\n    const handleMouseMove = (evt: MouseEvent) => {\n      if (evt.target !== scrollContainer) {\n        // user clicked on an element inside the container, defer to onClick\n        return;\n      }\n\n      const rect = (evt.target as HTMLDivElement).getBoundingClientRect();\n      const index = Math.floor(\n        (latestStateRef.current.scrollTop + evt.clientY - rect.top) / props.rowHeight\n      );\n\n      cleanupAllHoveredRows();\n      const element = latestItemsRef.current.find(item => item.key === index);\n      if (element?.ref) {\n        element.ref.dataset.hovered = 'true';\n      }\n\n      // If a node exists at the index, select it, else clear whatever is selected\n      if (tree.flattened[index] && index !== latestStateRef.current.tabIndexKey) {\n        updateGhostRow({\n          ref: hoveredGhostRowRef,\n          tabIndexKey: index,\n          scrollTop: latestStateRef.current.scrollTop,\n          rowHeight: props.rowHeight,\n          interaction: 'hover',\n          theme,\n        });\n      } else {\n        hideGhostRow({\n          ref: hoveredGhostRowRef,\n        });\n      }\n    };\n\n    scrollContainer.addEventListener('click', handleClick);\n    scrollContainer.addEventListener('mousemove', handleMouseMove);\n\n    return () => {\n      scrollContainer.removeEventListener('click', handleClick);\n      scrollContainer.removeEventListener('mousemove', handleMouseMove);\n    };\n  }, [\n    props.rowHeight,\n    props.scrollContainer,\n    tree.flattened,\n    cleanupAllHoveredRows,\n    theme,\n  ]);\n\n  // When mouseleave is triggered on the contianer,\n  // we need to hide the ghost row to avoid an orphaned row\n  useEffect(() => {\n    const container = props.scrollContainer;\n    if (!container) {\n      return undefined;\n    }\n\n    function onMouseLeave() {\n      cleanupAllHoveredRows();\n      hideGhostRow({\n        ref: hoveredGhostRowRef,\n      });\n    }\n    container.addEventListener('mouseleave', onMouseLeave, {\n      passive: true,\n    });\n\n    return () => {\n      container.removeEventListener('mouseleave', onMouseLeave);\n    };\n  }, [cleanupAllHoveredRows, props.scrollContainer]);\n\n  // When a node is expanded, the underlying tree is recomputed (the flattened tree is updated)\n  // We copy the properties of the old tree by creating a new instance of VirtualizedTree\n  // and passing in the roots and its flattened representation so that no extra work is done.\n  const handleExpandTreeNode = useCallback(\n    (node: VirtualizedTreeNode<T>, opts?: {expandChildren: boolean}) => {\n      // When we expand nodes, tree.expand will mutate the underlying tree which then\n      // gets copied to the new tree instance. To get the right index, we need to read\n      // it before any mutations are made\n      const previousNode = latestStateRef.current.tabIndexKey\n        ? tree.flattened[latestStateRef.current.tabIndexKey] ?? null\n        : null;\n\n      tree.expandNode(node, !node.expanded, opts);\n      const newTree = new VirtualizedTree(tree.roots, tree.flattened);\n      expandedHistory.current = newTree.getAllExpandedNodes(new Set());\n\n      // Hide or update the ghost if necessary\n      const tabIndex = findCarryOverIndex(previousNode, newTree);\n      if (tabIndex === null) {\n        hideGhostRow({ref: clickedGhostRowRef});\n      } else {\n        updateGhostRow({\n          ref: clickedGhostRowRef,\n          tabIndexKey: tabIndex,\n          scrollTop: Math.max(latestStateRef.current.scrollTop, 0),\n          interaction: 'active',\n          rowHeight: props.rowHeight,\n          theme,\n        });\n      }\n\n      dispatch({type: 'set tab index key', payload: tabIndex});\n      setTree(newTree);\n    },\n    [tree, props.rowHeight, theme]\n  );\n\n  // When a tree is sorted, we sort all of the nodes in the tree and not just the visible ones\n  // We could probably optimize this to lazily sort as we scroll, but since we want the least amount\n  // of work during scrolling, we just sort the entire tree every time.\n  const handleSortingChange = useCallback(\n    (sortFn: (a: VirtualizedTreeNode<T>, b: VirtualizedTreeNode<T>) => number) => {\n      // When we sort nodes, tree.sort will mutate the underlying tree which then\n      // gets copied to the new tree instance. To get the right index, we need to read\n      // it before any mutations are made\n      const previousNode = latestStateRef.current.tabIndexKey\n        ? tree.flattened[latestStateRef.current.tabIndexKey] ?? null\n        : null;\n\n      tree.sort(sortFn);\n      const newTree = new VirtualizedTree(tree.roots, tree.flattened);\n\n      // Hide or update the ghost if necessary\n      const tabIndex = findCarryOverIndex(previousNode, newTree);\n      if (tabIndex === null) {\n        hideGhostRow({ref: clickedGhostRowRef});\n      } else {\n        updateGhostRow({\n          ref: clickedGhostRowRef,\n          tabIndexKey: tabIndex,\n          scrollTop: Math.max(latestStateRef.current.scrollTop, 0),\n          interaction: 'active',\n          rowHeight: props.rowHeight,\n          theme,\n        });\n      }\n\n      dispatch({type: 'set tab index key', payload: tabIndex});\n      setTree(newTree);\n    },\n    [tree, props.rowHeight, theme]\n  );\n\n  // When a row is clicked, we update the selected node\n  const handleRowClick = useCallback(\n    (tabIndexKey: number) => {\n      return (_evt: React.MouseEvent<HTMLElement>) => {\n        dispatch({type: 'set tab index key', payload: tabIndexKey});\n        updateGhostRow({\n          ref: clickedGhostRowRef,\n          tabIndexKey,\n          scrollTop: state.scrollTop,\n          rowHeight: props.rowHeight,\n          interaction: 'active',\n          theme,\n        });\n      };\n    },\n    [state.scrollTop, props.rowHeight, theme]\n  );\n\n  // Keyboard navigation for row\n  const handleRowKeyDown = useCallback(\n    (event: React.KeyboardEvent) => {\n      if (latestStateRef.current.tabIndexKey === null) {\n        return;\n      }\n\n      // Cant move anywhere if there are no nodes\n      if (!tree.flattened.length) {\n        return;\n      }\n\n      if (event.key === 'Enter') {\n        handleExpandTreeNode(tree.flattened[latestStateRef.current.tabIndexKey], {\n          expandChildren: true,\n        });\n      }\n\n      if (event.key === 'ArrowDown') {\n        event.preventDefault();\n\n        if (event.metaKey || event.ctrlKey) {\n          const index = tree.flattened.length - 1;\n\n          props.scrollContainer!.scrollTo({\n            // We need to offset for the scrollMargin\n            top: index * props.rowHeight + props.rowHeight,\n          });\n          dispatch({type: 'set tab index key', payload: index});\n          updateGhostRow({\n            ref: clickedGhostRowRef,\n            tabIndexKey: index,\n            scrollTop: latestStateRef.current.scrollTop,\n            rowHeight: props.rowHeight,\n            interaction: 'active',\n            theme,\n          });\n          return;\n        }\n\n        // This is fine because we are only searching visible items\n        // and not the entire tree of nodes\n        const indexInVisibleItems = items.findIndex(\n          i => i.key === latestStateRef.current.tabIndexKey\n        );\n\n        if (indexInVisibleItems !== -1) {\n          const nextIndex = indexInVisibleItems + 1;\n\n          // Bounds check if we are at end of list\n          if (nextIndex > tree.flattened.length - 1) {\n            return;\n          }\n\n          dispatch({type: 'set tab index key', payload: items[nextIndex].key});\n          updateGhostRow({\n            ref: clickedGhostRowRef,\n            tabIndexKey: items[nextIndex].key,\n            scrollTop: latestStateRef.current.scrollTop,\n            rowHeight: props.rowHeight,\n            interaction: 'active',\n            theme,\n          });\n          items[nextIndex].ref?.focus({preventScroll: true});\n          items[nextIndex].ref?.scrollIntoView({block: 'nearest'});\n        }\n      }\n\n      if (event.key === 'ArrowUp') {\n        event.preventDefault();\n\n        if (event.metaKey || event.ctrlKey) {\n          props.scrollContainer!.scrollTo({top: 0});\n          dispatch({type: 'set tab index key', payload: 0});\n          updateGhostRow({\n            ref: clickedGhostRowRef,\n            tabIndexKey: 0,\n            scrollTop: latestStateRef.current.scrollTop,\n            rowHeight: props.rowHeight,\n            interaction: 'active',\n            theme,\n          });\n          return;\n        }\n\n        // This is fine because we are only searching visible items\n        // and not the entire tree of nodes\n        const indexInVisibleItems = items.findIndex(\n          i => i.key === latestStateRef.current.tabIndexKey\n        );\n\n        if (indexInVisibleItems !== -1) {\n          const nextIndex = indexInVisibleItems - 1;\n\n          // Bound check if we are at start of list\n          if (nextIndex < 0) {\n            return;\n          }\n\n          dispatch({type: 'set tab index key', payload: items[nextIndex].key});\n          updateGhostRow({\n            ref: clickedGhostRowRef,\n            tabIndexKey: items[nextIndex].key,\n            scrollTop: latestStateRef.current.scrollTop,\n            rowHeight: props.rowHeight,\n            interaction: 'active',\n            theme,\n          });\n          items[nextIndex].ref?.focus({preventScroll: true});\n          items[nextIndex].ref?.scrollIntoView({block: 'nearest'});\n        }\n      }\n    },\n    [\n      handleExpandTreeNode,\n      items,\n      tree.flattened,\n      props.rowHeight,\n      props.scrollContainer,\n      theme,\n    ]\n  );\n\n  // When a row is hovered, we update the ghost row\n  const handleRowMouseEnter = useCallback(\n    (key: number) => {\n      return (_evt: React.MouseEvent<HTMLElement>) => {\n        if (previousHoveredRow.current !== key) {\n          cleanupAllHoveredRows();\n\n          (_evt.currentTarget as HTMLElement).dataset.hovered = 'true';\n          previousHoveredRow.current = key;\n        }\n        updateGhostRow({\n          ref: hoveredGhostRowRef,\n          tabIndexKey: key,\n          scrollTop: state.scrollTop,\n          rowHeight: props.rowHeight,\n          interaction: 'hover',\n          theme,\n        });\n      };\n    },\n    [state.scrollTop, props.rowHeight, cleanupAllHoveredRows, theme]\n  );\n\n  // Register a resize observer for when the scroll container is resized.\n  // When the container is resized, update the scroll height in our state.\n  // Similarly to handleScroll, we use requestAnimationFrame to avoid overupdating the UI\n  useEffect(() => {\n    if (!props.scrollContainer) {\n      return undefined;\n    }\n    let rafId: number | undefined;\n    const resizeObserver = new window.ResizeObserver(elements => {\n      rafId = window.requestAnimationFrame(() => {\n        dispatch({\n          type: 'set scroll height',\n          payload: elements[0]?.contentRect?.height ?? 0,\n        });\n        cleanupAllHoveredRows();\n        hideGhostRow({\n          ref: hoveredGhostRowRef,\n        });\n      });\n    });\n\n    resizeObserver.observe(props.scrollContainer);\n\n    return () => {\n      if (typeof rafId === 'number') {\n        window.cancelAnimationFrame(rafId);\n      }\n      resizeObserver.disconnect();\n    };\n  }, [props.scrollContainer, cleanupAllHoveredRows]);\n\n  // Basic required styles for the scroll container\n  const scrollContainerStyles: React.CSSProperties = useMemo(() => {\n    return {\n      height: '100%',\n      overflow: 'auto',\n      position: 'relative',\n      willChange: 'transform',\n    };\n  }, []);\n\n  // Basic styles for the element container. We fake the height so that the\n  // scrollbar is sized according to the number of items in the list.\n  const containerStyles: React.CSSProperties = useMemo(() => {\n    const height = tree.flattened.length * props.rowHeight;\n    return {height, maxHeight: height};\n  }, [tree.flattened.length, props.rowHeight]);\n\n  const renderRow = props.renderRow;\n  const renderedItems: React.ReactNode[] = useMemo(() => {\n    const renderered: React.ReactNode[] = [];\n\n    // It is important that we do not create a copy of item\n    // because refs will assign the dom node to the item.\n    // If we map, we get a new object that our internals will not be able to access.\n    for (let i = 0; i < items.length; i++) {\n      const item = items[i];\n      renderered.push(\n        renderRow(item, {\n          handleRowClick: handleRowClick(item.key),\n          handleExpandTreeNode,\n          handleRowKeyDown,\n          handleRowMouseEnter: handleRowMouseEnter(item.key),\n          tabIndexKey: state.tabIndexKey,\n        })\n      );\n    }\n\n    return renderered;\n  }, [\n    items,\n    handleRowClick,\n    handleRowKeyDown,\n    state.tabIndexKey,\n    handleRowMouseEnter,\n    handleExpandTreeNode,\n    renderRow,\n  ]);\n\n  // Register a resize observer for when the scroll container is resized.\n  // When the container is resized, update the scroll height in our state.\n  // Similarly to handleScroll, we use requestAnimationFrame to avoid overupdating the UI\n  useEffect(() => {\n    if (!props.scrollContainer) {\n      return undefined;\n    }\n    let rafId: number | undefined;\n    const resizeObserver = new window.ResizeObserver(elements => {\n      rafId = window.requestAnimationFrame(() => {\n        dispatch({\n          type: 'set scroll height',\n          payload: elements[0]?.contentRect?.height ?? 0,\n        });\n      });\n    });\n\n    resizeObserver.observe(props.scrollContainer);\n\n    return () => {\n      if (typeof rafId === 'number') {\n        window.cancelAnimationFrame(rafId);\n      }\n      resizeObserver.disconnect();\n    };\n  }, [props.scrollContainer]);\n\n  return {\n    tree,\n    items,\n    renderedItems,\n    tabIndexKey: state.tabIndexKey,\n    dispatch,\n    handleRowClick,\n    handleRowKeyDown,\n    handleRowMouseEnter,\n    handleExpandTreeNode,\n    handleSortingChange,\n    scrollContainerStyles,\n    containerStyles,\n    clickedGhostRowRef,\n    hoveredGhostRowRef,\n  };\n}\n","import {mat3, vec2} from 'gl-matrix';\n\nimport {Flamegraph} from '../flamegraph';\nimport {FlamegraphSearch} from '../flamegraph/flamegraphStateProvider/flamegraphSearch';\nimport {FlamegraphTheme} from '../flamegraph/flamegraphTheme';\nimport {FlamegraphFrame, getFlamegraphFrameSearchId} from '../flamegraphFrame';\nimport {\n  createProgram,\n  createShader,\n  getContext,\n  makeProjectionMatrix,\n  Rect,\n  resizeCanvasToDisplaySize,\n} from '../gl/utils';\n\nimport {fragment, vertex} from './shaders';\n\nclass FlamegraphRenderer {\n  canvas: HTMLCanvasElement | null;\n  flamegraph: Flamegraph;\n\n  gl: WebGLRenderingContext | null = null;\n  program: WebGLProgram | null = null;\n\n  theme: FlamegraphTheme;\n  frames: ReadonlyArray<FlamegraphFrame> = [];\n  roots: ReadonlyArray<FlamegraphFrame> = [];\n\n  // Vertex and color buffer\n  positions: Array<number> = [];\n  bounds: Array<number> = [];\n  colors: Array<number> = [];\n\n  colorMap: Map<string | number, number[]> = new Map();\n\n  lastDragPosition: vec2 | null = null;\n\n  attributes: {\n    a_bounds: number | null;\n    a_color: number | null;\n    a_position: number | null;\n  } = {\n    a_position: null,\n    a_color: null,\n    a_bounds: null,\n  };\n\n  uniforms: {\n    u_border_width: WebGLUniformLocation | null;\n    u_draw_border: WebGLUniformLocation | null;\n    u_is_search_result: WebGLUniformLocation | null;\n    u_model: WebGLUniformLocation | null;\n    u_projection: WebGLUniformLocation | null;\n  } = {\n    u_border_width: null,\n    u_draw_border: null,\n    u_is_search_result: null,\n    u_model: null,\n    u_projection: null,\n  };\n\n  options: {\n    draw_border: boolean;\n  };\n\n  constructor(\n    canvas: HTMLCanvasElement,\n    flamegraph: Flamegraph,\n    theme: FlamegraphTheme,\n    options: {draw_border: boolean} = {draw_border: false}\n  ) {\n    this.flamegraph = flamegraph;\n    this.canvas = canvas;\n    this.theme = theme;\n    this.options = options;\n\n    this.init();\n  }\n\n  init(): void {\n    const VERTICES = 6;\n    const COLOR_COMPONENTS = 4;\n\n    this.colors = new Array(VERTICES * COLOR_COMPONENTS);\n    this.frames = [...this.flamegraph.frames];\n    this.roots = [...this.flamegraph.root.children];\n\n    // Generate colors for the flamegraph\n    const {colorBuffer, colorMap} = this.theme.COLORS.STACK_TO_COLOR(\n      this.frames,\n      this.theme.COLORS.COLOR_MAP,\n      this.theme.COLORS.COLOR_BUCKET\n    );\n\n    this.colorMap = colorMap;\n    this.colors = colorBuffer;\n\n    this.initCanvasContext();\n    this.initVertices();\n    this.initShaders();\n  }\n\n  initVertices(): void {\n    const POSITIONS_PER_PASS = 2;\n    const BOUNDS_PER_PASS = 4;\n    const VERTICES = 6;\n\n    this.bounds = new Array(VERTICES * BOUNDS_PER_PASS * this.frames.length);\n    this.positions = new Array(VERTICES * POSITIONS_PER_PASS * this.frames.length);\n\n    const length = this.frames.length;\n\n    for (let index = 0; index < length; index++) {\n      const frame = this.frames[index];\n\n      const x1 = frame.start;\n      const x2 = frame.end;\n      const y1 = frame.depth;\n      const y2 = frame.depth + 1;\n\n      // top left -> top right -> bottom left ->\n      // bottom left -> top right -> bottom right\n      const positionOffset = index * 12;\n\n      this.positions[positionOffset] = x1;\n      this.positions[positionOffset + 1] = y1;\n      this.positions[positionOffset + 2] = x2;\n      this.positions[positionOffset + 3] = y1;\n      this.positions[positionOffset + 4] = x1;\n      this.positions[positionOffset + 5] = y2;\n      this.positions[positionOffset + 6] = x1;\n      this.positions[positionOffset + 7] = y2;\n      this.positions[positionOffset + 8] = x2;\n      this.positions[positionOffset + 9] = y1;\n      this.positions[positionOffset + 10] = x2;\n      this.positions[positionOffset + 11] = y2;\n\n      // @TODO check if we can pack bounds across vertex calls,\n      // we are allocating 6x the amount of memory here\n      const boundsOffset = index * VERTICES * BOUNDS_PER_PASS;\n\n      for (let i = 0; i < VERTICES; i++) {\n        const offset = boundsOffset + i * BOUNDS_PER_PASS;\n\n        this.bounds[offset] = x1;\n        this.bounds[offset + 1] = y1;\n        this.bounds[offset + 2] = x2;\n        this.bounds[offset + 3] = y2;\n      }\n    }\n  }\n\n  initCanvasContext(): void {\n    if (!this.canvas) {\n      throw new Error('Cannot initialize context from null canvas');\n    }\n    // Setup webgl canvas context\n    this.gl = getContext(this.canvas, 'webgl');\n\n    if (!this.gl) {\n      throw new Error('Uninitialized WebGL context');\n    }\n\n    this.gl.enable(this.gl.BLEND);\n    this.gl.blendFuncSeparate(\n      this.gl.SRC_ALPHA,\n      this.gl.ONE_MINUS_SRC_ALPHA,\n      this.gl.ONE,\n      this.gl.ONE_MINUS_SRC_ALPHA\n    );\n    resizeCanvasToDisplaySize(this.canvas);\n  }\n\n  initShaders(): void {\n    if (!this.gl) {\n      throw new Error('Uninitialized WebGL context');\n    }\n\n    // @ts-ignore\n    this.uniforms = {};\n    // @ts-ignore\n    this.attributes = {};\n\n    const vertexShader = createShader(this.gl, this.gl.VERTEX_SHADER, vertex());\n\n    const fragmentShader = createShader(\n      this.gl,\n      this.gl.FRAGMENT_SHADER,\n      fragment(this.theme)\n    );\n\n    // create program\n    this.program = createProgram(this.gl, vertexShader, fragmentShader);\n\n    const uProjectionMatrix = this.gl.getUniformLocation(this.program, 'u_projection');\n    const uModelMatrix = this.gl.getUniformLocation(this.program, 'u_model');\n    const uIsSearchResult = this.gl.getUniformLocation(\n      this.program,\n      'u_is_search_result'\n    );\n    const uBorderWidth = this.gl.getUniformLocation(this.program, 'u_border_width');\n    const uDrawBorder = this.gl.getUniformLocation(this.program, 'u_draw_border');\n\n    if (!uProjectionMatrix) {\n      throw new Error('Could not locate u_projection in shader');\n    }\n    if (!uModelMatrix) {\n      throw new Error('Could not locate u_model in shader');\n    }\n    if (!uIsSearchResult) {\n      throw new Error('Could not locate u_is_search_result in shader');\n    }\n    if (!uBorderWidth) {\n      throw new Error('Could not locate u_border_width in shader');\n    }\n    if (!uDrawBorder) {\n      throw new Error('Could not locate u_draw_border in shader');\n    }\n\n    this.uniforms.u_projection = uProjectionMatrix;\n    this.uniforms.u_model = uModelMatrix;\n    this.uniforms.u_is_search_result = uIsSearchResult;\n    this.uniforms.u_border_width = uBorderWidth;\n    this.uniforms.u_draw_border = uDrawBorder;\n\n    {\n      const aColorAttributeLocation = this.gl.getAttribLocation(this.program, 'a_color');\n\n      if (aColorAttributeLocation === -1) {\n        throw new Error('Could not locate a_color in shader');\n      }\n\n      // attributes get data from buffers\n      this.attributes.a_color = aColorAttributeLocation;\n\n      // Init color buffer\n      const colorBuffer = this.gl.createBuffer();\n\n      // Bind it to ARRAY_BUFFER (think of it as ARRAY_BUFFER = colorBuffer)\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, colorBuffer);\n      this.gl.bufferData(\n        this.gl.ARRAY_BUFFER,\n        new Float32Array(this.colors),\n        this.gl.STATIC_DRAW\n      );\n\n      const size = 4;\n      const type = this.gl.FLOAT;\n      const normalize = false;\n      const stride = 0;\n      const offset = 0;\n\n      this.gl.vertexAttribPointer(\n        aColorAttributeLocation,\n        size,\n        type,\n        normalize,\n        stride,\n        offset\n      );\n      // Point to attribute location\n      this.gl.enableVertexAttribArray(aColorAttributeLocation);\n    }\n    {\n      // look up where the vertex data needs to go.\n      const aPositionAttributeLocation = this.gl.getAttribLocation(\n        this.program,\n        'a_position'\n      );\n\n      if (aPositionAttributeLocation === -1) {\n        throw new Error('Could not locate a_color in shader');\n      }\n\n      // attributes get data from buffers\n      this.attributes.a_position = aPositionAttributeLocation;\n\n      // Init position buffer\n      const positionBuffer = this.gl.createBuffer();\n\n      // Bind it to ARRAY_BUFFER (think of it as ARRAY_BUFFER = positionBuffer)\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, positionBuffer);\n      this.gl.bufferData(\n        this.gl.ARRAY_BUFFER,\n        new Float32Array(this.positions),\n        this.gl.STATIC_DRAW\n      );\n      const size = 2;\n      const type = this.gl.FLOAT;\n      const normalize = false;\n      const stride = 0;\n      const offset = 0;\n\n      this.gl.vertexAttribPointer(\n        aPositionAttributeLocation,\n        size,\n        type,\n        normalize,\n        stride,\n        offset\n      );\n      // Point to attribute location\n      this.gl.enableVertexAttribArray(aPositionAttributeLocation);\n    }\n\n    {\n      // look up where the bounds vertices needs to go.\n      const aBoundsAttributeLocation = this.gl.getAttribLocation(\n        this.program,\n        'a_bounds'\n      );\n\n      if (aBoundsAttributeLocation === -1) {\n        throw new Error('Could not locate a_color in shader');\n      }\n\n      // attributes get data from buffers\n      this.attributes.a_bounds = aBoundsAttributeLocation;\n\n      // Init bounds buffer\n      const boundsBuffer = this.gl.createBuffer();\n\n      // Bind it to ARRAY_BUFFER (think of it as ARRAY_BUFFER = boundsBuffer)\n      this.gl.bindBuffer(this.gl.ARRAY_BUFFER, boundsBuffer);\n      this.gl.bufferData(\n        this.gl.ARRAY_BUFFER,\n        new Float32Array(this.bounds),\n        this.gl.STATIC_DRAW\n      );\n      const size = 4;\n      const type = this.gl.FLOAT;\n      const normalize = false;\n      const stride = 0;\n      const offset = 0;\n\n      this.gl.vertexAttribPointer(\n        aBoundsAttributeLocation,\n        size,\n        type,\n        normalize,\n        stride,\n        offset\n      );\n      // Point to attribute location\n      this.gl.enableVertexAttribArray(aBoundsAttributeLocation);\n    }\n\n    // Use shader program\n    this.gl.useProgram(this.program);\n  }\n\n  getColorForFrame(frame: FlamegraphFrame): number[] {\n    return this.colorMap.get(frame.key) ?? this.theme.COLORS.FRAME_FALLBACK_COLOR;\n  }\n\n  getHoveredNode(configSpaceCursor: vec2): FlamegraphFrame | null {\n    let hoveredNode: FlamegraphFrame | null = null;\n\n    const findHoveredNode = (frame: FlamegraphFrame, depth: number) => {\n      // This is outside\n      if (hoveredNode) {\n        return;\n      }\n\n      const frameRect = new Rect(frame.start, frame.depth, frame.end - frame.start, 1);\n\n      // We treat entire flamegraph as a segment tree, this allows us to query in O(log n) time by\n      // only looking at the nodes that are relevant to the current cursor position. We discard any values\n      // on x axis that do not overlap the cursor, and descend until we find a node that overlaps at cursor y position\n      if (!frameRect.containsX(configSpaceCursor)) {\n        return;\n      }\n\n      // If our frame depth overlaps cursor y position, we have found our node\n      if (frameRect.containsY(configSpaceCursor)) {\n        hoveredNode = frame;\n        return;\n      }\n\n      // Descend into the rest of the children\n      for (let i = 0; i < frame.children.length; i++) {\n        findHoveredNode(frame.children[i], depth + 1);\n      }\n    };\n\n    for (let i = 0; i < this.roots.length; i++) {\n      findHoveredNode(this.roots[i], 0);\n    }\n\n    return hoveredNode;\n  }\n\n  draw(\n    configViewToPhysicalSpace: mat3,\n    searchResults: FlamegraphSearch['results']\n  ): void {\n    if (!this.gl) {\n      throw new Error('Uninitialized WebGL context');\n    }\n\n    this.gl.clearColor(0, 0, 0, 0);\n    this.gl.clear(this.gl.COLOR_BUFFER_BIT);\n\n    // We have no frames to draw\n    if (!this.positions.length) {\n      return;\n    }\n\n    this.gl.useProgram(this.program);\n\n    const projectionMatrix = makeProjectionMatrix(\n      this.gl.canvas.width,\n      this.gl.canvas.height\n    );\n\n    // Projection matrix\n    this.gl.uniformMatrix3fv(this.uniforms.u_projection, false, projectionMatrix);\n\n    // Model to projection\n    this.gl.uniformMatrix3fv(this.uniforms.u_model, false, configViewToPhysicalSpace);\n\n    // Check if we should draw border\n    this.gl.uniform1i(this.uniforms.u_draw_border, this.options.draw_border ? 1 : 0);\n\n    // Tell webgl to convert clip space to px\n    this.gl.viewport(0, 0, this.gl.canvas.width, this.gl.canvas.height);\n\n    const physicalSpacePixel = new Rect(0, 0, 1, 1);\n    const physicalToConfig = mat3.invert(mat3.create(), configViewToPhysicalSpace);\n    const configSpacePixel = physicalSpacePixel.transformRect(physicalToConfig);\n\n    this.gl.uniform2f(\n      this.uniforms.u_border_width,\n      configSpacePixel.width,\n      configSpacePixel.height\n    );\n\n    const VERTICES = 6;\n\n    const length = this.frames.length;\n    let frame: FlamegraphFrame | null;\n\n    // This is an optimization to avoid setting uniform1i for each draw call when user is not searching\n    if (searchResults.size > 0) {\n      for (let i = 0; i < length; i++) {\n        frame = this.frames[i];\n        const vertexOffset = i * VERTICES;\n        this.gl.uniform1i(\n          this.uniforms.u_is_search_result,\n          searchResults.has(getFlamegraphFrameSearchId(frame)) ? 1 : 0\n        );\n        this.gl.drawArrays(this.gl.TRIANGLES, vertexOffset, VERTICES);\n      }\n    } else {\n      this.gl.uniform1i(this.uniforms.u_is_search_result, 0);\n      for (let i = 0; i < length; i++) {\n        const vertexOffset = i * VERTICES;\n\n        this.gl.drawArrays(this.gl.TRIANGLES, vertexOffset, VERTICES);\n      }\n    }\n  }\n}\n\nexport {FlamegraphRenderer};\n","import {mat3} from 'gl-matrix';\n\nimport {FlamegraphTheme} from '../flamegraph/flamegraphTheme';\nimport {getContext, measureText, Rect} from '../gl/utils';\n\nexport function getIntervalTimeAtX(logicalSpaceToConfigView: mat3, x: number): number {\n  const vector = logicalSpaceToConfigView[0] * x + logicalSpaceToConfigView[6];\n\n  if (vector > 1) {\n    return Math.round(vector);\n  }\n\n  return Math.round(vector * 10) / 10;\n}\n\nexport function computeInterval(\n  configView: Rect,\n  logicalSpaceToConfigView: mat3\n): number[] {\n  // We want to draw an interval every 200px, this is similar to how speedscope draws it and it works well\n  // (both visually pleasing and precise enough). It is pretty much identical to what speedscope does with\n  // the safeguards for the intervals being too small.\n  const target = 200;\n  // Compute x at 200 and subtract left, so we have the interval\n  const targetInterval =\n    getIntervalTimeAtX(logicalSpaceToConfigView, target) - configView.left;\n\n  const minInterval = Math.pow(10, Math.floor(Math.log10(targetInterval)));\n  let interval = minInterval;\n\n  if (targetInterval / interval > 5) {\n    interval *= 5;\n  } else if (targetInterval / interval > 2) {\n    interval *= 2;\n  }\n\n  let x = Math.ceil(configView.left / interval) * interval;\n  const intervals: number[] = [];\n\n  while (x <= configView.right) {\n    intervals.push(x);\n    x += interval;\n  }\n\n  return intervals;\n}\n\nclass GridRenderer {\n  canvas: HTMLCanvasElement;\n  context: CanvasRenderingContext2D;\n  theme: FlamegraphTheme;\n\n  formatter: (value: number) => string;\n\n  constructor(\n    canvas: HTMLCanvasElement,\n    theme: FlamegraphTheme,\n    formatter: (value: number) => string\n  ) {\n    this.canvas = canvas;\n    this.theme = theme;\n    this.formatter = formatter;\n\n    this.context = getContext(canvas, '2d');\n  }\n\n  draw(\n    configViewSpace: Rect,\n    physicalViewRect: Rect,\n    configViewToPhysicalSpace: mat3,\n    logicalSpaceToConfigView: mat3,\n    context: CanvasRenderingContext2D = this.context\n  ): void {\n    context.font = `${this.theme.SIZES.LABEL_FONT_SIZE * window.devicePixelRatio}px ${\n      this.theme.FONTS.FONT\n    }`;\n    context.textBaseline = 'top';\n    context.lineWidth = this.theme.SIZES.GRID_LINE_WIDTH / 2;\n\n    // Draw the background of the top timeline\n    context.fillStyle = this.theme.COLORS.GRID_FRAME_BACKGROUND_COLOR;\n    context.fillRect(\n      0,\n      this.theme.SIZES.GRID_LINE_WIDTH,\n      physicalViewRect.width,\n      this.theme.SIZES.LABEL_FONT_SIZE * window.devicePixelRatio +\n        this.theme.SIZES.LABEL_FONT_PADDING * window.devicePixelRatio * 2 -\n        this.theme.SIZES.LABEL_FONT_PADDING\n    );\n\n    // Draw top timeline lines\n    context.fillStyle = this.theme.COLORS.GRID_LINE_COLOR;\n    context.fillRect(0, 0, physicalViewRect.width, this.theme.SIZES.GRID_LINE_WIDTH / 2);\n    context.fillRect(\n      0,\n      this.theme.SIZES.TIMELINE_HEIGHT * window.devicePixelRatio,\n      physicalViewRect.width,\n      this.theme.SIZES.GRID_LINE_WIDTH / 2\n    );\n\n    const intervals = computeInterval(configViewSpace, logicalSpaceToConfigView);\n\n    for (let i = 0; i < intervals.length; i++) {\n      // Compute the x position of our interval from config space to physical\n      const physicalIntervalPosition = Math.round(\n        intervals[i] * configViewToPhysicalSpace[0] + configViewToPhysicalSpace[6]\n      );\n\n      // Format the label text\n      const labelText = this.formatter(intervals[i]);\n\n      context.fillStyle = this.theme.COLORS.LABEL_FONT_COLOR;\n      // Subtract width of the text and padding so that the text is align to the left of our interval\n      context.fillText(\n        labelText,\n        physicalIntervalPosition -\n          measureText(labelText, context).width -\n          this.theme.SIZES.LABEL_FONT_PADDING * window.devicePixelRatio,\n        this.theme.SIZES.LABEL_FONT_PADDING * window.devicePixelRatio\n      );\n\n      // Draw the vertical grid line\n      context.strokeStyle = this.theme.COLORS.GRID_LINE_COLOR;\n      context.strokeRect(\n        physicalIntervalPosition - this.theme.SIZES.GRID_LINE_WIDTH / 2,\n        physicalViewRect.y,\n        this.theme.SIZES.GRID_LINE_WIDTH / 2,\n        physicalViewRect.height\n      );\n    }\n  }\n}\n\nexport {GridRenderer};\n","import {mat3} from 'gl-matrix';\n\nimport {FlamegraphTheme} from '../flamegraph/flamegraphTheme';\nimport {getContext, Rect} from '../gl/utils';\n\nclass PositionIndicatorRenderer {\n  canvas: HTMLCanvasElement;\n  context: CanvasRenderingContext2D;\n  theme: FlamegraphTheme;\n\n  constructor(canvas: HTMLCanvasElement, theme: FlamegraphTheme) {\n    this.canvas = canvas;\n    this.theme = theme;\n\n    this.context = getContext(this.canvas, '2d');\n  }\n\n  draw(configView: Rect, configSpace: Rect, configSpaceToPhysicalSpace: mat3): void {\n    if (configView.equals(configSpace)) {\n      // User is not zoomed in or entire chart fits in view,\n      // then we dont need to draw anything.\n      return;\n    }\n\n    // Transform both views to their respective physical spaces\n    const physicalConfigViewRect = Rect.From(configView).transformRect(\n      configSpaceToPhysicalSpace\n    );\n\n    const physicalConfigRect = Rect.From(configSpace).transformRect(\n      configSpaceToPhysicalSpace\n    );\n\n    const offsetRectForBorderWidth: [number, number, number, number] = [\n      physicalConfigViewRect.x - this.theme.SIZES.MINIMAP_POSITION_OVERLAY_BORDER_WIDTH,\n      physicalConfigViewRect.y,\n      physicalConfigViewRect.width +\n        this.theme.SIZES.MINIMAP_POSITION_OVERLAY_BORDER_WIDTH,\n      physicalConfigViewRect.height,\n    ];\n\n    // What we do to draw the \"window\" that the user is currently watching is we draw two rectangles, the\n    // zoomed in view and the zoomed out view. The zoomed out view is the full view of the flamegraph, and the zoom\n    // in view is whatever the user is currently looking at. Because the zoomed in view is a subset of the zoomed,\n    // we just need to use the evenodd fill rule to paint inbetween the two rectangles.\n    this.context.fillStyle = this.theme.COLORS.MINIMAP_POSITION_OVERLAY_COLOR;\n    this.context.strokeStyle = this.theme.COLORS.MINIMAP_POSITION_OVERLAY_BORDER_COLOR;\n    this.context.lineWidth = this.theme.SIZES.MINIMAP_POSITION_OVERLAY_BORDER_WIDTH;\n\n    this.context.beginPath();\n    this.context.rect(0, 0, physicalConfigRect.width, physicalConfigRect.height);\n    this.context.rect(...offsetRectForBorderWidth);\n\n    this.context.fill('evenodd');\n    this.context.strokeRect(...offsetRectForBorderWidth);\n  }\n}\n\nexport {PositionIndicatorRenderer};\n","import {mat3} from 'gl-matrix';\n\nimport {Flamegraph} from '../flamegraph';\nimport {FlamegraphTheme} from '../flamegraph/flamegraphTheme';\nimport {getContext, Rect} from '../gl/utils';\n\nfunction computeAbsoluteSampleTimestamps(startedAt: number, weights: readonly number[]) {\n  const timeline = [startedAt + weights[0]];\n  for (let i = 1; i < weights.length; i++) {\n    timeline.push(timeline[i - 1] + weights[i]);\n  }\n  return timeline;\n}\n\nclass SampleTickRenderer {\n  canvas: HTMLCanvasElement;\n  context: CanvasRenderingContext2D;\n  theme: FlamegraphTheme;\n  flamegraph: Flamegraph;\n  intervals: number[];\n\n  constructor(\n    canvas: HTMLCanvasElement,\n    flamegraph: Flamegraph,\n    configSpace: Rect,\n    theme: FlamegraphTheme\n  ) {\n    this.canvas = canvas;\n    this.flamegraph = flamegraph;\n    this.theme = theme;\n    this.intervals = computeAbsoluteSampleTimestamps(\n      configSpace.x,\n      this.flamegraph.profile.weights\n    );\n    this.context = getContext(canvas, '2d');\n  }\n\n  draw(\n    configViewToPhysicalSpace: mat3,\n    configView: Rect,\n    context: CanvasRenderingContext2D = this.context\n  ): void {\n    if (this.intervals.length === 0) {\n      return;\n    }\n\n    const height =\n      this.theme.SIZES.LABEL_FONT_SIZE * window.devicePixelRatio +\n      this.theme.SIZES.LABEL_FONT_PADDING * window.devicePixelRatio * 2 -\n      this.theme.SIZES.LABEL_FONT_PADDING;\n\n    context.strokeStyle = `rgba(${this.theme.COLORS.SAMPLE_TICK_COLOR.join(',')})`;\n    context.lineWidth = this.theme.SIZES.INTERNAL_SAMPLE_TICK_LINE_WIDTH;\n\n    for (let i = 0; i < this.intervals.length; i++) {\n      const interval = this.intervals[i];\n\n      if (interval < configView.left) {\n        continue;\n      }\n\n      if (interval > configView.right) {\n        break;\n      }\n\n      // Compute the x position of our interval from config space to physical\n      const physicalIntervalPosition = Math.round(\n        interval * configViewToPhysicalSpace[0] + configViewToPhysicalSpace[6]\n      );\n\n      context.strokeRect(physicalIntervalPosition, 0, 0, height);\n    }\n  }\n}\n\nexport {SampleTickRenderer};\n","import {mat3} from 'gl-matrix';\n\nimport {getContext, Rect} from '../gl/utils';\n\nclass SelectedFrameRenderer {\n  canvas: HTMLCanvasElement;\n  context: CanvasRenderingContext2D;\n\n  constructor(canvas: HTMLCanvasElement) {\n    this.canvas = canvas;\n    this.context = getContext(canvas, '2d');\n  }\n\n  // We allow for passing of different contexts, this allows us to use a\n  // single instance of the renderer to draw overlays on multiple canvases\n  draw(\n    frames: Rect[],\n    style: {BORDER_COLOR: string; BORDER_WIDTH: number},\n    configViewToPhysicalSpace: mat3,\n    context: CanvasRenderingContext2D = this.context\n  ): void {\n    context.strokeStyle = style.BORDER_COLOR;\n    context.lineWidth = style.BORDER_WIDTH;\n\n    for (let i = 0; i < frames.length; i++) {\n      const frameInPhysicalSpace = frames[i].transformRect(configViewToPhysicalSpace);\n\n      // We draw the border in the center of the flamegraph, so we need to increase\n      // the width by border width and negatively offset it by half the border width\n      const borderRect = frameInPhysicalSpace\n        .withWidth(frameInPhysicalSpace.width - style.BORDER_WIDTH)\n        .withHeight(frameInPhysicalSpace.height - style.BORDER_WIDTH)\n        .translate(\n          frameInPhysicalSpace.x + style.BORDER_WIDTH / 2,\n          frameInPhysicalSpace.y + style.BORDER_WIDTH / 2\n        );\n\n      context.beginPath();\n      context.strokeRect(borderRect.x, borderRect.y, borderRect.width, borderRect.height);\n    }\n  }\n}\n\nexport {SelectedFrameRenderer};\n","import {FlamegraphTheme} from '../flamegraph/flamegraphTheme';\n\nexport const vertex = () => `\nattribute vec2 a_position;\nattribute vec4 a_color;\nattribute vec4 a_bounds;\n\nuniform mat3 u_model;\nuniform mat3 u_projection;\n\nvarying lowp vec4 v_color;\nvarying vec2 v_pos;\nvarying vec4 v_bounds;\n\nvoid main() {\n  vec2 scaled = (u_model * vec3(a_position.xy, 1)).xy;\n  vec2 pos = (u_projection * vec3(scaled.xy, 1)).xy;\n\n  gl_Position = vec4(pos, 0.0, 1.0);\n\n  v_color = a_color;\n  v_pos = a_position.xy;\n  v_bounds = a_bounds;\n}\n`;\n\nexport const fragment = (theme: FlamegraphTheme) => `\n// fragment shaders don't have a default precision so we need\n// to pick one. mediump is a good default\nprecision mediump float;\n\nuniform bool u_is_search_result;\nuniform vec2 u_border_width;\nuniform bool u_draw_border;\n\nvarying lowp vec4 v_color;\nvarying vec4 v_bounds;\nvarying vec2 v_pos;\n\nvoid main() {\n  float minX = v_bounds.x + u_border_width.x;\n  float maxX = v_bounds.z - u_border_width.x;\n\n  float minY = v_bounds.y + u_border_width.y;\n  float maxY = v_bounds.y + 1.0 - u_border_width.y;\n\n  float width = maxX - minX;\n\n  if (u_is_search_result) {\n    gl_FragColor = ${theme.COLORS.SEARCH_RESULT_FRAME_COLOR};\n  } else if (u_draw_border) {\n    if(width <= u_border_width.x) {\n      if(v_pos.y > minY && v_pos.y < maxY){\n        gl_FragColor = vec4(v_color);\n      } else {\n        gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n      }\n    } else if (v_pos.x > minX && v_pos.x < maxX && v_pos.y > minY && v_pos.y < maxY) {\n      gl_FragColor = vec4(v_color);\n    } else {\n      gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);\n    }\n  } else {\n    gl_FragColor = vec4(v_color);\n  }\n}\n`;\n","import {mat3} from 'gl-matrix';\n\nimport {Flamegraph} from '../flamegraph';\nimport {FlamegraphSearch} from '../flamegraph/flamegraphStateProvider/flamegraphSearch';\nimport {FlamegraphTheme} from '../flamegraph/flamegraphTheme';\nimport {FlamegraphFrame, getFlamegraphFrameSearchId} from '../flamegraphFrame';\nimport {\n  computeHighlightedBounds,\n  ELLIPSIS,\n  findRangeBinarySearch,\n  getContext,\n  Rect,\n  resizeCanvasToDisplaySize,\n  trimTextCenter,\n} from '../gl/utils';\n\nconst TEST_STRING = 'Who knows if this changed, font-display: swap wont tell me';\n\nclass TextRenderer {\n  canvas: HTMLCanvasElement;\n  theme: FlamegraphTheme;\n  flamegraph: Flamegraph;\n  context: CanvasRenderingContext2D;\n  textCache: Record<string, TextMetrics>;\n\n  constructor(canvas: HTMLCanvasElement, flamegraph: Flamegraph, theme: FlamegraphTheme) {\n    this.canvas = canvas;\n    this.theme = theme;\n    this.flamegraph = flamegraph;\n\n    this.context = getContext(canvas, '2d');\n    this.textCache = {};\n    resizeCanvasToDisplaySize(canvas);\n  }\n\n  measureAndCacheText(text: string): TextMetrics {\n    if (this.textCache[text]) {\n      return this.textCache[text];\n    }\n    this.textCache[text] = this.context.measureText(text);\n    return this.textCache[text];\n  }\n\n  maybeInvalidateCache(): void {\n    if (this.textCache[TEST_STRING] === undefined) {\n      this.measureAndCacheText(TEST_STRING);\n      return;\n    }\n\n    const newMeasuredSize = this.context.measureText(TEST_STRING);\n    if (newMeasuredSize !== this.textCache[TEST_STRING]) {\n      this.textCache = {[TEST_STRING]: newMeasuredSize};\n    }\n  }\n\n  draw(\n    configView: Rect,\n    configViewToPhysicalSpace: mat3,\n    flamegraphSearchResults: FlamegraphSearch['results']\n  ): void {\n    // Make sure we set font size before we measure text for the first draw\n    const FONT_SIZE = this.theme.SIZES.BAR_FONT_SIZE * window.devicePixelRatio;\n    this.context.font = `${FONT_SIZE}px ${this.theme.FONTS.FRAME_FONT}`;\n    this.context.textBaseline = 'alphabetic';\n\n    this.maybeInvalidateCache();\n\n    const MIN_WIDTH = this.measureAndCacheText(ELLIPSIS).width;\n    const SIDE_PADDING = 2 * this.theme.SIZES.BAR_PADDING * window.devicePixelRatio;\n    const HALF_SIDE_PADDING = SIDE_PADDING / 2;\n    const BASELINE_OFFSET =\n      (this.theme.SIZES.BAR_HEIGHT - this.theme.SIZES.BAR_FONT_SIZE / 2) *\n      window.devicePixelRatio;\n\n    const HIGHLIGHT_BACKGROUND_COLOR = `rgb(${this.theme.COLORS.HIGHLIGHTED_LABEL_COLOR.join(\n      ', '\n    )})`;\n\n    const TOP_BOUNDARY = configView.top - 1;\n    const BOTTOM_BOUNDARY = configView.bottom + 1;\n    const HAS_SEARCH_RESULTS = flamegraphSearchResults.size > 0;\n\n    // We start by iterating over root frames, so we draw the call stacks top-down.\n    // This allows us to do a couple optimizations that improve our best case performance.\n    // 1. We can skip drawing the entire tree if the root frame is not visible\n    // 2. We can skip drawing and\n    const frames: FlamegraphFrame[] = [...this.flamegraph.root.children];\n\n    while (frames.length > 0) {\n      const frame = frames.pop()!;\n\n      // Check if our rect overlaps with the current viewport and skip it\n      if (frame.end < configView.left || frame.start > configView.right) {\n        continue;\n      }\n\n      // We pin the start and end of the frame, so scrolling around keeps text pinned to the left or right side of the viewport\n      const pinnedStart = Math.max(frame.start, configView.left);\n      const pinnedEnd = Math.min(frame.end, configView.right);\n\n      // Transform frame to physical space coordinates. This does the same operation as\n      // Rect.transformRect, but without allocating a new Rect object.\n      const frameWidth =\n        (pinnedEnd - pinnedStart) * configViewToPhysicalSpace[0] +\n        configViewToPhysicalSpace[3];\n\n      // Since the text is not exactly aligned to the left/right bounds of the frame, we need to subtract the padding\n      // from the total width, so that we can truncate the center of the text accurately.\n      const paddedRectangleWidth = frameWidth - SIDE_PADDING;\n\n      // Since children of a frame cannot be wider than the frame itself, we can exit early and discard the entire subtree\n      if (paddedRectangleWidth <= MIN_WIDTH) {\n        continue;\n      }\n\n      if (frame.depth > BOTTOM_BOUNDARY) {\n        continue;\n      }\n\n      for (let i = 0; i < frame.children.length; i++) {\n        frames.push(frame.children[i]);\n      }\n\n      // If a frame is lower than the top, we can skip drawing its text, however\n      // we can only do so after we have pushed it's children into the queue or else\n      // those children will never be drawn and the entire sub-tree will be skipped.\n      if (frame.depth < TOP_BOUNDARY) {\n        continue;\n      }\n\n      // Transform frame to physical space coordinates. This does the same operation as\n      // Rect.transformRect, but without allocating a new Rect object.\n      const frameHeight =\n        (pinnedEnd - pinnedStart) * configViewToPhysicalSpace[1] +\n        configViewToPhysicalSpace[4];\n      const frameX =\n        pinnedStart * configViewToPhysicalSpace[0] +\n        frame.depth * configViewToPhysicalSpace[3] +\n        configViewToPhysicalSpace[6];\n      const frameY =\n        pinnedStart * configViewToPhysicalSpace[1] +\n        frame.depth * configViewToPhysicalSpace[4] +\n        configViewToPhysicalSpace[7];\n\n      // We want to draw the text in the vertical center of the frame, so we substract half the height of the text.\n      // Since the origin of the rect in the inverted view is also inverted, we need to add the height.\n      const y = frameY + (frameHeight < 0 ? frameHeight : 0) + BASELINE_OFFSET;\n      const x = frameX + (frameWidth < 0 ? frameWidth : 0) + HALF_SIDE_PADDING;\n\n      const trim = trimTextCenter(\n        frame.frame.name,\n        findRangeBinarySearch(\n          {low: 0, high: paddedRectangleWidth},\n          n => this.measureAndCacheText(frame.frame.name.substring(0, n)).width,\n          paddedRectangleWidth\n        )[0]\n      );\n\n      if (HAS_SEARCH_RESULTS) {\n        const frameId = getFlamegraphFrameSearchId(frame);\n        const frameResults = flamegraphSearchResults.get(frameId);\n\n        if (frameResults) {\n          this.context.fillStyle = HIGHLIGHT_BACKGROUND_COLOR;\n\n          const highlightedBounds = computeHighlightedBounds(frameResults.match, trim);\n\n          const frontMatter = trim.text.slice(0, highlightedBounds[0]);\n          const highlightWidth = this.measureAndCacheText(\n            trim.text.substring(highlightedBounds[0], highlightedBounds[1])\n          ).width;\n\n          this.context.fillRect(\n            x + this.measureAndCacheText(frontMatter).width,\n            y + FONT_SIZE / 2 - BASELINE_OFFSET,\n            highlightWidth,\n            FONT_SIZE\n          );\n        }\n      }\n      this.context.fillStyle = this.theme.COLORS.LABEL_FONT_COLOR;\n      this.context.fillText(trim.text, x, y);\n    }\n  }\n}\n\nexport {TextRenderer};\n","export function relativeChange(final: number, initial: number): number {\n  return (final - initial) / initial;\n}\n\ntype Unit = 'nanoseconds' | 'microseconds' | 'milliseconds' | 'seconds';\n\nconst durationMappings: Record<Unit, number> = {\n  nanoseconds: 1e-9,\n  microseconds: 1e-6,\n  milliseconds: 1e-3,\n  seconds: 1,\n};\n\nconst format = (v: number, abbrev: string, precision: number) => {\n  return v.toFixed(precision) + abbrev;\n};\n\nexport function makeFormatter(from: Unit | string): (value: number) => string {\n  const multiplier = durationMappings[from];\n\n  if (multiplier === undefined) {\n    throw new Error(`Cannot format from unit ${from}, duration mapping is not defined`);\n  }\n\n  return (value: number) => {\n    const duration = value * multiplier;\n\n    if (duration >= 1) {\n      return format(duration, 's', 2);\n    }\n    if (duration / 1e-3 >= 1) {\n      return format(duration / 1e-3, 'ms', 2);\n    }\n    if (duration / 1e-6 >= 1) {\n      return format(duration / 1e-6, 's', 2);\n    }\n    return format(duration / 1e-9, 'ns', 2);\n  };\n}\n\nfunction pad(n: number, slots: number) {\n  return Math.floor(n).toString().padStart(slots, '0');\n}\n\nexport function makeTimelineFormatter(from: Unit | string) {\n  const multiplier = durationMappings[from];\n\n  if (multiplier === undefined) {\n    throw new Error(`Cannot format from unit ${from}, duration mapping is not defined`);\n  }\n\n  return (value: number) => {\n    const s = value * multiplier;\n    const m = s / 60;\n    const ms = s * 1e3;\n\n    return `${pad(m, 2)}:${pad(s % 60, 2)}.${pad(ms % 1e3, 3)}`;\n  };\n}\n","const REG_EXP = /(.*)\\/([dgimsuy])/;\n\nexport const parseRegExp = (string: string): RegExpMatchArray | null => {\n  return string.match(REG_EXP);\n};\n\nexport const isRegExpString = (string?: string): boolean => {\n  if (!string?.trim().length) {\n    return false;\n  }\n\n  return REG_EXP.test(string);\n};\n","import {Reducer, ReducerAction, useReducer} from 'react';\n\ntype ReducersObject<S = any, A = any> = {\n  [K in keyof S]: Reducer<S, A>;\n};\n\ntype ReducersState<M> = M extends ReducersObject\n  ? {\n      [P in keyof M]: M[P] extends Reducer<infer S, any> ? S : never;\n    }\n  : never;\n\ntype ReducerFromReducersObject<M> = M extends {\n  [P in keyof M]: infer R;\n}\n  ? R extends Reducer<any, any>\n    ? R\n    : never\n  : never;\n\ntype AllReducerAction<M> = M extends ReducersObject\n  ? ReducerAction<ReducerFromReducersObject<M>>\n  : never;\n\ntype CombinedState<S> = {} & S;\nexport type CombinedReducer<M extends ReducersObject> = Reducer<\n  CombinedState<ReducersState<M>>,\n  AllReducerAction<M>\n>;\n\nexport function makeCombinedReducers<M extends ReducersObject>(\n  reducers: M\n): CombinedReducer<M> {\n  const keys: (keyof M)[] = Object.keys(reducers);\n\n  return (state, action) => {\n    const nextState = {} as ReducersState<M>;\n\n    for (const key of keys) {\n      nextState[key] = reducers[key](state[key], action);\n    }\n\n    return nextState;\n  };\n}\n\nexport function useCombinedReducer<M extends ReducersObject>(\n  reducers: M,\n  initialState: CombinedState<ReducersState<M>>\n): [CombinedState<ReducersState<M>>, React.Dispatch<AllReducerAction<M>>] {\n  return useReducer(makeCombinedReducers(reducers), initialState);\n}\n","import {useCallback, useLayoutEffect, useState} from 'react';\n\n/**\n * Hook to retrieve dpr value of the device and monitor for changes\n * (e.g. if user drags window to a screen with different dpr, we want to be notified).\n * @returns dpr of the device\n */\nfunction useDevicePixelRatio(): number {\n  const [devicePixelRatio, setDevicePixelRatio] = useState<number>(\n    window.devicePixelRatio\n  );\n\n  const updateDevicePixelRatio = useCallback(() => {\n    setDevicePixelRatio(window.devicePixelRatio);\n  }, []);\n\n  useLayoutEffect(() => {\n    window\n      .matchMedia(`(resolution: ${devicePixelRatio}dppx)`)\n      .addEventListener('change', updateDevicePixelRatio, {once: true});\n\n    return () => {\n      window\n        .matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`)\n        .removeEventListener('change', updateDevicePixelRatio);\n    };\n  }, [devicePixelRatio, updateDevicePixelRatio]);\n\n  return devicePixelRatio;\n}\n\nexport {useDevicePixelRatio};\n","import {useEffect, useRef} from 'react';\n\nconst useEffectAfterFirstRender = (\n  cb: React.EffectCallback,\n  deps: React.DependencyList\n): void => {\n  const firstRender = useRef<boolean>(true);\n\n  useEffect(() => {\n    if (firstRender.current) {\n      firstRender.current = false;\n      return;\n    }\n\n    cb();\n    // Dependencies are explicitly managed and the deps warning is enabled for the custom hook.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps);\n};\n\nexport {useEffectAfterFirstRender};\n","import {useCallback, useLayoutEffect, useRef, useState} from 'react';\n\nimport localStorageWrapper from 'sentry/utils/localStorage';\n\nconst SUPPORTS_QUEUE_MICROTASK = window && 'queueMicrotask' in window;\nconst SUPPORTS_LOCAL_STORAGE = window && 'localStorage' in window;\n\nfunction scheduleMicroTask(callback: () => void) {\n  if (SUPPORTS_QUEUE_MICROTASK) {\n    window.queueMicrotask(callback);\n  } else {\n    Promise.resolve()\n      .then(callback)\n      .catch(e => {\n        // Escape the promise and throw the error so it gets reported\n        if (window) {\n          window.setTimeout(() => {\n            throw e;\n          });\n        } else {\n          // Best effort and just rethrow\n          throw e;\n        }\n      });\n  }\n}\n\n// Attempt to parse JSON. If it fails, swallow the error and return null.\n// As an improvement, we should maybe allow users to intercept here or possibly use\n// a different parsing function from JSON.parse\nfunction tryParseStorage<T>(jsonEncodedValue: string): T | null {\n  try {\n    return JSON.parse(jsonEncodedValue);\n  } catch (e) {\n    return null;\n  }\n}\n\nfunction makeTypeExceptionString(instance: string) {\n  return `useLocalStorage: Native serialization of ${instance} is not supported. You are attempting to serialize a ${instance} instance this data will be lost. For more info, see how ${instance.toLowerCase()}s are serialized https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify#examples`;\n}\n\nfunction strictReplacer<T>(_key: string, value: T): T {\n  if (typeof BigInt !== 'undefined' && typeof value === 'bigint') {\n    throw new TypeError(makeTypeExceptionString('BigInt'));\n  }\n  if (value instanceof RegExp) {\n    throw new TypeError(makeTypeExceptionString('RegExp'));\n  }\n  if (typeof Map !== 'undefined' && value instanceof Map) {\n    throw new TypeError(makeTypeExceptionString('Map'));\n  }\n  if (typeof Set !== 'undefined' && value instanceof Set) {\n    throw new TypeError(makeTypeExceptionString('Set'));\n  }\n  if (typeof WeakMap !== 'undefined' && value instanceof WeakMap) {\n    throw new TypeError(makeTypeExceptionString('WeakMap'));\n  }\n  if (typeof WeakSet !== 'undefined' && value instanceof WeakSet) {\n    throw new TypeError(makeTypeExceptionString('WeakSet'));\n  }\n  return value;\n}\n\nfunction stringifyForStorage(value: unknown) {\n  return JSON.stringify(value, strictReplacer, 0);\n}\n\nfunction defaultOrInitializer<S>(\n  defaultValueOrInitializeFn: S | ((value?: unknown, rawStorageValue?: unknown) => S),\n  value?: unknown,\n  rawValue?: unknown\n): S {\n  if (typeof defaultValueOrInitializeFn === 'function') {\n    // https://github.com/microsoft/TypeScript/issues/37663#issuecomment-759728342\n    // @ts-expect-error\n    return defaultValueOrInitializeFn(value, rawValue);\n  }\n  return value === undefined ? defaultValueOrInitializeFn : (value as S);\n}\n\n// Initialize state with default value or value from localStorage.\n// If window is not defined uses the default value and **does not** throw an error\nfunction initializeStorage<S>(\n  key: string,\n  defaultValueOrInitializeFn: S | ((rawStorageValue?: unknown) => S)\n): S {\n  if (typeof key !== 'string') {\n    throw new TypeError('useLocalStorage: key must be a string');\n  }\n\n  // Return default if env does not support localStorage. Passing null to initializer\n  // to mimick not having any previously stored value there.\n  if (!SUPPORTS_LOCAL_STORAGE) {\n    return defaultOrInitializer(defaultValueOrInitializeFn, undefined, null);\n  }\n\n  // getItem and try and decode it, if null is returned use default initializer\n  const jsonEncodedValue = localStorageWrapper.getItem(key);\n  if (jsonEncodedValue === null) {\n    return defaultOrInitializer(defaultValueOrInitializeFn, undefined, null);\n  }\n\n  // We may have failed to parse the value, so just pass it down raw to the initializer\n  const decodedValue = tryParseStorage<S>(jsonEncodedValue);\n  if (decodedValue === null) {\n    return defaultOrInitializer(defaultValueOrInitializeFn, undefined, jsonEncodedValue);\n  }\n\n  // We managed to decode the value, so use it\n  return defaultOrInitializer(defaultValueOrInitializeFn, decodedValue, jsonEncodedValue);\n}\n\n// Mimicks the behavior of React.useState but keeps state synced with localStorage.\n// The only difference from React is that when a state initializer fn is passed,\n// the first argument to that function will be the value that we decoded from localStorage\n// and the second argument will be the raw value from localStorage. This is useful for cases where you may\n// want to recover the error, apply a transformation or use an alternative parsing function.\nexport function useLocalStorageState<S>(\n  key: string,\n  initialState: S | ((value?: unknown, rawValue?: unknown) => S)\n): [S, (value: S) => void] {\n  const [value, setValue] = useState(() => {\n    return initializeStorage<S>(key, initialState);\n  });\n\n  // We want to avoid a blinking state with the old value when props change, so we reinitialize the state\n  // before the screen updates using useLayoutEffect vs useEffect. The ref prevents this from firing on mount\n  // as the value will already be initialized from the initialState and it would be unnecessary to re-initialize\n  const renderRef = useRef(false);\n  useLayoutEffect(() => {\n    if (!renderRef.current) {\n      renderRef.current = true;\n      return;\n    }\n\n    setValue(initializeStorage(key, initialState));\n    // We only want to update the value when the key changes\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [key]);\n\n  const setStoredValue = useCallback(\n    (newValue: S) => {\n      if (typeof key !== 'string') {\n        throw new TypeError('useLocalStorage: key must be a string');\n      }\n\n      setValue(newValue);\n\n      // Not critical and we dont want to block anything after this, so fire microtask\n      // and allow this to eventually be in sync.\n      scheduleMicroTask(() => {\n        localStorageWrapper.setItem(key, stringifyForStorage(newValue));\n      });\n    },\n    [key]\n  );\n\n  return [value, setStoredValue];\n}\n","import {useState} from 'react';\n\nimport {useEffectAfterFirstRender} from './useEffectAfterFirstRender';\nimport usePrevious from './usePrevious';\n\nconst useMemoWithPrevious = <T>(\n  factory: (previousInstance: T | null) => T,\n  deps: React.DependencyList\n): T => {\n  const [value, setValue] = useState<T>(() => factory(null));\n  const previous = usePrevious<T | null>(value);\n\n  useEffectAfterFirstRender(() => {\n    setValue(factory(previous));\n    // Dependencies are explicitly managed and the deps warning is enabled for the custom hook.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps);\n\n  return value;\n};\n\nexport {useMemoWithPrevious};\n","import {ReducerAction, ReducerState, useReducer} from 'react';\n\nexport type UndoableNode<S> = {\n  current: S;\n  next: UndoableNode<S> | undefined;\n  previous: UndoableNode<S> | undefined;\n};\n\ntype UndoAction = {\n  type: 'undo';\n};\n\ntype RedoAction = {\n  type: 'redo';\n};\n\nexport type UndoableReducerAction<A> = UndoAction | RedoAction | A;\n\nexport type UndoableReducer<R extends React.Reducer<any, any>> = React.Reducer<\n  UndoableNode<ReducerState<R>>,\n  UndoableReducerAction<ReducerAction<R>>\n>;\n\nfunction isUndoOrRedoAction(\n  action: UndoableReducerAction<any>\n): action is UndoAction | RedoAction {\n  if (action.type) {\n    return action.type === 'undo' || action.type === 'redo';\n  }\n  return false;\n}\n\nfunction undoableReducer<S>(\n  state: UndoableNode<S>,\n  action: UndoAction | RedoAction\n): UndoableNode<S> {\n  if (action.type === 'undo') {\n    return state.previous === undefined ? state : state.previous;\n  }\n\n  if (action.type === 'redo') {\n    return state.next === undefined ? state : state.next;\n  }\n\n  throw new Error('Unreachable case');\n}\n\nexport function makeUndoableReducer<R extends React.Reducer<any, any>>(\n  reducer: R\n): UndoableReducer<R> {\n  return (\n    state: UndoableNode<ReducerState<R>>,\n    action: UndoableReducerAction<ReducerAction<R>>\n  ) => {\n    if (isUndoOrRedoAction(action)) {\n      return undoableReducer(state, action);\n    }\n\n    const newState: UndoableNode<ReducerState<R>> = {\n      next: undefined,\n      previous: state,\n      current: reducer(state.current, action),\n    };\n\n    state.next = newState;\n    return newState;\n  };\n}\n\nexport function useUndoableReducer<\n  R extends React.Reducer<ReducerState<R>, ReducerAction<R>>\n>(\n  reducer: R,\n  initialState: ReducerState<R>\n): [\n  ReducerState<R>,\n  React.Dispatch<UndoableReducerAction<ReducerAction<R>>>,\n  {\n    nextState: ReducerState<R> | undefined;\n    previousState: ReducerState<R> | undefined;\n  }\n] {\n  const [state, dispatch] = useReducer(makeUndoableReducer(reducer), {\n    current: initialState,\n    previous: undefined,\n    next: undefined,\n  });\n\n  return [\n    state.current,\n    dispatch,\n    {previousState: state.previous?.current, nextState: state.next?.current},\n  ];\n}\n","import {Fragment, useEffect, useMemo} from 'react';\nimport styled from '@emotion/styled';\n\nimport Alert from 'sentry/components/alert';\nimport LoadingIndicator from 'sentry/components/loadingIndicator';\nimport {Flamegraph} from 'sentry/components/profiling/flamegraph';\nimport {ProfileDragDropImportProps} from 'sentry/components/profiling/profileDragDropImport';\nimport SentryDocumentTitle from 'sentry/components/sentryDocumentTitle';\nimport {t} from 'sentry/locale';\nimport {DeepPartial} from 'sentry/types/utils';\nimport trackAdvancedAnalyticsEvent from 'sentry/utils/analytics/trackAdvancedAnalyticsEvent';\nimport {\n  decodeFlamegraphStateFromQueryParams,\n  DEFAULT_FLAMEGRAPH_STATE,\n  FLAMEGRAPH_LOCALSTORAGE_PREFERENCES_KEY,\n  FlamegraphState,\n  FlamegraphStateLocalStorageSync,\n  FlamegraphStateProvider,\n  FlamegraphStateQueryParamSync,\n} from 'sentry/utils/profiling/flamegraph/flamegraphStateProvider/index';\nimport {FlamegraphThemeProvider} from 'sentry/utils/profiling/flamegraph/flamegraphThemeProvider';\nimport {ProfileGroup} from 'sentry/utils/profiling/profile/importProfile';\nimport {Profile} from 'sentry/utils/profiling/profile/profile';\nimport {useLocalStorageState} from 'sentry/utils/useLocalStorageState';\nimport {useLocation} from 'sentry/utils/useLocation';\nimport useOrganization from 'sentry/utils/useOrganization';\n\nimport {useProfileGroup} from './profileGroupProvider';\n\nconst LoadingGroup: ProfileGroup = {\n  name: 'Loading',\n  traceID: '',\n  activeProfileIndex: 0,\n  profiles: [Profile.Empty()],\n};\n\nfunction ProfileFlamegraph(): React.ReactElement {\n  const location = useLocation();\n  const organization = useOrganization();\n  const [profileGroup, setProfileGroup] = useProfileGroup();\n\n  const [storedPreferences] = useLocalStorageState<DeepPartial<FlamegraphState>>(\n    FLAMEGRAPH_LOCALSTORAGE_PREFERENCES_KEY,\n    {\n      preferences: {layout: DEFAULT_FLAMEGRAPH_STATE.preferences.layout},\n    }\n  );\n\n  useEffect(() => {\n    trackAdvancedAnalyticsEvent('profiling_views.profile_flamegraph', {\n      organization,\n    });\n  }, [organization]);\n\n  const onImport: ProfileDragDropImportProps['onImport'] = profiles => {\n    setProfileGroup({type: 'resolved', data: profiles});\n  };\n\n  const initialFlamegraphPreferencesState = useMemo((): DeepPartial<FlamegraphState> => {\n    const queryStringState = decodeFlamegraphStateFromQueryParams(location.query);\n\n    return {\n      ...queryStringState,\n      preferences: {\n        ...storedPreferences.preferences,\n        ...queryStringState.preferences,\n        layout:\n          storedPreferences?.preferences?.layout ??\n          queryStringState.preferences?.layout ??\n          DEFAULT_FLAMEGRAPH_STATE.preferences.layout,\n      },\n    };\n    // We only want to decode this when our component mounts\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <SentryDocumentTitle\n      title={t('Profiling \\u2014 Flamechart')}\n      orgSlug={organization.slug}\n    >\n      <FlamegraphStateProvider initialState={initialFlamegraphPreferencesState}>\n        <FlamegraphThemeProvider>\n          <FlamegraphStateQueryParamSync />\n          <FlamegraphStateLocalStorageSync />\n          <FlamegraphContainer>\n            {profileGroup.type === 'errored' ? (\n              <Alert type=\"error\" showIcon>\n                {profileGroup.error}\n              </Alert>\n            ) : profileGroup.type === 'loading' ? (\n              <Fragment>\n                <Flamegraph onImport={onImport} profiles={LoadingGroup} />\n                <LoadingIndicatorContainer>\n                  <LoadingIndicator />\n                </LoadingIndicatorContainer>\n              </Fragment>\n            ) : profileGroup.type === 'resolved' ? (\n              <Flamegraph onImport={onImport} profiles={profileGroup.data} />\n            ) : null}\n          </FlamegraphContainer>\n        </FlamegraphThemeProvider>\n      </FlamegraphStateProvider>\n    </SentryDocumentTitle>\n  );\n}\n\nconst LoadingIndicatorContainer = styled('div')`\n  position: absolute;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  width: 100%;\n  height: 100%;\n`;\n\nconst FlamegraphContainer = styled('div')`\n  display: flex;\n  flex-direction: column;\n  flex: 1 1 100%;\n\n  /*\n   * The footer component is a sibling of this div.\n   * Remove it so the flamegraph can take up the\n   * entire screen.\n   */\n  ~ footer {\n    display: none;\n  }\n`;\n\nexport default ProfileFlamegraph;\n"],"names":["ExportProfileButton","t","useParams","FlamegraphWarnings","props","params","flamegraph","profile","samples","length","eventId","orgId","projectId","undefined","Overlay","p","theme","zIndex","modal","memo","useCallback","useMemo","useState","Button","IconPanel","space","filterFlamegraphTree","useFlamegraphPreferences","invertCallTree","FrameStackTable","FrameStack","flamegraphPreferences","dispatchFlamegraphPreferences","tab","setTab","treeType","setTreeType","recursion","setRecursion","maybeFilteredOrInvertedTree","skipFunction","f","frame","is_application","maybeFilteredRoots","rootNodes","handleRecursionChange","evt","currentTarget","checked","onBottomUpClick","onCallOrderClick","onAllApplicationsClick","onApplicationsClick","onSystemsClick","onTableLeftClick","type","payload","onTableBottomClick","onTableRightClick","layout","flex","cursor","onResize","referenceNode","canvasPoolManager","ResizableVerticalDrawer","border","InvisibleHandler","FrameDrawerLabel","FrameDrawer","Separator","FrameTabs","prop","surface100","ListItem","fontSizeSmall","margin","textColor","active","StyledButton","LayoutSelectionContainer","FRAME_WEIGHT_CELL_WIDTH_PX","FrameCallersTableCell","noPadding","textAlign","isSelected","blue300","background","Fragment","ProfilingContextMenu","ProfilingContextMenuGroup","ProfilingContextMenuHeading","ProfilingContextMenuItem","ProfilingContextMenuLayer","FrameStackContextMenu","contextMenu","open","setOpen","getMenuProps","position","left","top","maxHeight","containerCoordinates","height","getMenuItemProps","onZoomIntoFrameClick","IconArrow","useContextMenu","useVirtualizedTree","FrameStackTableRow","makeSortFunction","property","direction","a","b","node","totalWeight","selfWeight","name","localeCompare","Error","skipRecursiveNodes","n","isDirectRecursive","tree","getFrameColor","formatDuration","scrollContainerRef","setScrollContainerRef","sort","setSort","setDirection","sortFunction","clickedContextMenuNode","setClickedContextMenuClose","container","handleZoomIntoFrameClick","dispatch","renderRow","r","handleRowClick","handleRowMouseEnter","handleExpandTreeNode","handleRowKeyDown","tabIndexKey","ref","item","styles","key","handleContextMenu","renderedItems","scrollContainerStyles","containerStyles","handleSortingChange","clickedGhostRowRef","hoveredGhostRowRef","scrollContainer","rowHeight","onSortChange","newSort","newDirection","sortFn","width","TableItemsContainer","GhostRowContainer","TableHeaderButton","surface400","FrameBar","FrameCallersTable","FrameWeightCell","FrameNameCell","FrameCallersTableHeader","forwardRef","IconSettings","IconUser","computeRelativeWeight","base","value","onExpandClick","onContextMenu","frameColor","tabIndex","onKeyDown","onClick","onMouseEnter","style","handleExpanding","stopPropagation","expandChildren","metaKey","paddingLeft","depth","backgroundColor","expanded","children","Weight","weight","padded","__","_","rest","toFixed","transform","white","subText","FrameWeightTypeContainer","FrameTypeIndicator","FrameWeightContainer","BackgroundWeightBar","yellow100","yellow200","FrameCallersRow","FrameNameContainer","FrameChildrenIndicator","FrameName","FrameColorIndicator","IconCheckmark","Menu","fontSizeMedium","dropdown","backgroundElevated","borderRadius","dropShadowHeavy","MenuContentContainer","hover","MenuItemCheckboxLabel","MenuItemCheckbox","ProfilingContextMenuItemCheckbox","MenuLeadingItem","MenuContent","Input","MenuItem","MenuContentOuterContainer","MenuGroup","MenuHeading","Layer","useRef","vec2","useFlamegraphTheme","computeBestTooltipPlacement","tooltip","OFFSET_PX","BoundTooltip","bounds","flamegraphCanvas","flamegraphView","flamegraphTheme","physicalSpaceCursor","transformMat3","create","fromConfigView","physicalSpace","logicalSpaceCursor","physicalToLogicalSpace","rafIdRef","onRef","current","window","cancelAnimationFrame","requestAnimationFrame","getBoundingClientRect","willChange","fontSize","SIZES","TOOLTIP_FONT_SIZE","fontFamily","FONTS","FONT","maxWidth","Tooltip","IconDownload","useApi","useOrganization","useProjects","api","organization","project","projects","find","slug","href","baseUrl","download","title","variant","StyledButtonSmall","useEffect","useLayoutEffect","FlamegraphOptionsMenu","FlamegraphSearch","FlamegraphToolbar","FlamegraphViewSelectMenu","FlamegraphZoomView","FlamegraphZoomViewMinimap","ProfileDragDropImport","ThreadMenuSelector","CanvasPoolManager","CanvasScheduler","Flamegraph","FlamegraphModel","useFlamegraphProfiles","FlamegraphCanvas","FlamegraphView","computeConfigViewWithStategy","formatColorForFrame","Rect","watchForResize","FlamegraphRenderer","useDevicePixelRatio","useMemoWithPrevious","ProfilingFlamechartLayout","getTransactionConfigSpace","profiles","startedAt","Math","min","map","endedAt","max","noopFormatDuration","canvasBounds","setCanvasBounds","Empty","devicePixelRatio","sorting","view","xAxis","threadId","selectedRoot","dispatchThreadId","flamegraphCanvasRef","setFlamegraphCanvasRef","flamegraphOverlayCanvasRef","setFlamegraphOverlayCanvasRef","flamegraphMiniMapCanvasRef","setFlamegraphMiniMapCanvasRef","flamegraphMiniMapOverlayCanvasRef","setFlamegraphMiniMapOverlayCanvasRef","scheduler","inverted","leftHeavy","configSpace","fromValues","TIMELINE_HEIGHT","flamegraphMiniMapCanvas","previousView","newView","canvas","equals","setConfigView","configView","withHeight","onConfigViewChange","rect","draw","onTransformConfigView","mat","transformConfigView","onResetZoom","resetConfigView","onZoomIntoFrame","strategy","newConfigView","start","end","on","off","registerScheduler","unregisterScheduler","flamegraphObserver","x","y","initPhysicalSpace","resizeConfigSpace","drawSync","flamegraphMiniMapObserver","disconnect","flamegraphRenderer","draw_border","root","newThreadId","s","v","onImport","formatter","FLAMEGRAPH_COLOR_CODINGS","FLAMEGRAPH_VIEW_OPTIONS","FLAMEGRAPH_SORTING_OPTIONS","FLAMEGRAPH_AXIS_OPTIONS","FlamegraphOptionsContextMenu","preferences","coding","idx","colorCoding","axis","CompositeSelect","IconSliders","options","label","defaultValue","Object","entries","X_AXIS","onChange","COLOR_CODINGS","icon","size","standalone","transaction","Sentry","Fuse","SearchBar","useFlamegraphSearch","getFlamegraphFrameSearchId","memoizeByReference","isRegExpString","parseRegExp","sortFrameResults","frames","values","numericSort","findBestMatchFromFuseMatches","matches","bestMatch","bestMatchLength","bestMatchStart","i","match","j","indices","index","matchLength","findBestMatchFromRegexpMatchArray","memoizedSortFrameResults","frameSearch","query","results","Map","lookup","flags","re","RegExp","reMatches","Array","from","trim","matchAll","frameId","set","e","captureMessage","message","fuseResults","search","fuseFrameResult","flamegraphs","dispatchSearch","didInitialSearch","setDidInitialSearch","allFrames","isArray","reduce","acc","graph","concat","searchIndex","keys","threshold","includeMatches","findAllMatches","ignoreLocation","handleChange","onNextSearchClick","onPreviousSearchClick","handleKeyDown","preventDefault","StyledSearchBar","ButtonBar","onViewChange","onSortingChange","mat3","useDispatchFlamegraphState","useFlamegraphState","useInternalFlamegraphDebugMode","GridRenderer","SampleTickRenderer","SelectedFrameRenderer","TextRenderer","usePrevious","formatWeightToProfileDuration","round","duration","flamegraphProfile","flamegraphSearch","isInternalFlamegraphDebugModeEnabled","lastInteraction","setLastInteraction","previousState","nextState","flamegraphState","dispatchFlamegraphState","startPanVector","setStartPanVector","configSpaceCursor","setConfigSpaceCursor","textRenderer","gridRenderer","sampleTickRenderer","selectedFrameRenderer","hoveredNode","getHoveredNode","focusedRects","focusFrame","rects","pop","image","package","push","action","shiftKey","previousPosition","isEmpty","nextPosition","document","addEventListener","removeEventListener","previousInteraction","beforeInteractionConfigView","clone","drawRectangles","registerBeforeFrameCallback","unregisterBeforeFrameCallback","clearOverlayCanvas","context","clearRect","drawText","drawGrid","toConfigView","logicalSpace","drawInternalSampleTicks","registerAfterFrameCallback","unregisterAfterFrameCallback","drawFocusedFrameBorder","BORDER_COLOR","COLORS","FOCUSED_FRAME_BORDER_COLOR","BORDER_WIDTH","FOCUSED_FRAME_BORDER_WIDTH","state","selectedNode","onNodeHighlight","mode","drawSelectedFrameBorder","SELECTED_FRAME_BORDER_COLOR","FRAME_BORDER_WIDTH","drawHoveredFrameBorder","HOVERED_FRAME_BORDER_COLOR","HOVERED_FRAME_BORDER_WIDTH","onCanvasMouseDown","logicalMousePos","nativeEvent","offsetX","offsetY","physicalMousePos","scale","onCanvasMouseUp","onMouseDrag","physicalDelta","subtract","physicalToConfig","invert","m00","m01","m02","m10","m11","m12","configDelta","fromTranslation","onCanvasMouseMove","configSpaceMouse","getConfigViewCursor","onCanvasMouseLeave","zoom","identity","deltaY","mouseInConfigView","configCenter","invertedConfigCenter","multiply","translated","translate","scaled","translatedBack","scroll","deltaX","wheelStopTimeoutId","onCanvasWheel","clearTimeout","setTimeout","ctrlKey","pointerEvents","timelineFormatter","HoveredFrameTimelineInfo","HoveredFrameMainInfo","CanvasContainer","Canvas","PositionIndicatorRenderer","flamegraphMiniMapView","flamegraphMiniMapRenderer","BAR_HEIGHT","MINIMAP_HEIGHT","FLAMEGRAPH_DEPTH_OFFSET","positionIndicatorRenderer","fromConfigSpace","drawPosition","startDragVector","setStartDragConfigSpaceCursor","lastDragVector","setLastDragVector","onMinimapCanvasMouseMove","getConfigSpaceCursor","onMinimapScroll","onMinimapZoom","mouseInConfigSpace","onMinimapCanvasMouseDown","contains","startConfigSpaceCursor","onMinimapCanvasMouseUp","isZoom","c","OverlayCanvas","LightFlamegraphTheme","importDroppedProfile","dropState","setDropState","errorMessage","setErrorMessage","onDrop","file","dataTransfer","items","getAsFile","then","catch","onDragEnter","onDragLeave","onDragOver","onDismiss","DragDropContainer","cloneElement","useFlamegraphPreferencesValue","useResizableDrawer","MIN_FRAMESTACK_DIMENSIONS","frameStackRef","resizableOptions","initialDimensions","innerWidth","newDimensions","onMouseDown","minimap","flamechart","frameStack","ProfilingFlamechartLayoutContainer","ProfilingFlamechartGrid","MinimapContainer","ZoomViewContainer","FrameStackContainer","CompactSelect","IconList","tn","defined","makeFormatter","onThreadIdChange","profileGroup","compareProfiles","details","unit","opt","ThreadLabelDetails","startsWith","includes","DetailsContainer","Set","onDispose","cb","onDisposeCallbacks","has","add","eventName","events","delete","event","args","handler","registerCallback","pool","unregisterCallback","beforeFrameCallbacks","afterFrameCallbacks","dispose","clear","schedulers","uniqueBy","arr","predicate","o","fract","floor","triangle","abs","fromLumaChromaHue","L","C","H","hPrime","X","R1","G1","B1","m","clamp","makeStackToColor","fallback","colorMap","colorBucket","colors","colorBuffer","get","colorWithAlpha","offset","isNumber","input","isNaN","number","toRGBAString","g","alpha","defaultFrameSortKey","defaultFrameSort","makeColorBucketTheme","lch","C_0","C_d","L_0","L_d","makeColorMap","sortBy","sortedFrames","uniqueFrames","colorsByName","nameKey","color","makeColorMapByRecursion","filter","isRecursive","makeColorMapByImage","reverseFrameToImageIndex","imageFrames","makeColorMapBySystemVsApplication","makeColorMapByFrequency","countMap","previousCount","count","roots","skipFn","stack","nodesToKeep","nodes","cpy","parent","lastOfArray","Profile","makeTimelineFormatter","CallTreeNode","Frame","From","profileIndex","constructor","Root","buildLeftHeavyGraph","buildCallOrderGraph","addToTotalWeight","openFrame","closeFrame","stackTop","unshift","forEach","sortTree","appendOrderTree","virtualRoot","_node","visit","isRoot","childTime","child","setConfigSpace","flamegraphPreferencesReducer","flamegraphProfilesReducer","flamegraphSearchReducer","flamegraphZoomPositionReducer","createContext","browserHistory","makeCombinedReducers","useLocalStorageState","useLocation","useUndoableReducer","useProfileGroup","useFlamegraphStateValue","isColorCoding","isLayout","isSorting","isView","isXAxis","decodeFlamegraphStateFromQueryParams","frameName","framePackage","tid","parseInt","decode","fov","DEFAULT_FLAMEGRAPH_STATE","encodeFlamegraphStateToQueryParams","encode","combinedReducers","FlamegraphStateQueryParamSync","location","replace","FLAMEGRAPH_LOCALSTORAGE_PREFERENCES_KEY","FlamegraphStateLocalStorageSync","setState","FlamegraphStateContext","FlamegraphStateProvider","reducer","initialState","candidate","data","prevCandidate","score","scoreFlamegraph","activeProfileIndex","threadID","darkTheme","lightTheme","MONOSPACE_FONT","FRAME_FONT","text","familyMono","LCH_LIGHT","LCH_DARK","CONFIG","HIGHLIGHT_RECURSION","BAR_FONT_SIZE","BAR_PADDING","GRID_LINE_WIDTH","INTERNAL_SAMPLE_TICK_LINE_WIDTH","LABEL_FONT_PADDING","LABEL_FONT_SIZE","MINIMAP_POSITION_OVERLAY_BORDER_WIDTH","REQUEST_BAR_HEIGHT","REQUEST_DEPTH_OFFSET","REQUEST_FONT_SIZE","REQUEST_TAIL_HEIGHT","SPANS_BAR_HEIGHT","SPANS_DEPTH_OFFSET","SPANS_FONT_SIZE","BAR_LABEL_FONT_COLOR","COLOR_BUCKET","COLOR_MAP","CURSOR_CROSSHAIR","DIFFERENTIAL_DECREASE","DIFFERENTIAL_INCREASE","focus","FRAME_FALLBACK_COLOR","GRID_FRAME_BACKGROUND_COLOR","GRID_LINE_COLOR","HIGHLIGHTED_LABEL_COLOR","LABEL_FONT_COLOR","MINIMAP_POSITION_OVERLAY_BORDER_COLOR","MINIMAP_POSITION_OVERLAY_COLOR","REQUEST_2XX_RESPONSE","REQUEST_4XX_RESPONSE","REQUEST_DNS_TIME","REQUEST_SSL_TIME","REQUEST_TCP_TIME","REQUEST_WAIT_TIME","SAMPLE_TICK_COLOR","SEARCH_RESULT_FRAME_COLOR","blue400","SPAN_FRAME_BACKGROUND","SPAN_FRAME_BORDER","STACK_TO_COLOR","DarkFlamegraphTheme","ConfigStore","useLegacyStore","FlamegraphThemeContext","FlamegraphThemeProvider","activeFlamegraphTheme","TypeError","useContext","useFlamegraphProfilesValue","useFlamegraphSearchValue","ctx","transformMatrixBetweenRect","origin","logicalToPhysicalSpace","String","computeClampedConfigView","initConfigSpace","_initConfigSpace","_initConfigView","minFrameDuration","transformation","transformRect","toConfigSpace","invertYTransform","createShader","gl","source","shader","shaderSource","compileShader","success","getShaderParameter","COMPILE_STATUS","deleteShader","createProgram","vertexShader","fragmentShader","program","attachShader","linkProgram","getProgramParameter","LINK_STATUS","deleteProgram","makeProjectionMatrix","projectionMatrix","divide","canvasToDisplaySizeMap","entry","dpr","devicePixelContentBoxSize","inlineSize","blockSize","contentBoxSize","contentRect","displayWidth","displayHeight","target","resizeCanvasToDisplaySize","callback","resizeObserver","ResizeObserver","observe","box","ex","clientWidth","clientHeight","needResize","to","isValid","toMatrix","every","right","bottom","maybeEncodedRect","split","parseFloat","toString","join","w","h","hasIntersectionWith","other","containsX","vec","containsY","containsRect","leftOverlapsWith","rightOverlapsWith","overlapsX","overlapsY","overlaps","withWidth","withX","withY","toBounds","toArray","between","translateX","translateY","scaleX","scaleY","scaleOriginBy","scaledBy","notEqualTo","getContext","antialias","measureText","string","createElement","measures","actualBoundingBoxAscent","actualBoundingBoxDescent","findRangeBinarySearch","fn","low","high","precision","mid","renderer","getColorForFrame","slice","ELLIPSIS","trimTextCenter","prefixLength","postfixLength","trimText","substring","clampedWidth","clampedHeight","maxX","maxY","clampedX","clampedY","computeHighlightedBounds","isStartBetweenTrim","isEndBetweenTrim","isFullyTruncated","JSON","stringify","useKeyboardNavigation","computeBestContextMenuPosition","mouse","minY","minX","OFFSET","menuCoordinates","setMenuCoordinates","contextMenuCoordinates","setContextMenuCoordinates","setContainerCoordinates","itemProps","wrapSetOpen","newOpen","setTabIndex","menuProps","menuItemProps","getItemProps","parentPosition","clientX","clientY","listener","menuRef","FLAMEGRAPH_DEBUG_MODE_KEY","isEnabled","setIsEnabled","sessionStorage","getItem","isCtrlOrMeta","code","val","next","setItem","removeItem","useRovingTabIndex","setMenuRef","id","startResizeVectorRef","dimensions","setDimensions","dimensionsRef","onMouseMove","body","userSelect","currentPositionVector","distance","onMouseUp","passive","VirtualizedTreeNode","VirtualizedTree","flattenedList","flattened","toExpandedList","fromRoots","expandedNodes","toTreeNode","collection","treeNode","list","expandNode","opts","removedOrAddedNodes","setExpanded","splice","indexOf","sortedChildren","sortedRoots","getAllExpandedNodes","previouslyExpandedNodes","getVisibleChildrenCount","queue","removedCount","useReducer","useTheme","useEffectAfterFirstRender","cancelAnimationTimeout","requestAnimationTimeout","delay","Promise","resolve","Date","now","timeout","VirtualizedTreeStateReducer","scrollTop","scrollHeight","hideGhostRow","opacity","updateGhostRow","interaction","findOptimisticStartIndex","overscroll","viewport","findVisibleItems","OVERSCROLL_HEIGHT","visibleItems","visibleItemIndex","indexPointer","MAX_VISIBLE_ITEMS","ceil","ALL_ITEMS","elementTop","elementBottom","DEFAULT_OVERSCROLL_ITEMS","findCarryOverIndex","previousNode","newTree","newIndex","findIndex","previousHoveredRow","latestStateRef","setTree","initialTree","cleanupAllHoveredRows","row","latestItemsRef","dataset","hovered","flattenedHistory","expandedHistory","scrollEndTimeoutId","previousScrollHeight","handleScroll","firstChild","handleClick","handleMouseMove","element","onMouseLeave","_evt","scrollTo","indexInVisibleItems","nextIndex","preventScroll","scrollIntoView","block","rafId","elements","overflow","renderered","fragment","vertex","a_position","a_color","a_bounds","u_border_width","u_draw_border","u_is_search_result","u_model","u_projection","init","VERTICES","COLOR_COMPONENTS","initCanvasContext","initVertices","initShaders","POSITIONS_PER_PASS","BOUNDS_PER_PASS","positions","x1","x2","y1","y2","positionOffset","boundsOffset","enable","BLEND","blendFuncSeparate","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","ONE","uniforms","attributes","VERTEX_SHADER","FRAGMENT_SHADER","uProjectionMatrix","getUniformLocation","uModelMatrix","uIsSearchResult","uBorderWidth","uDrawBorder","aColorAttributeLocation","getAttribLocation","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","FLOAT","normalize","stride","vertexAttribPointer","enableVertexAttribArray","aPositionAttributeLocation","positionBuffer","aBoundsAttributeLocation","boundsBuffer","useProgram","findHoveredNode","frameRect","configViewToPhysicalSpace","searchResults","clearColor","COLOR_BUFFER_BIT","uniformMatrix3fv","uniform1i","physicalSpacePixel","configSpacePixel","uniform2f","vertexOffset","drawArrays","TRIANGLES","getIntervalTimeAtX","logicalSpaceToConfigView","vector","computeInterval","targetInterval","minInterval","pow","log10","interval","intervals","configViewSpace","physicalViewRect","font","textBaseline","lineWidth","fillStyle","fillRect","physicalIntervalPosition","labelText","fillText","strokeStyle","strokeRect","configSpaceToPhysicalSpace","physicalConfigViewRect","physicalConfigRect","offsetRectForBorderWidth","beginPath","fill","computeAbsoluteSampleTimestamps","weights","timeline","frameInPhysicalSpace","borderRect","TEST_STRING","textCache","measureAndCacheText","maybeInvalidateCache","newMeasuredSize","flamegraphSearchResults","FONT_SIZE","MIN_WIDTH","SIDE_PADDING","HALF_SIDE_PADDING","BASELINE_OFFSET","HIGHLIGHT_BACKGROUND_COLOR","TOP_BOUNDARY","BOTTOM_BOUNDARY","HAS_SEARCH_RESULTS","pinnedStart","pinnedEnd","frameWidth","paddedRectangleWidth","frameHeight","frameX","frameY","frameResults","highlightedBounds","frontMatter","highlightWidth","relativeChange","final","initial","durationMappings","nanoseconds","microseconds","milliseconds","seconds","format","abbrev","multiplier","pad","slots","padStart","ms","REG_EXP","test","reducers","useCombinedReducer","setDevicePixelRatio","updateDevicePixelRatio","matchMedia","once","deps","firstRender","localStorageWrapper","SUPPORTS_QUEUE_MICROTASK","SUPPORTS_LOCAL_STORAGE","scheduleMicroTask","queueMicrotask","tryParseStorage","jsonEncodedValue","parse","makeTypeExceptionString","instance","toLowerCase","strictReplacer","_key","BigInt","WeakMap","WeakSet","stringifyForStorage","defaultOrInitializer","defaultValueOrInitializeFn","rawValue","initializeStorage","decodedValue","setValue","renderRef","setStoredValue","newValue","factory","previous","isUndoOrRedoAction","undoableReducer","makeUndoableReducer","newState","Alert","LoadingIndicator","SentryDocumentTitle","trackAdvancedAnalyticsEvent","LoadingGroup","traceID","ProfileFlamegraph","setProfileGroup","storedPreferences","initialFlamegraphPreferencesState","queryStringState","error","LoadingIndicatorContainer","FlamegraphContainer"],"sourceRoot":""}